<!DOCTYPE html><head><script src="enable-threads.js"></script><meta content="text/html;charset=utf-8" http-equiv="Content-Type"><title>Waragraph Web</title><link rel="stylesheet" href="https://chfi.github.io/waragraph/index.5e3e5f53.css"></head><body> <div style="display:none" class="root-grid root-sidebar-open" id="root-container"> <div class="sidebar" id="sidebar"> </div> <div class="gutter-column gutter-column-sidebar"></div> <div class="viz-grid" id="viz-container"> <div id="graph-viewer-container"> </div> <div class="gutter-row gutter-row-1"></div> <div id="path-viewer-container"> <div class="path-viewer-column" id="path-viewer-left-column"> </div> <div class="gutter-column gutter-column-1"></div> <div class="path-viewer-column" id="path-viewer-right-column"> </div> </div> </div> </div> <div id="file-inputs"> <div> <label for="gfa-file">Choose a GFA file</label> <input type="file" id="gfa-file" name="gfa" accept=".gfa"> </div> <div> <label for="layout-file">Choose a TSV layout file</label> <input type="file" id="layout-file" name="layout" accept=".tsv"> </div> <button id="load-data">Load data</button> </div> <script>!function(){let t,e,n,r,i;function o(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var u,a,c,s,l,f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},_={},d={},b=f.parcelRequire94c2;null==b&&((b=function(t){if(t in _)return _[t].exports;if(t in d){var e=d[t];delete d[t];var n={id:t,exports:{}};return _[t]=n,e.call(n.exports,n,n.exports),n.exports}var r=Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(t,e){d[t]=e},f.parcelRequire94c2=b),(0,b.register)("eRNJD",function(t,e){o(t.exports,"getBundleURL",function(){return n},function(t){return n=t}),o(t.exports,"getOrigin",function(){return r},function(t){return r=t});var n,r,i={};n=function(t){var e=i[t];return e||(e=function(){try{throw Error()}catch(e){var t=(""+e.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(t)// Use the 3rd one, which will be a runtime in the original bundle.
return(""+t[2]).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}(),i[t]=e),e},r=// TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.
function(t){var e=(""+t).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^/]+/);if(!e)throw Error("Origin not found");return e[0]}});let h=Array(128).fill(void 0);h.push(void 0,null,!0,!1);let g=h.length;function p(t){let e=h[t];return t<132||(h[t]=g,g=t),e}function w(t){return null==t}let m=null,v=null;function y(){return(null===v||v.buffer!==t.memory.buffer)&&(v=new Int32Array(t.memory.buffer)),v}let x="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&x.decode();let S=null;function E(){return(null===S||S.buffer!==t.memory.buffer)&&(S=new Uint8Array(t.memory.buffer)),S}function k(t,e){return t>>>=0,x.decode(E().slice(t,t+e))}function A(t){g===h.length&&h.push(h.length+1);let e=g;return g=h[e],h[e]=t,e}let T=0,P="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},C=function(t,e){let n=P.encode(t);return e.set(n),{read:t.length,written:n.length}};function I(t,e,n){if(void 0===n){let n=P.encode(t),r=e(n.length,1)>>>0;return E().subarray(r,r+n.length).set(n),T=n.length,r}let r=t.length,i=e(r,1)>>>0,o=E(),u=0;for(;u<r;u++){let e=t.charCodeAt(u);if(e>127)break;o[i+u]=e}if(u!==r){0!==u&&(t=t.slice(u)),i=n(i,r,r=u+3*t.length,1)>>>0;let e=E().subarray(i+u,i+r),o=C(t,e);u+=o.written}return T=u,i}function D(e,n,r,i){let o={a:e,b:n,cnt:1,dtor:r},u=(...e)=>{// First up with a closure we increment the internal reference
// count. This ensures that the Rust closure environment won't
// be deallocated while we're invoking it.
o.cnt++;let n=o.a;o.a=0;try{return i(n,o.b,...e)}finally{0==--o.cnt?t.__wbindgen_export_3.get(o.dtor)(n,o.b):o.a=n}};return u.original=o,u}function M(e,n,r){t._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h2ab5e5c8f034847e(e,n,A(r))}function O(e,n){try{return e.apply(this,n)}catch(e){t.__wbindgen_exn_store(A(e))}}let z=null;function R(){return(null===z||z.buffer!==t.memory.buffer)&&(z=new Float32Array(t.memory.buffer)),z}function L(t,e){return t>>>=0,R().subarray(t/4,t/4+e)}function F(t,e){if(!(t instanceof e))throw Error(`expected instance of ${e.name}`);return t.ptr}let B=null;function N(){return(null===B||B.buffer!==t.memory.buffer)&&(B=new Uint32Array(t.memory.buffer)),B}function j(t,e){let n=e(4*t.length,4)>>>0;return N().set(t,n/4),T=t.length,n}function q(e){let n=I(e,t.__wbindgen_malloc,t.__wbindgen_realloc),r=T,i=t.path_name_hash_color_obj(n,r);return p(i)}let G=128;function V(t){if(1==G)throw Error("out of js stack");return h[--G]=t,G}function W(t,e){return t>>>=0,N().subarray(t/4,t/4+e)}function U(){t.set_panic_hook()}function H(t,e){return t>>>=0,y().subarray(t/4,t/4+e)}class ${static __wrap(t){t>>>=0;let e=Object.create($.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){let e=this.__destroy_into_raw();t.__wbg_arrowgfawrapped_free(e)}/**
    * @returns {PathIndexWrapped}
    */generate_path_index(){let e=t.arrowgfawrapped_generate_path_index(this.__wbg_ptr);return J.__wrap(e)}/**
    * @returns {number}
    */segment_count(){let e=t.arrowgfawrapped_segment_count(this.__wbg_ptr);return e>>>0}/**
    * @returns {number}
    */path_count(){let e=t.arrowgfawrapped_path_count(this.__wbg_ptr);return e>>>0}/**
    * @param {number} path_index
    * @returns {string}
    */path_name(e){let n,r;try{let l=t.__wbindgen_add_to_stack_pointer(-16);t.arrowgfawrapped_path_name(l,this.__wbg_ptr,e);var i=y()[l/4+0],o=y()[l/4+1],u=y()[l/4+2],a=y()[l/4+3],c=i,s=o;if(a)throw c=0,s=0,p(u);return n=c,r=s,k(c,s)}finally{t.__wbindgen_add_to_stack_pointer(16),t.__wbindgen_free(n,r,1)}}/**
    * @param {string} path_name
    * @returns {number}
    */path_index(e){try{let i=t.__wbindgen_add_to_stack_pointer(-16),o=I(e,t.__wbindgen_malloc,t.__wbindgen_realloc),u=T;t.arrowgfawrapped_path_index(i,this.__wbg_ptr,o,u);var n=y()[i/4+0],r=y()[i/4+1];if(y()[i/4+2])throw p(r);return n>>>0}finally{t.__wbindgen_add_to_stack_pointer(16)}}/**
    * @param {Function} f
    */with_path_names(e){try{t.arrowgfawrapped_with_path_names(this.__wbg_ptr,V(e))}finally{h[G++]=void 0}}/**
    * @param {string} path_name
    * @returns {Uint32Array}
    */path_steps(e){try{let i=t.__wbindgen_add_to_stack_pointer(-16),o=I(e,t.__wbindgen_malloc,t.__wbindgen_realloc),u=T;t.arrowgfawrapped_path_steps(i,this.__wbg_ptr,o,u);var n=y()[i/4+0],r=y()[i/4+1];if(y()[i/4+2])throw p(r);return p(n)}finally{t.__wbindgen_add_to_stack_pointer(16)}}/**
    * @returns {Uint8Array}
    */segment_sequences_array(){let e=t.arrowgfawrapped_segment_sequences_array(this.__wbg_ptr);return p(e)}}class Y{static __wrap(t){t>>>=0;let e=Object.create(Y.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){let e=this.__destroy_into_raw();t.__wbg_canvaspathtrace_free(e)}/**
    * @returns {number}
    */get length(){let e=t.canvaspathtrace_length(this.__wbg_ptr);return e>>>0}/**
    * @returns {any}
    */get_endpoints(){let e=t.canvaspathtrace_get_endpoints(this.__wbg_ptr);return p(e)}/**
    * @param {number} ix
    * @returns {object}
    */get_point(e){try{let i=t.__wbindgen_add_to_stack_pointer(-16);t.canvaspathtrace_get_point(i,this.__wbg_ptr,e);var n=y()[i/4+0],r=y()[i/4+1];if(y()[i/4+2])throw p(r);return p(n)}finally{t.__wbindgen_add_to_stack_pointer(16)}}/**
    * @param {Function} f
    */with_points(e){try{t.canvaspathtrace_with_points(this.__wbg_ptr,V(e))}finally{h[G++]=void 0}}/**
    * @param {Function} f
    */with_points_tangents(e){try{t.canvaspathtrace_with_points_tangents(this.__wbg_ptr,V(e))}finally{h[G++]=void 0}}/**
    * @returns {Float32Array}
    */points_array(){let e=t.canvaspathtrace_points_array(this.__wbg_ptr);return p(e)}}class X{static __wrap(t){t>>>=0;let e=Object.create(X.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){let e=this.__destroy_into_raw();t.__wbg_coordsys_free(e)}/**
    * @param {ArrowGFAWrapped} graph
    * @returns {CoordSys}
    */static global_from_arrow_gfa(e){F(e,$);let n=t.coordsys_global_from_arrow_gfa(e.__wbg_ptr);return X.__wrap(n)}/**
    * @param {ArrowGFAWrapped} graph
    * @param {number} path_index
    * @returns {CoordSys}
    */static path_from_arrow_gfa(e,n){F(e,$);let r=t.coordsys_path_from_arrow_gfa(e.__wbg_ptr,n);return X.__wrap(r)}/**
    * @returns {bigint}
    */max(){let e=t.coordsys_max(this.__wbg_ptr);return BigInt.asUintN(64,e)}/**
    * @returns {number}
    */max_f64(){let e=t.coordsys_max_f64(this.__wbg_ptr);return e}/**
    * @param {bigint} start
    * @param {bigint} end
    * @returns {object}
    */bp_to_step_range(e,n){let r=t.coordsys_bp_to_step_range(this.__wbg_ptr,e,n);return p(r)}/**
    * @param {number} segment
    * @returns {object}
    */segment_range(e){try{let i=t.__wbindgen_add_to_stack_pointer(-16);t.coordsys_segment_range(i,this.__wbg_ptr,e);var n=y()[i/4+0],r=y()[i/4+1];if(y()[i/4+2])throw p(r);return p(n)}finally{t.__wbindgen_add_to_stack_pointer(16)}}/**
    * @param {bigint} pos
    * @returns {number}
    */segment_at_pos(e){let n=t.coordsys_segment_at_pos(this.__wbg_ptr,e);return n>>>0}/**
    * @param {any} bp_start
    * @param {any} bp_end
    * @param {SparseData} data
    * @param {Float32Array} bins
    */sample_range(e,n,r,i){F(r,te);var o=function(t,e){let n=e(4*t.length,4)>>>0;return R().set(t,n/4),T=t.length,n}(i,t.__wbindgen_malloc),u=T;t.coordsys_sample_range(this.__wbg_ptr,A(e),A(n),r.__wbg_ptr,o,u,A(i))}/**
    * @param {number} cs_seg
    * @returns {number}
    */offset_at(e){try{let i=t.__wbindgen_add_to_stack_pointer(-16);t.coordsys_offset_at(i,this.__wbg_ptr,e);var n=y()[i/4+0],r=y()[i/4+1];if(y()[i/4+2])throw p(r);return n>>>0}finally{t.__wbindgen_add_to_stack_pointer(16)}}}class Q{static __wrap(t){t>>>=0;let e=Object.create(Q.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){let e=this.__destroy_into_raw();t.__wbg_graphviewer_free(e)}/**
    * @param {RavingCtx} raving
    * @param {ArrowGFAWrapped} graph
    * @param {SegmentPositions} pos
    * @param {HTMLCanvasElement} canvas
    * @param {Uint32Array} segment_colors
    * @returns {GraphViewer}
    */static new_with_color_data(e,n,r,i,o){try{let c=t.__wbindgen_add_to_stack_pointer(-16);F(e,Z),F(n,$),F(r,K);let s=j(o,t.__wbindgen_malloc),l=T;t.graphviewer_new_with_color_data(c,e.__wbg_ptr,n.__wbg_ptr,r.__wbg_ptr,A(i),s,l);var u=y()[c/4+0],a=y()[c/4+1];if(y()[c/4+2])throw p(a);return Q.__wrap(u)}finally{t.__wbindgen_add_to_stack_pointer(16)}}/**
    * @param {RavingCtx} raving
    * @param {ArrowGFAWrapped} graph
    * @param {SegmentPositions} pos
    * @param {HTMLCanvasElement} canvas
    * @returns {GraphViewer}
    */static new_dummy_data(e,n,r,i){try{let a=t.__wbindgen_add_to_stack_pointer(-16);F(e,Z),F(n,$),F(r,K),t.graphviewer_new_dummy_data(a,e.__wbg_ptr,n.__wbg_ptr,r.__wbg_ptr,A(i));var o=y()[a/4+0],u=y()[a/4+1];if(y()[a/4+2])throw p(u);return Q.__wrap(o)}finally{t.__wbindgen_add_to_stack_pointer(16)}}/**
    * @param {RavingCtx} raving
    * @param {number} width
    * @param {number} height
    */resize(e,n,r){try{let o=t.__wbindgen_add_to_stack_pointer(-16);F(e,Z),t.graphviewer_resize(o,this.__wbg_ptr,e.__wbg_ptr,n,r);var i=y()[o/4+0];if(y()[o/4+1])throw p(i)}finally{t.__wbindgen_add_to_stack_pointer(16)}}/**
    * @param {RavingCtx} raving
    * @param {number} x
    * @param {number} y
    * @returns {number}
    */gbuffer_lookup(e,n,r){try{let u=t.__wbindgen_add_to_stack_pointer(-16);F(e,Z),t.graphviewer_gbuffer_lookup(u,this.__wbg_ptr,e.__wbg_ptr,n,r);var i=y()[u/4+0],o=y()[u/4+1];if(y()[u/4+2])throw p(o);return i>>>0}finally{t.__wbindgen_add_to_stack_pointer(16)}}/**
    * @returns {View2D}
    */get_view(){let e=t.graphviewer_get_view(this.__wbg_ptr);return tr.__wrap(e)}/**
    * @param {View2D} view
    */set_view(e){F(e,tr),t.graphviewer_set_view(this.__wbg_ptr,e.__wbg_ptr)}/**
    * @param {number} canvas_width
    * @param {number} canvas_height
    * @returns {any}
    */get_view_matrix(e,n){let r=t.graphviewer_get_view_matrix(this.__wbg_ptr,e,n);return p(r)}/**
    * @param {number} x
    * @param {number} y
    */set_view_center(e,n){t.graphviewer_set_view_center(this.__wbg_ptr,e,n)}/**
    * @param {RavingCtx} raving
    */draw_to_surface(e){F(e,Z),t.graphviewer_draw_to_surface(this.__wbg_ptr,e.__wbg_ptr)}}class J{static __wrap(t){t>>>=0;let e=Object.create(J.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){let e=this.__destroy_into_raw();t.__wbg_pathindexwrapped_free(e)}/**
    * @param {number} segment
    * @returns {Uint32Array}
    */paths_on_segment(e){try{let o=t.__wbindgen_add_to_stack_pointer(-16);t.pathindexwrapped_paths_on_segment(o,this.__wbg_ptr,e);var n=y()[o/4+0],r=y()[o/4+1],i=W(n,r).slice();return t.__wbindgen_free(n,4*r,4),i}finally{t.__wbindgen_add_to_stack_pointer(16)}}}class Z{static __wrap(t){t>>>=0;let e=Object.create(Z.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){let e=this.__destroy_into_raw();t.__wbg_ravingctx_free(e)}/**
    * @param {HTMLCanvasElement} canvas
    * @returns {Promise<RavingCtx>}
    */static initialize_(e){let n=t.ravingctx_initialize_(A(e));return p(n)}/**
    * @returns {Promise<RavingCtx>}
    */static initialize(){let e=t.ravingctx_initialize();return p(e)}}class K{static __wrap(t){t>>>=0;let e=Object.create(K.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){let e=this.__destroy_into_raw();t.__wbg_segmentpositions_free(e)}/**
    * @param {View2D} view
    * @param {number} canvas_width
    * @param {number} canvas_height
    * @param {Uint32Array} path_slice
    * @param {number} tolerance
    * @returns {CanvasPathTrace}
    */sample_canvas_space_path(e,n,r,i,o){try{let c=t.__wbindgen_add_to_stack_pointer(-16);F(e,tr);let s=j(i,t.__wbindgen_malloc),l=T;t.segmentpositions_sample_canvas_space_path(c,this.__wbg_ptr,e.__wbg_ptr,n,r,s,l,o);var u=y()[c/4+0],a=y()[c/4+1];if(y()[c/4+2])throw p(a);return Y.__wrap(u)}finally{t.__wbindgen_add_to_stack_pointer(16)}}/**
    * @param {View2D} view
    * @param {number} canvas_width
    * @param {number} canvas_height
    * @param {Uint32Array} path_slice
    * @returns {any}
    */path_to_canvas_space_alt(e,n,r,i){F(e,tr);let o=j(i,t.__wbindgen_malloc),u=T,a=t.segmentpositions_path_to_canvas_space_alt(this.__wbg_ptr,e.__wbg_ptr,n,r,o,u);return p(a)}/**
    * @param {View2D} view
    * @param {number} canvas_width
    * @param {number} canvas_height
    * @param {Uint32Array} path_slice
    * @param {number} tolerance
    * @returns {Path2D}
    */path_to_canvas_space(e,n,r,i,o){try{let c=t.__wbindgen_add_to_stack_pointer(-16);F(e,tr);let s=j(i,t.__wbindgen_malloc),l=T;t.segmentpositions_path_to_canvas_space(c,this.__wbg_ptr,e.__wbg_ptr,n,r,s,l,o);var u=y()[c/4+0],a=y()[c/4+1];if(y()[c/4+2])throw p(a);return p(u)}finally{t.__wbindgen_add_to_stack_pointer(16)}}/**
    * @returns {any}
    */bounds_as_view_obj(){let e=t.segmentpositions_bounds_as_view_obj(this.__wbg_ptr);return p(e)}/**
    * @param {number} seg_id
    * @returns {any}
    */segment_pos(e){let n=t.segmentpositions_segment_pos(this.__wbg_ptr,e);return p(n)}/**
    * @param {any} tsv_text
    * @returns {SegmentPositions}
    */static from_tsv(e){try{let i=t.__wbindgen_add_to_stack_pointer(-16);t.segmentpositions_from_tsv(i,A(e));var n=y()[i/4+0],r=y()[i/4+1];if(y()[i/4+2])throw p(r);return K.__wrap(n)}finally{t.__wbindgen_add_to_stack_pointer(16)}}}class tt{static __wrap(t){t>>>=0;let e=Object.create(tt.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){let e=this.__destroy_into_raw();t.__wbg_segmentranges_free(e)}/**
    * @returns {Uint32Array}
    */ranges_as_u32_array(){let e=t.segmentranges_ranges_as_u32_array(this.__wbg_ptr);return p(e)}/**
    * @param {View1D} view
    * @param {number} canvas_width
    * @returns {Float32Array}
    */to_canvas_ranges(e,n){try{let u=t.__wbindgen_add_to_stack_pointer(-16);F(e,tn),t.segmentranges_to_canvas_ranges(u,this.__wbg_ptr,e.__wbg_ptr,n);var r=y()[u/4+0],i=y()[u/4+1],o=L(r,i).slice();return t.__wbindgen_free(r,4*i,4),o}finally{t.__wbindgen_add_to_stack_pointer(16)}}}class te{static __wrap(t){t>>>=0;let e=Object.create(te.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){let e=this.__destroy_into_raw();t.__wbg_sparsedata_free(e)}}class tn{static __wrap(t){t>>>=0;let e=Object.create(tn.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){let e=this.__destroy_into_raw();t.__wbg_view1d_free(e)}/**
    * @param {number} start
    * @param {number} end
    * @param {bigint} max
    * @returns {View1D}
    */static new(e,n,r){let i=t.view1d_new(e,n,r);return tn.__wrap(i)}/**
    * @param {bigint} max
    * @returns {View1D}
    */static new_full(e){let n=t.view1d_new_full(e);return tn.__wrap(n)}/**
    * @returns {number}
    */get start(){let e=t.view1d_start(this.__wbg_ptr);return e}/**
    * @returns {number}
    */get end(){let e=t.view1d_end(this.__wbg_ptr);return e}/**
    * @returns {number}
    */get len(){let e=t.view1d_len(this.__wbg_ptr);return e}/**
    * @returns {number}
    */get max(){let e=t.view1d_max(this.__wbg_ptr);return e}/**
    * @param {number} start
    * @param {number} end
    */set(e,n){t.view1d_set(this.__wbg_ptr,e,n)}/**
    */make_valid(){t.view1d_make_valid(this.__wbg_ptr)}/**
    * @param {number} delta
    */translate(e){t.view1d_translate(this.__wbg_ptr,e)}/**
    * @param {number} fdelta
    */translate_norm(e){t.view1d_translate_norm(this.__wbg_ptr,e)}/**
    * @param {number} t
    * @param {number} s
    */zoom_with_focus(e,n){t.view1d_zoom_with_focus(this.__wbg_ptr,e,n)}}class tr{static __wrap(t){t>>>=0;let e=Object.create(tr.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){let t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){let e=this.__destroy_into_raw();t.__wbg_view2d_free(e)}/**
    * @param {number} width
    * @param {number} height
    * @returns {any}
    */to_js_mat3(e,n){let r=t.view2d_to_js_mat3(this.__wbg_ptr,e,n);return p(r)}/**
    * @returns {any}
    */as_obj(){let e=t.view2d_as_obj(this.__wbg_ptr);return p(e)}/**
    * @param {number} x
    * @param {number} y
    */set_center(e,n){t.view2d_set_center(this.__wbg_ptr,e,n)}/**
    * @param {number} w
    * @param {number} h
    */set_size(e,n){t.view2d_set_size(this.__wbg_ptr,e,n)}/**
    * @param {View2D} other
    * @returns {boolean}
    */equals(e){F(e,tr);let n=t.view2d_equals(this.__wbg_ptr,e.__wbg_ptr);return 0!==n}/**
    * @param {number} dx
    * @param {number} dy
    */translate_direct(e,n){t.view2d_translate_direct(this.__wbg_ptr,e,n)}/**
    * @param {number} dx
    * @param {number} dy
    */translate_size_rel(e,n){t.view2d_translate_size_rel(this.__wbg_ptr,e,n)}/**
    * @param {number} tx
    * @param {number} ty
    * @param {number} s
    */zoom_with_focus(e,n,r){t.view2d_zoom_with_focus(this.__wbg_ptr,e,n,r)}}async function ti(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if("application/wasm"!=t.headers.get("Content-Type"))console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e);else throw e}let n=await t.arrayBuffer();return await WebAssembly.instantiate(n,e)}{let n=await WebAssembly.instantiate(t,e);return n instanceof WebAssembly.Instance?{instance:n,module:t}:n}}var to={};async function tu(e,n){if(void 0!==t)return t;void 0===e&&(e=new URL(to));let r=function(){let e={};return e.wbg={},e.wbg.__wbindgen_object_drop_ref=function(t){p(t)},e.wbg.__wbindgen_number_get=function(e,n){let r=h[n],i="number"==typeof r?r:void 0;((null===m||m.buffer!==t.memory.buffer)&&(m=new Float64Array(t.memory.buffer)),m)[e/8+1]=w(i)?0:i,y()[e/4+0]=!w(i)},e.wbg.__wbindgen_string_new=function(t,e){let n=k(t,e);return A(n)},e.wbg.__wbg_createimagedataimpl_00adc8b86712c39f=function(){return O(function(t,e,n){let r=function(t,e,n){let r=new Uint8ClampedArray(t.buffer,e,n),i=new ArrayBuffer(n),o=new Uint8ClampedArray(i);o.set(r);let u=new ImageData(o,n/4);return u}(p(t),e>>>0,n>>>0);return A(r)},arguments)},e.wbg.__wbindgen_number_new=function(t){return A(t)},e.wbg.__wbindgen_bigint_from_u64=function(t){let e=BigInt.asUintN(64,t);return A(e)},e.wbg.__wbindgen_copy_to_typed_array=function(t,e,n){var r;new Uint8Array(h[n].buffer,h[n].byteOffset,h[n].byteLength).set((r=t>>>0,E().subarray(r/1,r/1+e)))},e.wbg.__wbg_segmentposobj_3c1b3c9356c8495a=function(t,e,n,r){return A({x0:t,y0:e,x1:n,y1:r})},e.wbg.__wbg_createviewobj_7ae74ee6bff38cce=function(t,e,n,r){return A({x:t,y:e,width:n,height:r})},e.wbg.__wbindgen_string_get=function(e,n){let r=h[n],i="string"==typeof r?r:void 0;var o=w(i)?0:I(i,t.__wbindgen_malloc,t.__wbindgen_realloc),u=T;y()[e/4+1]=u,y()[e/4+0]=o},e.wbg.__wbindgen_cb_drop=function(t){let e=p(t).original;return 1==e.cnt--&&(e.a=0,!0)},e.wbg.__wbg_ravingctx_new=function(t){let e=Z.__wrap(t);return A(e)},e.wbg.__wbg_arrowgfawrapped_new=function(t){let e=$.__wrap(t);return A(e)},e.wbg.__wbg_createmat3impl_9e2277e13e3da595=function(t,e){let n=function(t,e){let n=new Float32Array(t.buffer,e,9),r=new ArrayBuffer(36),i=new Float32Array(r);return i.set(n),i}(p(t),e>>>0);return A(n)},e.wbg.__wbindgen_object_clone_ref=function(t){let e=h[t];return A(e)},e.wbg.__wbg_new_abda76e883ba8a5f=function(){let t=Error();return A(t)},e.wbg.__wbg_stack_658279fe44541cf6=function(e,n){let r=h[n].stack,i=I(r,t.__wbindgen_malloc,t.__wbindgen_realloc),o=T;y()[e/4+1]=o,y()[e/4+0]=i},e.wbg.__wbg_error_f851667af71bcfc6=function(e,n){let r,i;try{r=e,i=n,console.error(k(e,n))}finally{t.__wbindgen_free(r,i,1)}},e.wbg.__wbg_waitAsync_60fb5e2e86467e31=function(){let t=Atomics.waitAsync;return A(t)},e.wbg.__wbindgen_is_undefined=function(t){let e=void 0===h[t];return e},e.wbg.__wbg_waitAsync_73fd6eb3bace0a8d=function(t,e,n){let r=Atomics.waitAsync(h[t],e,n);return A(r)},e.wbg.__wbg_async_e1a2a669aacf35ff=function(t){let e=h[t].async;return e},e.wbg.__wbg_value_555e4f564193db05=function(t){let e=h[t].value;return A(e)},e.wbg.__wbindgen_link_22046963fe0b707a=function(e){let n="data:application/javascript,"+encodeURIComponent(`onmessage = function (ev) {
            let [ia, index, value] = ev.data;
            ia = new Int32Array(ia.buffer);
            let result = Atomics.wait(ia, index, value);
            postMessage(result);
        };
        `),r=I(n,t.__wbindgen_malloc,t.__wbindgen_realloc),i=T;y()[e/4+1]=i,y()[e/4+0]=r},e.wbg.__wbg_crypto_c48a774b022d20ac=function(t){let e=h[t].crypto;return A(e)},e.wbg.__wbindgen_is_object=function(t){let e=h[t];return"object"==typeof e&&null!==e},e.wbg.__wbg_process_298734cf255a885d=function(t){let e=h[t].process;return A(e)},e.wbg.__wbg_versions_e2e78e134e3e5d01=function(t){let e=h[t].versions;return A(e)},e.wbg.__wbg_node_1cd7a5d853dbea79=function(t){let e=h[t].node;return A(e)},e.wbg.__wbindgen_is_string=function(t){let e="string"==typeof h[t];return e},e.wbg.__wbg_msCrypto_bcb970640f50a1e8=function(t){let e=h[t].msCrypto;return A(e)},e.wbg.__wbg_require_8f08ceecec0f4fee=function(){return O(function(){let t=module.require;return A(t)},arguments)},e.wbg.__wbindgen_is_function=function(t){let e="function"==typeof h[t];return e},e.wbg.__wbg_getRandomValues_37fa2ca9e4e07fab=function(){return O(function(t,e){h[t].getRandomValues(h[e])},arguments)},e.wbg.__wbg_randomFillSync_dc1e9a60c158336d=function(){return O(function(t,e){h[t].randomFillSync(p(e))},arguments)},e.wbg.__wbindgen_boolean_get=function(t){let e=h[t];return"boolean"==typeof e?e?1:0:2},e.wbg.__wbg_instanceof_WebGl2RenderingContext_f921526c513bf717=function(t){let e;try{e=h[t]instanceof WebGL2RenderingContext}catch(t){e=!1}let n=e;return n},e.wbg.__wbg_beginQuery_d338463adf721553=function(t,e,n){h[t].beginQuery(e>>>0,h[n])},e.wbg.__wbg_bindBufferRange_d8a5ebc8ea8be507=function(t,e,n,r,i,o){h[t].bindBufferRange(e>>>0,n>>>0,h[r],i,o)},e.wbg.__wbg_bindSampler_d74e398b68cf5980=function(t,e,n){h[t].bindSampler(e>>>0,h[n])},e.wbg.__wbg_bindVertexArray_8863a216d7b0a339=function(t,e){h[t].bindVertexArray(h[e])},e.wbg.__wbg_blitFramebuffer_e6642748dd06d47e=function(t,e,n,r,i,o,u,a,c,s,l){h[t].blitFramebuffer(e,n,r,i,o,u,a,c,s>>>0,l>>>0)},e.wbg.__wbg_bufferData_496bbb31639d9850=function(t,e,n,r){h[t].bufferData(e>>>0,n,r>>>0)},e.wbg.__wbg_bufferData_21334671c4ba6004=function(t,e,n,r){h[t].bufferData(e>>>0,h[n],r>>>0)},e.wbg.__wbg_bufferSubData_c472b93c9e272eac=function(t,e,n,r){h[t].bufferSubData(e>>>0,n,h[r])},e.wbg.__wbg_clearBufferfi_25bcd35b825f629d=function(t,e,n,r,i){h[t].clearBufferfi(e>>>0,n,r,i)},e.wbg.__wbg_clearBufferfv_9de0cb45cc5a012b=function(t,e,n,r,i){h[t].clearBufferfv(e>>>0,n,L(r,i))},e.wbg.__wbg_clearBufferiv_fc2f8bce2930c586=function(t,e,n,r,i){h[t].clearBufferiv(e>>>0,n,H(r,i))},e.wbg.__wbg_clearBufferuiv_2f6d220a31eabca4=function(t,e,n,r,i){h[t].clearBufferuiv(e>>>0,n,W(r,i))},e.wbg.__wbg_clientWaitSync_6a74725ec890efdd=function(t,e,n,r){let i=h[t].clientWaitSync(h[e],n>>>0,r>>>0);return i},e.wbg.__wbg_compressedTexSubImage2D_945ba54869f3a612=function(t,e,n,r,i,o,u,a,c,s){h[t].compressedTexSubImage2D(e>>>0,n,r,i,o,u,a>>>0,c,s)},e.wbg.__wbg_compressedTexSubImage2D_ed56fa2f82a839b1=function(t,e,n,r,i,o,u,a,c){h[t].compressedTexSubImage2D(e>>>0,n,r,i,o,u,a>>>0,h[c])},e.wbg.__wbg_compressedTexSubImage3D_4cebeae1440fdc14=function(t,e,n,r,i,o,u,a,c,s,l,f){h[t].compressedTexSubImage3D(e>>>0,n,r,i,o,u,a,c,s>>>0,l,f)},e.wbg.__wbg_compressedTexSubImage3D_0ae61aaa91089745=function(t,e,n,r,i,o,u,a,c,s,l){h[t].compressedTexSubImage3D(e>>>0,n,r,i,o,u,a,c,s>>>0,h[l])},e.wbg.__wbg_copyBufferSubData_d112912c90270156=function(t,e,n,r,i,o){h[t].copyBufferSubData(e>>>0,n>>>0,r,i,o)},e.wbg.__wbg_copyTexSubImage3D_9fa5e9e7b16cf09d=function(t,e,n,r,i,o,u,a,c,s){h[t].copyTexSubImage3D(e>>>0,n,r,i,o,u,a,c,s)},e.wbg.__wbg_createQuery_2ef2dc0f01a4a8e3=function(t){let e=h[t].createQuery();return w(e)?0:A(e)},e.wbg.__wbg_createSampler_039ecd204675292b=function(t){let e=h[t].createSampler();return w(e)?0:A(e)},e.wbg.__wbg_createVertexArray_51d51e1e1e13e9f6=function(t){let e=h[t].createVertexArray();return w(e)?0:A(e)},e.wbg.__wbg_deleteQuery_0c64c5200cdc57a6=function(t,e){h[t].deleteQuery(h[e])},e.wbg.__wbg_deleteSampler_ce5b8e120f96fc1a=function(t,e){h[t].deleteSampler(h[e])},e.wbg.__wbg_deleteSync_1b05dfcc176e7466=function(t,e){h[t].deleteSync(h[e])},e.wbg.__wbg_deleteVertexArray_3e4f2e2ff7f05a19=function(t,e){h[t].deleteVertexArray(h[e])},e.wbg.__wbg_drawArraysInstanced_8fb13fe9faf95212=function(t,e,n,r,i){h[t].drawArraysInstanced(e>>>0,n,r,i)},e.wbg.__wbg_drawBuffers_15d26e17a8d24ee0=function(t,e){h[t].drawBuffers(h[e])},e.wbg.__wbg_drawElementsInstanced_dcf53461a977d44c=function(t,e,n,r,i,o){h[t].drawElementsInstanced(e>>>0,n,r>>>0,i,o)},e.wbg.__wbg_endQuery_faf7eb231d6f2a66=function(t,e){h[t].endQuery(e>>>0)},e.wbg.__wbg_fenceSync_d68dcbdcdd134d92=function(t,e,n){let r=h[t].fenceSync(e>>>0,n>>>0);return w(r)?0:A(r)},e.wbg.__wbg_framebufferTextureLayer_a92788e5f0409234=function(t,e,n,r,i,o){h[t].framebufferTextureLayer(e>>>0,n>>>0,h[r],i,o)},e.wbg.__wbg_getBufferSubData_8710cc73621fc332=function(t,e,n,r){h[t].getBufferSubData(e>>>0,n,h[r])},e.wbg.__wbg_getIndexedParameter_4f004dc25c3d15a9=function(){return O(function(t,e,n){let r=h[t].getIndexedParameter(e>>>0,n>>>0);return A(r)},arguments)},e.wbg.__wbg_getQueryParameter_64c18ef385414bf1=function(t,e,n){let r=h[t].getQueryParameter(h[e],n>>>0);return A(r)},e.wbg.__wbg_getSyncParameter_d93ec7f6bb11274c=function(t,e,n){let r=h[t].getSyncParameter(h[e],n>>>0);return A(r)},e.wbg.__wbg_getUniformBlockIndex_99c15053c9a87c73=function(t,e,n,r){let i=h[t].getUniformBlockIndex(h[e],k(n,r));return i},e.wbg.__wbg_invalidateFramebuffer_03bd99588b15d627=function(){return O(function(t,e,n){h[t].invalidateFramebuffer(e>>>0,h[n])},arguments)},e.wbg.__wbg_readBuffer_c426fe18344296ff=function(t,e){h[t].readBuffer(e>>>0)},e.wbg.__wbg_readPixels_99fda83f6ca7ec72=function(){return O(function(t,e,n,r,i,o,u,a){h[t].readPixels(e,n,r,i,o>>>0,u>>>0,h[a])},arguments)},e.wbg.__wbg_readPixels_9634f0dcfb54667c=function(){return O(function(t,e,n,r,i,o,u,a){h[t].readPixels(e,n,r,i,o>>>0,u>>>0,a)},arguments)},e.wbg.__wbg_renderbufferStorageMultisample_9260e2e620c949e5=function(t,e,n,r,i,o){h[t].renderbufferStorageMultisample(e>>>0,n,r>>>0,i,o)},e.wbg.__wbg_samplerParameterf_1c7562ef061b803b=function(t,e,n,r){h[t].samplerParameterf(h[e],n>>>0,r)},e.wbg.__wbg_samplerParameteri_0fee083bc48e70ee=function(t,e,n,r){h[t].samplerParameteri(h[e],n>>>0,r)},e.wbg.__wbg_texStorage2D_6665d01025a7e7fc=function(t,e,n,r,i,o){h[t].texStorage2D(e>>>0,n,r>>>0,i,o)},e.wbg.__wbg_texStorage3D_c01c31c1b02d75fd=function(t,e,n,r,i,o,u){h[t].texStorage3D(e>>>0,n,r>>>0,i,o,u)},e.wbg.__wbg_texSubImage2D_d2841ded12a8aa66=function(){return O(function(t,e,n,r,i,o,u,a,c,s){h[t].texSubImage2D(e>>>0,n,r,i,o,u,a>>>0,c>>>0,h[s])},arguments)},e.wbg.__wbg_texSubImage2D_bccf4e250f1ce1b8=function(){return O(function(t,e,n,r,i,o,u,a,c,s){h[t].texSubImage2D(e>>>0,n,r,i,o,u,a>>>0,c>>>0,s)},arguments)},e.wbg.__wbg_texSubImage2D_780a7c889dc20a98=function(){return O(function(t,e,n,r,i,o,u,a,c,s){h[t].texSubImage2D(e>>>0,n,r,i,o,u,a>>>0,c>>>0,h[s])},arguments)},e.wbg.__wbg_texSubImage2D_b5bb36f2f54b4264=function(){return O(function(t,e,n,r,i,o,u,a,c,s){h[t].texSubImage2D(e>>>0,n,r,i,o,u,a>>>0,c>>>0,h[s])},arguments)},e.wbg.__wbg_texSubImage2D_a297114050ea1098=function(){return O(function(t,e,n,r,i,o,u,a,c,s){h[t].texSubImage2D(e>>>0,n,r,i,o,u,a>>>0,c>>>0,h[s])},arguments)},e.wbg.__wbg_texSubImage3D_43f39a73ed02fae3=function(){return O(function(t,e,n,r,i,o,u,a,c,s,l,f){h[t].texSubImage3D(e>>>0,n,r,i,o,u,a,c,s>>>0,l>>>0,f)},arguments)},e.wbg.__wbg_texSubImage3D_ffdccca1422b482a=function(){return O(function(t,e,n,r,i,o,u,a,c,s,l,f){h[t].texSubImage3D(e>>>0,n,r,i,o,u,a,c,s>>>0,l>>>0,h[f])},arguments)},e.wbg.__wbg_texSubImage3D_69d5e09d45e0251c=function(){return O(function(t,e,n,r,i,o,u,a,c,s,l,f){h[t].texSubImage3D(e>>>0,n,r,i,o,u,a,c,s>>>0,l>>>0,h[f])},arguments)},e.wbg.__wbg_texSubImage3D_ae3ed5d0154c346c=function(){return O(function(t,e,n,r,i,o,u,a,c,s,l,f){h[t].texSubImage3D(e>>>0,n,r,i,o,u,a,c,s>>>0,l>>>0,h[f])},arguments)},e.wbg.__wbg_texSubImage3D_80693fc2c7855e4d=function(){return O(function(t,e,n,r,i,o,u,a,c,s,l,f){h[t].texSubImage3D(e>>>0,n,r,i,o,u,a,c,s>>>0,l>>>0,h[f])},arguments)},e.wbg.__wbg_uniform2fv_2b473f6dce24c898=function(t,e,n,r){h[t].uniform2fv(h[e],L(n,r))},e.wbg.__wbg_uniform2iv_fdaa3cd258d3451e=function(t,e,n,r){h[t].uniform2iv(h[e],H(n,r))},e.wbg.__wbg_uniform3fv_3e55033ca16ec6ab=function(t,e,n,r){h[t].uniform3fv(h[e],L(n,r))},e.wbg.__wbg_uniform3iv_3d3ed90c76e6777e=function(t,e,n,r){h[t].uniform3iv(h[e],H(n,r))},e.wbg.__wbg_uniform4fv_26ec0c9d7bf6d7c6=function(t,e,n,r){h[t].uniform4fv(h[e],L(n,r))},e.wbg.__wbg_uniform4iv_2be6b77c47b90d81=function(t,e,n,r){h[t].uniform4iv(h[e],H(n,r))},e.wbg.__wbg_uniformBlockBinding_0dc4bd81bb4ccb6a=function(t,e,n,r){h[t].uniformBlockBinding(h[e],n>>>0,r>>>0)},e.wbg.__wbg_uniformMatrix2fv_1ab7aeb8562ea3dd=function(t,e,n,r,i){h[t].uniformMatrix2fv(h[e],0!==n,L(r,i))},e.wbg.__wbg_uniformMatrix3fv_0b151be4d76ee66b=function(t,e,n,r,i){h[t].uniformMatrix3fv(h[e],0!==n,L(r,i))},e.wbg.__wbg_uniformMatrix4fv_766b5ba343983038=function(t,e,n,r,i){h[t].uniformMatrix4fv(h[e],0!==n,L(r,i))},e.wbg.__wbg_vertexAttribDivisor_197e2e23e3fbde7f=function(t,e,n){h[t].vertexAttribDivisor(e>>>0,n>>>0)},e.wbg.__wbg_vertexAttribIPointer_6f8540e358f8a547=function(t,e,n,r,i,o){h[t].vertexAttribIPointer(e>>>0,n,r>>>0,i,o)},e.wbg.__wbg_activeTexture_799bf1387e911c27=function(t,e){h[t].activeTexture(e>>>0)},e.wbg.__wbg_attachShader_47256b6b3d42a22e=function(t,e,n){h[t].attachShader(h[e],h[n])},e.wbg.__wbg_bindBuffer_24f6010e273fa400=function(t,e,n){h[t].bindBuffer(e>>>0,h[n])},e.wbg.__wbg_bindFramebuffer_a9573e340dab20fe=function(t,e,n){h[t].bindFramebuffer(e>>>0,h[n])},e.wbg.__wbg_bindRenderbuffer_54c404711f9b6958=function(t,e,n){h[t].bindRenderbuffer(e>>>0,h[n])},e.wbg.__wbg_bindTexture_92d6d7f8bff9531e=function(t,e,n){h[t].bindTexture(e>>>0,h[n])},e.wbg.__wbg_blendColor_7974f09cb60d2be0=function(t,e,n,r,i){h[t].blendColor(e,n,r,i)},e.wbg.__wbg_blendEquation_12146cb96dc1bcd9=function(t,e){h[t].blendEquation(e>>>0)},e.wbg.__wbg_blendEquationSeparate_205526dad772d160=function(t,e,n){h[t].blendEquationSeparate(e>>>0,n>>>0)},e.wbg.__wbg_blendFunc_533de6de45b80a09=function(t,e,n){h[t].blendFunc(e>>>0,n>>>0)},e.wbg.__wbg_blendFuncSeparate_fbf93dee3e5ce456=function(t,e,n,r,i){h[t].blendFuncSeparate(e>>>0,n>>>0,r>>>0,i>>>0)},e.wbg.__wbg_colorMask_fba1e2efd891e2ac=function(t,e,n,r,i){h[t].colorMask(0!==e,0!==n,0!==r,0!==i)},e.wbg.__wbg_compileShader_6bf78b425d5c98e1=function(t,e){h[t].compileShader(h[e])},e.wbg.__wbg_copyTexSubImage2D_26685100d5f2b4c0=function(t,e,n,r,i,o,u,a,c){h[t].copyTexSubImage2D(e>>>0,n,r,i,o,u,a,c)},e.wbg.__wbg_createBuffer_323425af422748ac=function(t){let e=h[t].createBuffer();return w(e)?0:A(e)},e.wbg.__wbg_createFramebuffer_1684a99697ac9563=function(t){let e=h[t].createFramebuffer();return w(e)?0:A(e)},e.wbg.__wbg_createProgram_4eaf3b97b5747a62=function(t){let e=h[t].createProgram();return w(e)?0:A(e)},e.wbg.__wbg_createRenderbuffer_3e6dd356d7897ed7=function(t){let e=h[t].createRenderbuffer();return w(e)?0:A(e)},e.wbg.__wbg_createShader_429776c9dd6fb87b=function(t,e){let n=h[t].createShader(e>>>0);return w(n)?0:A(n)},e.wbg.__wbg_createTexture_1bf4d6fec570124b=function(t){let e=h[t].createTexture();return w(e)?0:A(e)},e.wbg.__wbg_cullFace_6daa9f2aa42b4620=function(t,e){h[t].cullFace(e>>>0)},e.wbg.__wbg_deleteBuffer_2c09d03fa4b0bd08=function(t,e){h[t].deleteBuffer(h[e])},e.wbg.__wbg_deleteFramebuffer_edd16bb8df6a8e0d=function(t,e){h[t].deleteFramebuffer(h[e])},e.wbg.__wbg_deleteProgram_53a32852f245b839=function(t,e){h[t].deleteProgram(h[e])},e.wbg.__wbg_deleteRenderbuffer_134040051fcc1ba5=function(t,e){h[t].deleteRenderbuffer(h[e])},e.wbg.__wbg_deleteShader_7c1222349324b5e2=function(t,e){h[t].deleteShader(h[e])},e.wbg.__wbg_deleteTexture_4fcfea73cd8f6214=function(t,e){h[t].deleteTexture(h[e])},e.wbg.__wbg_depthFunc_fb41ad353d07948d=function(t,e){h[t].depthFunc(e>>>0)},e.wbg.__wbg_depthMask_6a4ff02cd2a2702e=function(t,e){h[t].depthMask(0!==e)},e.wbg.__wbg_depthRange_a5647a9040aec55b=function(t,e,n){h[t].depthRange(e,n)},e.wbg.__wbg_disable_e02106ca6c7002d6=function(t,e){h[t].disable(e>>>0)},e.wbg.__wbg_disableVertexAttribArray_6d57776c8f642f44=function(t,e){h[t].disableVertexAttribArray(e>>>0)},e.wbg.__wbg_drawArrays_c91ce3f736bf1f2a=function(t,e,n,r){h[t].drawArrays(e>>>0,n,r)},e.wbg.__wbg_enable_195891416c520019=function(t,e){h[t].enable(e>>>0)},e.wbg.__wbg_enableVertexAttribArray_8804480c2ea0bb72=function(t,e){h[t].enableVertexAttribArray(e>>>0)},e.wbg.__wbg_framebufferRenderbuffer_3ec0983918c2b69d=function(t,e,n,r,i){h[t].framebufferRenderbuffer(e>>>0,n>>>0,r>>>0,h[i])},e.wbg.__wbg_framebufferTexture2D_e88fcbd7f8523bb8=function(t,e,n,r,i,o){h[t].framebufferTexture2D(e>>>0,n>>>0,r>>>0,h[i],o)},e.wbg.__wbg_frontFace_786a036f1d643925=function(t,e){h[t].frontFace(e>>>0)},e.wbg.__wbg_getActiveUniform_78367ddc7339640b=function(t,e,n){let r=h[t].getActiveUniform(h[e],n>>>0);return w(r)?0:A(r)},e.wbg.__wbg_getExtension_77909f6d51d49d4d=function(){return O(function(t,e,n){let r=h[t].getExtension(k(e,n));return w(r)?0:A(r)},arguments)},e.wbg.__wbg_getParameter_55b36a787dbbfb74=function(){return O(function(t,e){let n=h[t].getParameter(e>>>0);return A(n)},arguments)},e.wbg.__wbg_getProgramInfoLog_b81bc53188e286fa=function(e,n,r){let i=h[n].getProgramInfoLog(h[r]);var o=w(i)?0:I(i,t.__wbindgen_malloc,t.__wbindgen_realloc),u=T;y()[e/4+1]=u,y()[e/4+0]=o},e.wbg.__wbg_getProgramParameter_35522a0bfdfaad27=function(t,e,n){let r=h[t].getProgramParameter(h[e],n>>>0);return A(r)},e.wbg.__wbg_getShaderInfoLog_968b93e75477d725=function(e,n,r){let i=h[n].getShaderInfoLog(h[r]);var o=w(i)?0:I(i,t.__wbindgen_malloc,t.__wbindgen_realloc),u=T;y()[e/4+1]=u,y()[e/4+0]=o},e.wbg.__wbg_getShaderParameter_ac2727ae4fe7648e=function(t,e,n){let r=h[t].getShaderParameter(h[e],n>>>0);return A(r)},e.wbg.__wbg_getSupportedExtensions_fafc31aab913037d=function(t){let e=h[t].getSupportedExtensions();return w(e)?0:A(e)},e.wbg.__wbg_getUniformLocation_9f6eb60c560a347b=function(t,e,n,r){let i=h[t].getUniformLocation(h[e],k(n,r));return w(i)?0:A(i)},e.wbg.__wbg_linkProgram_33998194075d71fb=function(t,e){h[t].linkProgram(h[e])},e.wbg.__wbg_pixelStorei_f3a24990aa352fc7=function(t,e,n){h[t].pixelStorei(e>>>0,n)},e.wbg.__wbg_polygonOffset_faca8e73770272ff=function(t,e,n){h[t].polygonOffset(e,n)},e.wbg.__wbg_renderbufferStorage_987d1af7c9faf5dd=function(t,e,n,r,i){h[t].renderbufferStorage(e>>>0,n>>>0,r,i)},e.wbg.__wbg_scissor_e8e41e1c0a9817c8=function(t,e,n,r,i){h[t].scissor(e,n,r,i)},e.wbg.__wbg_shaderSource_1cb7c64dc7d1a500=function(t,e,n,r){h[t].shaderSource(h[e],k(n,r))},e.wbg.__wbg_stencilFuncSeparate_8ff94e24a50a3c45=function(t,e,n,r,i){h[t].stencilFuncSeparate(e>>>0,n>>>0,r,i>>>0)},e.wbg.__wbg_stencilMask_641f92999dd3c3de=function(t,e){h[t].stencilMask(e>>>0)},e.wbg.__wbg_stencilMaskSeparate_6b2c8ef22fb3b6d1=function(t,e,n){h[t].stencilMaskSeparate(e>>>0,n>>>0)},e.wbg.__wbg_stencilOpSeparate_38925591af8feb44=function(t,e,n,r,i){h[t].stencilOpSeparate(e>>>0,n>>>0,r>>>0,i>>>0)},e.wbg.__wbg_texParameteri_85dad939f62a15aa=function(t,e,n,r){h[t].texParameteri(e>>>0,n>>>0,r)},e.wbg.__wbg_uniform1f_88379f4e2630bc66=function(t,e,n){h[t].uniform1f(h[e],n)},e.wbg.__wbg_uniform1i_d2e61a6a43889648=function(t,e,n){h[t].uniform1i(h[e],n)},e.wbg.__wbg_uniform4f_a9fd337d4b07f595=function(t,e,n,r,i,o){h[t].uniform4f(h[e],n,r,i,o)},e.wbg.__wbg_useProgram_3683cf6f60939dcd=function(t,e){h[t].useProgram(h[e])},e.wbg.__wbg_vertexAttribPointer_316ffe2f0458fde7=function(t,e,n,r,i,o,u){h[t].vertexAttribPointer(e>>>0,n,r>>>0,0!==i,o,u)},e.wbg.__wbg_viewport_fad1ce9e18f741c0=function(t,e,n,r,i){h[t].viewport(e,n,r,i)},e.wbg.__wbg_instanceof_Window_9029196b662bc42a=function(t){let e;try{e=h[t]instanceof Window}catch(t){e=!1}let n=e;return n},e.wbg.__wbg_document_f7ace2b956f30a4f=function(t){let e=h[t].document;return w(e)?0:A(e)},e.wbg.__wbg_querySelector_52ded52c20e23921=function(){return O(function(t,e,n){let r=h[t].querySelector(k(e,n));return w(r)?0:A(r)},arguments)},e.wbg.__wbg_bufferData_92a3e0b745b0d726=function(t,e,n,r){h[t].bufferData(e>>>0,n,r>>>0)},e.wbg.__wbg_bufferData_a11a9f65f31e7256=function(t,e,n,r){h[t].bufferData(e>>>0,h[n],r>>>0)},e.wbg.__wbg_bufferSubData_fca6f1c10273be21=function(t,e,n,r){h[t].bufferSubData(e>>>0,n,h[r])},e.wbg.__wbg_compressedTexSubImage2D_21078c6de0a71aad=function(t,e,n,r,i,o,u,a,c){h[t].compressedTexSubImage2D(e>>>0,n,r,i,o,u,a>>>0,h[c])},e.wbg.__wbg_readPixels_91b0d8854de90477=function(){return O(function(t,e,n,r,i,o,u,a){h[t].readPixels(e,n,r,i,o>>>0,u>>>0,h[a])},arguments)},e.wbg.__wbg_texSubImage2D_f1a31f8045b7f831=function(){return O(function(t,e,n,r,i,o,u,a,c,s){h[t].texSubImage2D(e>>>0,n,r,i,o,u,a>>>0,c>>>0,h[s])},arguments)},e.wbg.__wbg_uniform2fv_c928f6ba0085b381=function(t,e,n,r){h[t].uniform2fv(h[e],L(n,r))},e.wbg.__wbg_uniform2iv_7e5f8e7c2f4d4d6a=function(t,e,n,r){h[t].uniform2iv(h[e],H(n,r))},e.wbg.__wbg_uniform3fv_1aba437b913c1926=function(t,e,n,r){h[t].uniform3fv(h[e],L(n,r))},e.wbg.__wbg_uniform3iv_23751fe4dfcdf539=function(t,e,n,r){h[t].uniform3iv(h[e],H(n,r))},e.wbg.__wbg_uniform4fv_7c51c2251d851cb2=function(t,e,n,r){h[t].uniform4fv(h[e],L(n,r))},e.wbg.__wbg_uniform4iv_27b49984e9c5d90a=function(t,e,n,r){h[t].uniform4iv(h[e],H(n,r))},e.wbg.__wbg_uniformMatrix2fv_f8f3ef807f196bf1=function(t,e,n,r,i){h[t].uniformMatrix2fv(h[e],0!==n,L(r,i))},e.wbg.__wbg_uniformMatrix3fv_341eec37953e50c5=function(t,e,n,r,i){h[t].uniformMatrix3fv(h[e],0!==n,L(r,i))},e.wbg.__wbg_uniformMatrix4fv_465ab8de531f4f78=function(t,e,n,r,i){h[t].uniformMatrix4fv(h[e],0!==n,L(r,i))},e.wbg.__wbg_activeTexture_93b4de60af07da9c=function(t,e){h[t].activeTexture(e>>>0)},e.wbg.__wbg_attachShader_b65b695055670cb5=function(t,e,n){h[t].attachShader(h[e],h[n])},e.wbg.__wbg_bindBuffer_313561e5bc0e533f=function(t,e,n){h[t].bindBuffer(e>>>0,h[n])},e.wbg.__wbg_bindFramebuffer_56bf6536a4ced0ec=function(t,e,n){h[t].bindFramebuffer(e>>>0,h[n])},e.wbg.__wbg_bindRenderbuffer_559c7c6b6676dddd=function(t,e,n){h[t].bindRenderbuffer(e>>>0,h[n])},e.wbg.__wbg_bindTexture_9cb5c770d1ba2cca=function(t,e,n){h[t].bindTexture(e>>>0,h[n])},e.wbg.__wbg_blendColor_b9006ef6c450acd0=function(t,e,n,r,i){h[t].blendColor(e,n,r,i)},e.wbg.__wbg_blendEquation_f31ce08020786a09=function(t,e){h[t].blendEquation(e>>>0)},e.wbg.__wbg_blendEquationSeparate_7ec5e34f066e44f8=function(t,e,n){h[t].blendEquationSeparate(e>>>0,n>>>0)},e.wbg.__wbg_blendFunc_fbe9d3a688fe71c3=function(t,e,n){h[t].blendFunc(e>>>0,n>>>0)},e.wbg.__wbg_blendFuncSeparate_7547ade0a7dfade2=function(t,e,n,r,i){h[t].blendFuncSeparate(e>>>0,n>>>0,r>>>0,i>>>0)},e.wbg.__wbg_colorMask_7cbd7a102954ede9=function(t,e,n,r,i){h[t].colorMask(0!==e,0!==n,0!==r,0!==i)},e.wbg.__wbg_compileShader_d88d0a8cd9b72b4d=function(t,e){h[t].compileShader(h[e])},e.wbg.__wbg_copyTexSubImage2D_3029f8dfe7543ab6=function(t,e,n,r,i,o,u,a,c){h[t].copyTexSubImage2D(e>>>0,n,r,i,o,u,a,c)},e.wbg.__wbg_createBuffer_59051f4461e7c5e2=function(t){let e=h[t].createBuffer();return w(e)?0:A(e)},e.wbg.__wbg_createFramebuffer_223c1212ad76affc=function(t){let e=h[t].createFramebuffer();return w(e)?0:A(e)},e.wbg.__wbg_createProgram_88dbe21c0b682e1a=function(t){let e=h[t].createProgram();return w(e)?0:A(e)},e.wbg.__wbg_createRenderbuffer_bcb61b756ba21490=function(t){let e=h[t].createRenderbuffer();return w(e)?0:A(e)},e.wbg.__wbg_createShader_9d7d388633caad18=function(t,e){let n=h[t].createShader(e>>>0);return w(n)?0:A(n)},e.wbg.__wbg_createTexture_9d0bb4d741b8ad76=function(t){let e=h[t].createTexture();return w(e)?0:A(e)},e.wbg.__wbg_cullFace_4c086dc1d86a19b5=function(t,e){h[t].cullFace(e>>>0)},e.wbg.__wbg_deleteBuffer_cdc6b9c73f54aff7=function(t,e){h[t].deleteBuffer(h[e])},e.wbg.__wbg_deleteFramebuffer_fcc10cb143c6573d=function(t,e){h[t].deleteFramebuffer(h[e])},e.wbg.__wbg_deleteProgram_d8d7fc79ba83b256=function(t,e){h[t].deleteProgram(h[e])},e.wbg.__wbg_deleteRenderbuffer_edf9e1b4e0a1e005=function(t,e){h[t].deleteRenderbuffer(h[e])},e.wbg.__wbg_deleteShader_9a2f85efe5cb3706=function(t,e){h[t].deleteShader(h[e])},e.wbg.__wbg_deleteTexture_a883356c5034d482=function(t,e){h[t].deleteTexture(h[e])},e.wbg.__wbg_depthFunc_4eda7b4e682acbad=function(t,e){h[t].depthFunc(e>>>0)},e.wbg.__wbg_depthMask_a3071e13bb087102=function(t,e){h[t].depthMask(0!==e)},e.wbg.__wbg_depthRange_ff5298a73fd02650=function(t,e,n){h[t].depthRange(e,n)},e.wbg.__wbg_disable_5cf2070641fa2ed7=function(t,e){h[t].disable(e>>>0)},e.wbg.__wbg_disableVertexAttribArray_8dacd44e21adcaa2=function(t,e){h[t].disableVertexAttribArray(e>>>0)},e.wbg.__wbg_drawArrays_d5c7dc2b2376c85a=function(t,e,n,r){h[t].drawArrays(e>>>0,n,r)},e.wbg.__wbg_enable_8965e69c596f0a94=function(t,e){h[t].enable(e>>>0)},e.wbg.__wbg_enableVertexAttribArray_2b0475db43533cf2=function(t,e){h[t].enableVertexAttribArray(e>>>0)},e.wbg.__wbg_framebufferRenderbuffer_d80f5381d429bc45=function(t,e,n,r,i){h[t].framebufferRenderbuffer(e>>>0,n>>>0,r>>>0,h[i])},e.wbg.__wbg_framebufferTexture2D_953e69a8bec22fa9=function(t,e,n,r,i,o){h[t].framebufferTexture2D(e>>>0,n>>>0,r>>>0,h[i],o)},e.wbg.__wbg_frontFace_0ba67b9e6365557c=function(t,e){h[t].frontFace(e>>>0)},e.wbg.__wbg_getActiveUniform_87df972e841afed2=function(t,e,n){let r=h[t].getActiveUniform(h[e],n>>>0);return w(r)?0:A(r)},e.wbg.__wbg_getParameter_bfab7f0b00c9d7fb=function(){return O(function(t,e){let n=h[t].getParameter(e>>>0);return A(n)},arguments)},e.wbg.__wbg_getProgramInfoLog_0b7af4ad85fa52a4=function(e,n,r){let i=h[n].getProgramInfoLog(h[r]);var o=w(i)?0:I(i,t.__wbindgen_malloc,t.__wbindgen_realloc),u=T;y()[e/4+1]=u,y()[e/4+0]=o},e.wbg.__wbg_getProgramParameter_2a3735278367f8bc=function(t,e,n){let r=h[t].getProgramParameter(h[e],n>>>0);return A(r)},e.wbg.__wbg_getShaderInfoLog_979aafa403ffb252=function(e,n,r){let i=h[n].getShaderInfoLog(h[r]);var o=w(i)?0:I(i,t.__wbindgen_malloc,t.__wbindgen_realloc),u=T;y()[e/4+1]=u,y()[e/4+0]=o},e.wbg.__wbg_getShaderParameter_e8054f1d9026fb70=function(t,e,n){let r=h[t].getShaderParameter(h[e],n>>>0);return A(r)},e.wbg.__wbg_getUniformLocation_688976233799a45a=function(t,e,n,r){let i=h[t].getUniformLocation(h[e],k(n,r));return w(i)?0:A(i)},e.wbg.__wbg_linkProgram_9a2d12d120d99917=function(t,e){h[t].linkProgram(h[e])},e.wbg.__wbg_pixelStorei_5ec932ebefd00149=function(t,e,n){h[t].pixelStorei(e>>>0,n)},e.wbg.__wbg_polygonOffset_55eea57bba1b49e9=function(t,e,n){h[t].polygonOffset(e,n)},e.wbg.__wbg_renderbufferStorage_4bcd9ddf1749ce26=function(t,e,n,r,i){h[t].renderbufferStorage(e>>>0,n>>>0,r,i)},e.wbg.__wbg_scissor_c8ec3b1e053f3756=function(t,e,n,r,i){h[t].scissor(e,n,r,i)},e.wbg.__wbg_shaderSource_f435f9b74440bb54=function(t,e,n,r){h[t].shaderSource(h[e],k(n,r))},e.wbg.__wbg_stencilFuncSeparate_0fae0ee7c04a23b2=function(t,e,n,r,i){h[t].stencilFuncSeparate(e>>>0,n>>>0,r,i>>>0)},e.wbg.__wbg_stencilMask_79416c29ac1ce3a4=function(t,e){h[t].stencilMask(e>>>0)},e.wbg.__wbg_stencilMaskSeparate_19bdb57664d2c34f=function(t,e,n){h[t].stencilMaskSeparate(e>>>0,n>>>0)},e.wbg.__wbg_stencilOpSeparate_18e0bd316555925f=function(t,e,n,r,i){h[t].stencilOpSeparate(e>>>0,n>>>0,r>>>0,i>>>0)},e.wbg.__wbg_texParameteri_1f17358e51eb8069=function(t,e,n,r){h[t].texParameteri(e>>>0,n>>>0,r)},e.wbg.__wbg_uniform1f_7586c5e17ad254c9=function(t,e,n){h[t].uniform1f(h[e],n)},e.wbg.__wbg_uniform1i_9f94ef0ba6b3cc66=function(t,e,n){h[t].uniform1i(h[e],n)},e.wbg.__wbg_uniform4f_9aa5afa9177c6ab1=function(t,e,n,r,i,o){h[t].uniform4f(h[e],n,r,i,o)},e.wbg.__wbg_useProgram_019eb6df066fabf5=function(t,e){h[t].useProgram(h[e])},e.wbg.__wbg_vertexAttribPointer_ca11984ee8843c0a=function(t,e,n,r,i,o,u){h[t].vertexAttribPointer(e>>>0,n,r>>>0,0!==i,o,u)},e.wbg.__wbg_viewport_6ebef187c89e2616=function(t,e,n,r,i){h[t].viewport(e,n,r,i)},e.wbg.__wbg_data_ab99ae4a2e1e8bc9=function(t){let e=h[t].data;return A(e)},e.wbg.__wbg_width_0b4991f5cf7c640a=function(t){let e=h[t].width;return e},e.wbg.__wbg_setwidth_15266a5e81f43cf0=function(t,e){h[t].width=e>>>0},e.wbg.__wbg_height_8cce73e95fb10fd3=function(t){let e=h[t].height;return e},e.wbg.__wbg_setheight_2e9bab573f1775a6=function(t,e){h[t].height=e>>>0},e.wbg.__wbg_new_252cc736972fb8a2=function(){return O(function(t,e){let n=new OffscreenCanvas(t>>>0,e>>>0);return A(n)},arguments)},e.wbg.__wbg_getContext_762699b92f46f739=function(){return O(function(t,e,n){let r=h[t].getContext(k(e,n));return w(r)?0:A(r)},arguments)},e.wbg.__wbg_getContext_e54ab982f8dc14dd=function(){return O(function(t,e,n,r){let i=h[t].getContext(k(e,n),h[r]);return w(i)?0:A(i)},arguments)},e.wbg.__wbg_text_ae4c03a5032dca7d=function(t){let e=h[t].text();return A(e)},e.wbg.__wbg_drawBuffersWEBGL_139bf2fe0c1522d6=function(t,e){h[t].drawBuffersWEBGL(h[e])},e.wbg.__wbg_instanceof_HtmlCanvasElement_da5f9efa0688cf6d=function(t){let e;try{e=h[t]instanceof HTMLCanvasElement}catch(t){e=!1}let n=e;return n},e.wbg.__wbg_width_2931aaedd21f1fff=function(t){let e=h[t].width;return e},e.wbg.__wbg_setwidth_a667a942dba6656e=function(t,e){h[t].width=e>>>0},e.wbg.__wbg_height_0d36fbbeb60b0661=function(t){let e=h[t].height;return e},e.wbg.__wbg_setheight_a747d440760fe5aa=function(t,e){h[t].height=e>>>0},e.wbg.__wbg_getContext_6d1f155bb5c1096a=function(){return O(function(t,e,n,r){let i=h[t].getContext(k(e,n),h[r]);return w(i)?0:A(i)},arguments)},e.wbg.__wbg_setonmessage_f0bd0280573b7084=function(t,e){h[t].onmessage=h[e]},e.wbg.__wbg_new_8e7322f46d5d019c=function(){return O(function(t,e){let n=new Worker(k(t,e));return A(n)},arguments)},e.wbg.__wbg_postMessage_8c609e2bde333d9c=function(){return O(function(t,e){h[t].postMessage(h[e])},arguments)},e.wbg.__wbg_width_019b79813c2e80cf=function(t){let e=h[t].width;return e},e.wbg.__wbg_height_12082005add04bb5=function(t){let e=h[t].height;return e},e.wbg.__wbg_now_0cfdc90c97d0c24b=function(t){let e=h[t].now();return e},e.wbg.__wbg_debug_9a6b3243fbbebb61=function(t){console.debug(h[t])},e.wbg.__wbg_error_788ae33f81d3b84b=function(t){console.error(h[t])},e.wbg.__wbg_info_2e30e8204b29d91d=function(t){console.info(h[t])},e.wbg.__wbg_log_1d3ae0273d8f4f8a=function(t){console.log(h[t])},e.wbg.__wbg_warn_d60e832f9882c1b2=function(t){console.warn(h[t])},e.wbg.__wbg_instanceof_OffscreenCanvasRenderingContext2d_26d9a0cf7a8d139f=function(t){let e;try{e=h[t]instanceof OffscreenCanvasRenderingContext2D}catch(t){e=!1}let n=e;return n},e.wbg.__wbg_setimageSmoothingEnabled_156ba8be0f1b7ac6=function(t,e){h[t].imageSmoothingEnabled=0!==e},e.wbg.__wbg_drawImage_41e189afbc4dd90f=function(){return O(function(t,e,n,r,i,o,u,a,c,s){h[t].drawImage(h[e],n,r,i,o,u,a,c,s)},arguments)},e.wbg.__wbg_putImageData_ec70a0512c46f7c3=function(){return O(function(t,e,n,r){h[t].putImageData(h[e],n,r)},arguments)},e.wbg.__wbg_clearRect_35b88f4d1fbe24ee=function(t,e,n,r,i){h[t].clearRect(e,n,r,i)},e.wbg.__wbg_drawArraysInstancedANGLE_01b862ba133350a3=function(t,e,n,r,i){h[t].drawArraysInstancedANGLE(e>>>0,n,r,i)},e.wbg.__wbg_drawElementsInstancedANGLE_ea6343af8bf9c9f8=function(t,e,n,r,i,o){h[t].drawElementsInstancedANGLE(e>>>0,n,r>>>0,i,o)},e.wbg.__wbg_vertexAttribDivisorANGLE_a8476eb778e16c70=function(t,e,n){h[t].vertexAttribDivisorANGLE(e>>>0,n>>>0)},e.wbg.__wbg_instanceof_Response_fc4327dbfcdf5ced=function(t){let e;try{e=h[t]instanceof Response}catch(t){e=!1}let n=e;return n},e.wbg.__wbg_text_a667ac1770538491=function(){return O(function(t){let e=h[t].text();return A(e)},arguments)},e.wbg.__wbg_videoWidth_02eadb74917aa4fc=function(t){let e=h[t].videoWidth;return e},e.wbg.__wbg_videoHeight_dac4c345988e5562=function(t){let e=h[t].videoHeight;return e},e.wbg.__wbg_new_68d926df4499a81a=function(){return O(function(){let t=new Path2D;return A(t)},arguments)},e.wbg.__wbg_lineTo_6dae7afdea80cb55=function(t,e,n){h[t].lineTo(e,n)},e.wbg.__wbg_moveTo_f28fe5c750fc6dcd=function(t,e,n){h[t].moveTo(e,n)},e.wbg.__wbg_bindVertexArrayOES_b7d9da7e073aa6b5=function(t,e){h[t].bindVertexArrayOES(h[e])},e.wbg.__wbg_createVertexArrayOES_6a3c3a5a68201f8f=function(t){let e=h[t].createVertexArrayOES();return w(e)?0:A(e)},e.wbg.__wbg_deleteVertexArrayOES_7bf4589e63d84df6=function(t,e){h[t].deleteVertexArrayOES(h[e])},e.wbg.__wbg_framebufferTextureMultiviewOVR_4d911c3fccedc517=function(t,e,n,r,i,o,u){h[t].framebufferTextureMultiviewOVR(e>>>0,n>>>0,h[r],i,o,u)},e.wbg.__wbg_size_6eb4aa794f6bf220=function(t){let e=h[t].size;return e},e.wbg.__wbg_type_37bb6b4936b5e027=function(t){let e=h[t].type;return e},e.wbg.__wbg_name_ebae3a7e89367611=function(e,n){let r=h[n].name,i=I(r,t.__wbindgen_malloc,t.__wbindgen_realloc),o=T;y()[e/4+1]=o,y()[e/4+0]=i},e.wbg.__wbg_get_44be0491f933a435=function(t,e){let n=h[t][e>>>0];return A(n)},e.wbg.__wbg_length_fff51ee6522a1a18=function(t){let e=h[t].length;return e},e.wbg.__wbg_new_898a68150f225f2e=function(){return A([])},e.wbg.__wbg_newnoargs_581967eacc0e2604=function(t,e){let n=Function(k(t,e));return A(n)},e.wbg.__wbg_get_97b561fb56f034b5=function(){return O(function(t,e){let n=Reflect.get(h[t],h[e]);return A(n)},arguments)},e.wbg.__wbg_call_cb65541d95d71282=function(){return O(function(t,e){let n=h[t].call(h[e]);return A(n)},arguments)},e.wbg.__wbg_new_b51585de1b234aff=function(){return A({})},e.wbg.__wbg_self_1ff1d729e9aae938=function(){return O(function(){let t=self.self;return A(t)},arguments)},e.wbg.__wbg_window_5f4faef6c12b79ec=function(){return O(function(){let t=window.window;return A(t)},arguments)},e.wbg.__wbg_globalThis_1d39714405582d3c=function(){return O(function(){let t=globalThis.globalThis;return A(t)},arguments)},e.wbg.__wbg_global_651f05c6a0944d1c=function(){return O(function(){let t=f.global;return A(t)},arguments)},e.wbg.__wbg_of_053899a68de3ef48=function(t){let e=Array.of(h[t]);return A(e)},e.wbg.__wbg_of_3f69007bb4eeae65=function(t,e,n){let r=Array.of(h[t],h[e],h[n]);return A(r)},e.wbg.__wbg_push_ca1c26067ef907ac=function(t,e){let n=h[t].push(h[e]);return n},e.wbg.__wbg_apply_64be369596a02ae0=function(){return O(function(t,e,n){let r=h[t].apply(h[e],h[n]);return A(r)},arguments)},e.wbg.__wbg_call_01734de55d61e11d=function(){return O(function(t,e,n){let r=h[t].call(h[e],h[n]);return A(r)},arguments)},e.wbg.__wbg_call_4c92f6aec1e1d6e6=function(){return O(function(t,e,n,r){let i=h[t].call(h[e],h[n],h[r]);return A(i)},arguments)},e.wbg.__wbg_is_205d914af04a8faa=function(t,e){let n=Object.is(h[t],h[e]);return n},e.wbg.__wbg_new_43f1b47c28813cbd=function(e,n){try{var r={a:e,b:n};let i=new Promise((e,n)=>{let i=r.a;r.a=0;try{var o;return o=r.b,void t.wasm_bindgen__convert__closures__invoke2_mut__h259ce56af67f5970(i,o,A(e),A(n))}finally{r.a=i}});return A(i)}finally{r.a=r.b=0}},e.wbg.__wbg_resolve_53698b95aaf7fcf8=function(t){let e=Promise.resolve(h[t]);return A(e)},e.wbg.__wbg_then_f7e06ee3c11698eb=function(t,e){let n=h[t].then(h[e]);return A(n)},e.wbg.__wbg_then_b2267541e2a73865=function(t,e,n){let r=h[t].then(h[e],h[n]);return A(r)},e.wbg.__wbg_buffer_085ec1f694018c4f=function(t){let e=h[t].buffer;return A(e)},e.wbg.__wbg_newwithbyteoffsetandlength_828b952f0e692245=function(t,e,n){let r=new Int8Array(h[t],e>>>0,n>>>0);return A(r)},e.wbg.__wbg_newwithbyteoffsetandlength_735ed5ea2ae07fe9=function(t,e,n){let r=new Int16Array(h[t],e>>>0,n>>>0);return A(r)},e.wbg.__wbg_newwithbyteoffsetandlength_9f43b22ab631d1d6=function(t,e,n){let r=new Int32Array(h[t],e>>>0,n>>>0);return A(r)},e.wbg.__wbg_new_a0af68041688e8fd=function(t){let e=new Int32Array(h[t]);return A(e)},e.wbg.__wbg_newwithbyteoffsetandlength_6da8e527659b86aa=function(t,e,n){let r=new Uint8Array(h[t],e>>>0,n>>>0);return A(r)},e.wbg.__wbg_new_8125e318e6245eed=function(t){let e=new Uint8Array(h[t]);return A(e)},e.wbg.__wbg_set_5cf90238115182c3=function(t,e,n){h[t].set(h[e],n>>>0)},e.wbg.__wbg_newwithbyteoffsetandlength_31ff1024ef0c63c7=function(t,e,n){let r=new Uint16Array(h[t],e>>>0,n>>>0);return A(r)},e.wbg.__wbg_newwithbyteoffsetandlength_6df0e8c3efd2a5d3=function(t,e,n){let r=new Uint32Array(h[t],e>>>0,n>>>0);return A(r)},e.wbg.__wbg_newwithbyteoffsetandlength_69193e31c844b792=function(t,e,n){let r=new Float32Array(h[t],e>>>0,n>>>0);return A(r)},e.wbg.__wbg_newwithlength_e5d69174d6984cd7=function(t){let e=new Uint8Array(t>>>0);return A(e)},e.wbg.__wbg_subarray_13db269f57aa838d=function(t,e,n){let r=h[t].subarray(e>>>0,n>>>0);return A(r)},e.wbg.__wbg_set_092e06b0f9d71865=function(){return O(function(t,e,n){let r=Reflect.set(h[t],h[e],h[n]);return r},arguments)},e.wbg.__wbindgen_debug_string=function(e,n){let r=function t(e){let n;// primitive types
let r=typeof e;if("number"==r||"boolean"==r||null==e)return`${e}`;if("string"==r)return`"${e}"`;if("symbol"==r){let t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==r){let t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}// objects
if(Array.isArray(e)){let n=e.length,r="[";n>0&&(r+=t(e[0]));for(let i=1;i<n;i++)r+=", "+t(e[i]);return r+"]"}// Test for built-in
let i=/\[object ([^\]]+)\]/.exec(toString.call(e));if(!(i.length>1))return toString.call(e);if("Object"==(n=i[1]))// JSON.stringify avoids problems with cycles, and is generally much
// easier than looping through ownProperties of `val`.
try{return"Object("+JSON.stringify(e)+")"}catch(t){return"Object"}return(// errors
e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:n)}(h[n]),i=I(r,t.__wbindgen_malloc,t.__wbindgen_realloc),o=T;y()[e/4+1]=o,y()[e/4+0]=i},e.wbg.__wbindgen_throw=function(t,e){throw Error(k(t,e))},e.wbg.__wbindgen_rethrow=function(t){throw p(t)},e.wbg.__wbindgen_memory=function(){let e=t.memory;return A(e)},e.wbg.__wbindgen_closure_wrapper773=function(t,e,n){let r=D(t,e,140,M);return A(r)},e.wbg.__wbindgen_closure_wrapper775=function(t,e,n){let r=D(t,e,140,M);return A(r)},e}();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e)),r.wbg.memory=n||new WebAssembly.Memory({initial:22,maximum:16384,shared:!0});let{instance:i,module:o}=await ti(await e,r);return t=i.exports,tu.__wbindgen_wasm_module=o,z=null,m=null,v=null,B=null,S=null,t.__wbindgen_start(),t}to=b("eRNJD").getBundleURL("gnnWs")+"web_bg.0778c4ca.wasm";let ta=Math.min,tc=Math.max,ts=Math.round,tl=t=>({x:t,y:t});function tf(t){return t.split("-")[0]}function t_(t){return["top","bottom"].includes(tf(t))?"y":"x"}function td(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function tb(t,e,n){let r,{reference:i,floating:o}=t,u=t_(e),a="x"===t_(e)?"y":"x",c="y"===a?"height":"width",s=tf(e),l="y"===u,f=i.x+i.width/2-o.width/2,_=i.y+i.height/2-o.height/2,d=i[c]/2-o[c]/2;switch(s){case"top":r={x:f,y:i.y-o.height};break;case"bottom":r={x:f,y:i.y+i.height};break;case"right":r={x:i.x+i.width,y:_};break;case"left":r={x:i.x-o.width,y:_};break;default:r={x:i.x,y:i.y}}switch(e.split("-")[1]){case"start":r[a]-=d*(n&&l?-1:1);break;case"end":r[a]+=d*(n&&l?-1:1)}return r}/**
 * Computes the `x` and `y` coordinates that will place the floating element
 * next to a reference element when it is given a certain positioning strategy.
 *
 * This export does not have any `platform` interface logic. You will need to
 * write one for the platform you are using Floating UI with.
 */let th=async(t,e,n)=>{let{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:u}=n,a=o.filter(Boolean),c=await (null==u.isRTL?void 0:u.isRTL(e)),s=await u.getElementRects({reference:t,floating:e,strategy:i}),{x:l,y:f}=tb(s,r,c),_=r,d={},b=0;for(let n=0;n<a.length;n++){let{name:o,fn:h}=a[n],{x:g,y:p,data:w,reset:m}=await h({x:l,y:f,initialPlacement:r,placement:_,strategy:i,middlewareData:d,rects:s,platform:u,elements:{reference:t,floating:e}});if(l=null!=g?g:l,f=null!=p?p:f,d={...d,[o]:{...d[o],...w}},m&&b<=50){b++,"object"==typeof m&&(m.placement&&(_=m.placement),m.rects&&(s=!0===m.rects?await u.getElementRects({reference:t,floating:e,strategy:i}):m.rects),{x:l,y:f}=tb(s,_,c)),n=-1;continue}}return{x:l,y:f,placement:_,strategy:i,middlewareData:d}};function tg(t){return tm(t)?(t.nodeName||"").toLowerCase():"#document"}function tp(t){var e;return(null==t?void 0:null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function tw(t){var e;return null==(e=(tm(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function tm(t){return t instanceof Node||t instanceof tp(t).Node}function tv(t){return t instanceof Element||t instanceof tp(t).Element}function ty(t){return t instanceof HTMLElement||t instanceof tp(t).HTMLElement}function tx(t){return(// Browsers without `ShadowRoot` support.
"undefined"!=typeof ShadowRoot&&(t instanceof ShadowRoot||t instanceof tp(t).ShadowRoot))}function tS(t){let{overflow:e,overflowX:n,overflowY:r,display:i}=tT(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function tE(t){let e=tk(),n=tT(t);// https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block
return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some(t=>(n.willChange||"").includes(t))||["paint","layout","strict","content"].some(t=>(n.contain||"").includes(t))}function tk(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}function tA(t){return["html","body","#document"].includes(tg(t))}function tT(t){return tp(t).getComputedStyle(t)}function tP(t){return tv(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function tC(t){if("html"===tg(t))return t;let e=t.assignedSlot||// DOM Element detected.
t.parentNode||// ShadowRoot detected.
tx(t)&&t.host||// Fallback.
tw(t);return tx(e)?e.host:e}function tI(t){let e=tT(t),n=parseFloat(e.width)||0,r=parseFloat(e.height)||0,i=ty(t),o=i?t.offsetWidth:n,u=i?t.offsetHeight:r,a=ts(n)!==o||ts(r)!==u;return a&&(n=o,r=u),{width:n,height:r,$:a}}function tD(t){return tv(t)?t:t.contextElement}function tM(t){let e=tD(t);if(!ty(e))return tl(1);let n=e.getBoundingClientRect(),{width:r,height:i,$:o}=tI(e),u=(o?ts(n.width):n.width)/r,a=(o?ts(n.height):n.height)/i;return u&&Number.isFinite(u)||(u=1),a&&Number.isFinite(a)||(a=1),{x:u,y:a}}let tO=tl(0);function tz(t){let e=tp(t);return tk()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:tO}function tR(t,e,n,r){var i;void 0===e&&(e=!1),void 0===n&&(n=!1);let o=t.getBoundingClientRect(),u=tD(t),a=tl(1);e&&(r?tv(r)&&(a=tM(r)):a=tM(t));let c=(void 0===(i=n)&&(i=!1),r&&(!i||r===tp(u))&&i)?tz(u):tl(0),s=(o.left+c.x)/a.x,l=(o.top+c.y)/a.y,f=o.width/a.x,_=o.height/a.y;if(u){let t=tp(u),e=r&&tv(r)?tp(r):r,n=t.frameElement;for(;n&&r&&e!==t;){let t=tM(n),e=n.getBoundingClientRect(),r=tT(n),i=e.left+(n.clientLeft+parseFloat(r.paddingLeft))*t.x,o=e.top+(n.clientTop+parseFloat(r.paddingTop))*t.y;s*=t.x,l*=t.y,f*=t.x,_*=t.y,s+=i,l+=o,n=tp(n).frameElement}}return td({width:f,height:_,x:s,y:l})}function tL(t){// If <html> has a CSS width greater than the viewport, then this will be
// incorrect for RTL.
return tR(tw(t)).left+tP(t).scrollLeft}function tF(t,e,n){let r;if("viewport"===e)r=function(t,e){let n=tp(t),r=tw(t),i=n.visualViewport,o=r.clientWidth,u=r.clientHeight,a=0,c=0;if(i){o=i.width,u=i.height;let t=tk();(!t||t&&"fixed"===e)&&(a=i.offsetLeft,c=i.offsetTop)}return{width:o,height:u,x:a,y:c}}(t,n);else if("document"===e)r=// Gets the entire size of the scrollable document area, even extending outside
// of the `<html>` and `<body>` rect bounds if horizontally scrollable.
function(t){let e=tw(t),n=tP(t),r=t.ownerDocument.body,i=tc(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=tc(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight),u=-n.scrollLeft+tL(t),a=-n.scrollTop;return"rtl"===tT(r).direction&&(u+=tc(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:u,y:a}}(tw(t));else if(tv(e))r=// Returns the inner client rect, subtracting scrollbars if present.
function(t,e){let n=tR(t,!0,"fixed"===e),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=ty(t)?tM(t):tl(1),u=t.clientWidth*o.x,a=t.clientHeight*o.y,c=i*o.x,s=r*o.y;return{width:u,height:a,x:c,y:s}}(e,n);else{let n=tz(t);r={...e,x:e.x-n.x,y:e.y-n.y}}return td(r)}function tB(t,e){return ty(t)&&"fixed"!==tT(t).position?e?e(t):t.offsetParent:null}// Gets the closest ancestor positioned element. Handles some edge cases,
// such as table ancestors and cross browser bugs.
function tN(t,e){let n=tp(t);if(!ty(t))return n;let r=tB(t,e);for(;r&&["table","td","th"].includes(tg(r))&&"static"===tT(r).position;)r=tB(r,e);return r&&("html"===tg(r)||"body"===tg(r)&&"static"===tT(r).position&&!tE(r))?n:r||function(t){let e=tC(t);for(;ty(e)&&!tA(e);){if(tE(e))return e;e=tC(e)}return null}(t)||n}let tj=async function(t){let{reference:e,floating:n,strategy:r}=t,i=this.getOffsetParent||tN,o=this.getDimensions;return{reference:function(t,e,n){let r=ty(e),i=tw(e),o="fixed"===n,u=tR(t,!0,o,e),a={scrollLeft:0,scrollTop:0},c=tl(0);if(r||!r&&!o){if(("body"!==tg(e)||tS(i))&&(a=tP(e)),r){let t=tR(e,!0,o,e);c.x=t.x+e.clientLeft,c.y=t.y+e.clientTop}else i&&(c.x=tL(i))}return{x:u.left+a.scrollLeft-c.x,y:u.top+a.scrollTop-c.y,width:u.width,height:u.height}}(e,await i(n),r),floating:{x:0,y:0,...await o(n)}}},tq={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:n,strategy:r}=t,i=ty(n),o=tw(n);if(n===o)return e;let u={scrollLeft:0,scrollTop:0},a=tl(1),c=tl(0);if((i||!i&&"fixed"!==r)&&(("body"!==tg(n)||tS(o))&&(u=tP(n)),ty(n))){let t=tR(n);a=tM(n),c.x=t.x+n.clientLeft,c.y=t.y+n.clientTop}return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-u.scrollLeft*a.x+c.x,y:e.y*a.y-u.scrollTop*a.y+c.y}},getDocumentElement:tw,getClippingRect:// Gets the maximum area that the element is visible in due to any number of
// clipping ancestors.
function(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t,o="clippingAncestors"===n?// A "clipping ancestor" is an `overflow` element with the characteristic of
// clipping (or hiding) child elements. This returns all clipping ancestors
// of the given element up the tree.
function(t,e){let n=e.get(t);if(n)return n;let r=(function t(e,n,r){var i;void 0===n&&(n=[]),void 0===r&&(r=!0);let o=function t(e){let n=tC(e);return tA(n)?e.ownerDocument?e.ownerDocument.body:e.body:ty(n)&&tS(n)?n:t(n)}(e),u=o===(null==(i=e.ownerDocument)?void 0:i.body),a=tp(o);return u?n.concat(a,a.visualViewport||[],tS(o)?o:[],a.frameElement&&r?t(a.frameElement):[]):n.concat(o,t(o,[],r))})(t,[],!1).filter(t=>tv(t)&&"body"!==tg(t)),i=null,o="fixed"===tT(t).position,u=o?tC(t):t;// https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block
for(;tv(u)&&!tA(u);){let e=tT(u),n=tE(u);n||"fixed"!==e.position||(i=null);let a=o?!n&&!i:!n&&"static"===e.position&&!!i&&["absolute","fixed"].includes(i.position)||tS(u)&&!n&&function t(e,n){let r=tC(e);return!(r===n||!tv(r)||tA(r))&&("fixed"===tT(r).position||t(r,n))}(t,u);a?r=r.filter(t=>t!==u):i=e,u=tC(u)}return e.set(t,r),r}(e,this._c):[].concat(n),u=[...o,r],a=u[0],c=u.reduce((t,n)=>{let r=tF(e,n,i);return t.top=tc(r.top,t.top),t.right=ta(r.right,t.right),t.bottom=ta(r.bottom,t.bottom),t.left=tc(r.left,t.left),t},tF(e,a,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}},getOffsetParent:tN,getElementRects:tj,getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){return tI(t)},getScale:tM,isElement:tv,isRTL:function(t){return"rtl"===tT(t).direction}},tG=(t,e,n)=>{// This caches the expensive `getClippingElementAncestors` function so that
// multiple lifecycle resets re-use the same result. It only lives for a
// single call. If other functions become expensive, we can add them as well.
let r=new Map,i={platform:tq,...n},o={...i.platform,_c:r};return th(t,e,{...i,platform:o})};function tV(t,e){let n=document.getElementById("tooltip");tG({getBoundingClientRect:()=>({width:0,height:0,x:t,y:e,top:e,bottom:e,left:t,right:t})},n).then(({x:t,y:e})=>{Object.assign(n.style,{left:`${t}px`,top:`${e}px`})})}var tW={};o(tW,"proxyMarker",function(){return tU}),o(tW,"createEndpoint",function(){return tH}),o(tW,"releaseProxy",function(){return t$}),o(tW,"finalizer",function(){return tY}),o(tW,"expose",function(){return tZ}),o(tW,"wrap",function(){return t0}),o(tW,"transferHandlers",function(){return tJ}),o(tW,"proxy",function(){return t7}),o(tW,"transfer",function(){return t9}),o(tW,"windowEndpoint",function(){return t8});/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let tU=Symbol("Comlink.proxy"),tH=Symbol("Comlink.endpoint"),t$=Symbol("Comlink.releaseProxy"),tY=Symbol("Comlink.finalizer"),tX=Symbol("Comlink.thrown"),tQ=t=>"object"==typeof t&&null!==t||"function"==typeof t,tJ=new Map([["proxy",{canHandle:t=>tQ(t)&&t[tU],serialize(t){let{port1:e,port2:n}=new MessageChannel;return tZ(t,e),[n,[n]]},deserialize:t=>(t.start(),t0(t))}],["throw",{canHandle:t=>tQ(t)&&tX in t,serialize:({value:t})=>[t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[]],deserialize(t){if(t.isError)throw Object.assign(Error(t.value.message),t.value);throw t.value}}]]);function tZ(t,e=globalThis,n=["*"]){e.addEventListener("message",function r(i){let o;if(!i||!i.data)return;if(!function(t,e){for(let n of t)if(e===n||"*"===n||n instanceof RegExp&&n.test(e))return!0;return!1}(n,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}let{id:u,type:a,path:c}=Object.assign({path:[]},i.data),s=(i.data.argumentList||[]).map(ee);try{let e=c.slice(0,-1).reduce((t,e)=>t[e],t),n=c.reduce((t,e)=>t[e],t);switch(a){case"GET"/* MessageType.GET */:o=n;break;case"SET"/* MessageType.SET */:e[c.slice(-1)[0]]=ee(i.data.value),o=!0;break;case"APPLY"/* MessageType.APPLY */:o=n.apply(e,s);break;case"CONSTRUCT"/* MessageType.CONSTRUCT */:{let t=new n(...s);o=t7(t)}break;case"ENDPOINT"/* MessageType.ENDPOINT */:{let{port1:e,port2:n}=new MessageChannel;tZ(t,n),o=t9(e,[e])}break;case"RELEASE"/* MessageType.RELEASE */:o=void 0;break;default:return}}catch(t){o={value:t,[tX]:0}}Promise.resolve(o).catch(t=>({value:t,[tX]:0})).then(n=>{let[i,o]=et(n);e.postMessage(Object.assign(Object.assign({},i),{id:u}),o),"RELEASE"/* MessageType.RELEASE */===a&&(// detach and deactive after sending release response above.
e.removeEventListener("message",r),tK(e),tY in t&&"function"==typeof t[tY]&&t[tY]())}).catch(t=>{// Send Serialization Error To Caller
let[n,r]=et({value:TypeError("Unserializable return value"),[tX]:0});e.postMessage(Object.assign(Object.assign({},n),{id:u}),r)})}),e.start&&e.start()}function tK(t){"MessagePort"===t.constructor.name&&t.close()}function t0(t,e){return function t(e,n=[],r=function(){}){let i=!1,o=new Proxy(r,{get(r,u){if(t1(i),u===t$)return()=>{t6&&t6.unregister(o),t2(e),i=!0};if("then"===u){if(0===n.length)return{then:()=>o};let t=en(e,{type:"GET"/* MessageType.GET */,path:n.map(t=>t.toString())}).then(ee);return t.then.bind(t)}return t(e,[...n,u])},set(t,r,o){t1(i);// FIXME: ES6 Proxy Handler `set` methods are supposed to return a
// boolean. To show good will, we return true asynchronously \_()_/
let[u,a]=et(o);return en(e,{type:"SET"/* MessageType.SET */,path:[...n,r].map(t=>t.toString()),value:u},a).then(ee)},apply(r,o,u){t1(i);let a=n[n.length-1];if(a===tH)return en(e,{type:"ENDPOINT"/* MessageType.ENDPOINT */}).then(ee);// We just pretend that `bind()` didnt happen.
if("bind"===a)return t(e,n.slice(0,-1));let[c,s]=t3(u);return en(e,{type:"APPLY"/* MessageType.APPLY */,path:n.map(t=>t.toString()),argumentList:c},s).then(ee)},construct(t,r){t1(i);let[o,u]=t3(r);return en(e,{type:"CONSTRUCT"/* MessageType.CONSTRUCT */,path:n.map(t=>t.toString()),argumentList:o},u).then(ee)}});return!function(t,e){let n=(t4.get(e)||0)+1;t4.set(e,n),t6&&t6.register(t,e,t)}(o,e),o}(t,[],e)}function t1(t){if(t)throw Error("Proxy has been released and is not useable")}function t2(t){return en(t,{type:"RELEASE"/* MessageType.RELEASE */}).then(()=>{tK(t)})}let t4=new WeakMap,t6="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{let e=(t4.get(t)||0)-1;t4.set(t,e),0===e&&t2(t)});function t3(t){var e;let n=t.map(et);return[n.map(t=>t[0]),(e=n.map(t=>t[1]),Array.prototype.concat.apply([],e))]}let t5=new WeakMap;function t9(t,e){return t5.set(t,e),t}function t7(t){return Object.assign(t,{[tU]:!0})}function t8(t,e=globalThis,n="*"){return{postMessage:(e,r)=>t.postMessage(e,n,r),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e)}}function et(t){for(let[e,n]of tJ)if(n.canHandle(t)){let[r,i]=n.serialize(t);return[{type:"HANDLER"/* WireValueType.HANDLER */,name:e,value:r},i]}return[{type:"RAW"/* WireValueType.RAW */,value:t},t5.get(t)||[]]}function ee(t){switch(t.type){case"HANDLER"/* WireValueType.HANDLER */:return tJ.get(t.name).deserialize(t.value);case"RAW"/* WireValueType.RAW */:return t.value}}function en(t,e,n){return new Promise(r=>{let i=[,,,,].fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.addEventListener("message",function e(n){n.data&&n.data.id&&n.data.id===i&&(t.removeEventListener("message",e),r(n.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:i},e),n)})}var er={};o(er,"Observable",function(){return eN}),o(er,"ConnectableObservable",function(){return eH}),o(er,"observable",function(){return eR}),o(er,"animationFrames",function(){return eX}),o(er,"Subject",function(){return eK}),o(er,"BehaviorSubject",function(){return e1}),o(er,"ReplaySubject",function(){return e4}),o(er,"AsyncSubject",function(){return e6}),o(er,"asap",function(){return ns}),o(er,"asapScheduler",function(){return nc}),o(er,"async",function(){return nf}),o(er,"asyncScheduler",function(){return nl}),o(er,"queue",function(){return nb}),o(er,"queueScheduler",function(){return nd}),o(er,"animationFrame",function(){return np}),o(er,"animationFrameScheduler",function(){return ng}),o(er,"VirtualTimeScheduler",function(){return nw}),o(er,"VirtualAction",function(){return nm}),o(er,"Scheduler",function(){return nu}),o(er,"Subscription",function(){return eh}),o(er,"Subscriber",function(){return eT}),o(er,"Notification",function(){return nH}),o(er,"NotificationKind",function(){return l}),o(er,"pipe",function(){return eF}),o(er,"noop",function(){return ex}),o(er,"identity",function(){return eL}),o(er,"isObservable",function(){return nY}),o(er,"lastValueFrom",function(){return nQ}),o(er,"firstValueFrom",function(){return nJ}),o(er,"ArgumentOutOfRangeError",function(){return nZ}),o(er,"EmptyError",function(){return nX}),o(er,"NotFoundError",function(){return nK}),o(er,"ObjectUnsubscribedError",function(){return eZ}),o(er,"SequenceError",function(){return n0}),o(er,"TimeoutError",function(){return n2}),o(er,"UnsubscriptionError",function(){return ed}),o(er,"bindCallback",function(){return n8}),o(er,"bindNodeCallback",function(){return rt}),o(er,"combineLatest",function(){return ra}),o(er,"concat",function(){return rd}),o(er,"connectable",function(){return rg}),o(er,"defer",function(){return rb}),o(er,"empty",function(){return ny}),o(er,"forkJoin",function(){return rp}),o(er,"from",function(){return nV}),o(er,"fromEvent",function(){return ry}),o(er,"fromEventPattern",function(){return function t(e,n,r){return r?t(e,n).pipe(n9(r)):new eN(function(t){var r=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.next(1===e.length?e[0]:e)},i=e(r);return ef(n)?function(){return n(r,i)}:void 0})}}),o(er,"generate",function(){return rS}),o(er,"iif",function(){return rE}),o(er,"interval",function(){return rA}),o(er,"merge",function(){return rT}),o(er,"never",function(){return rC}),o(er,"of",function(){return nW}),o(er,"onErrorResumeNext",function(){return rM}),o(er,"pairs",function(){return rO}),o(er,"partition",function(){return rR}),o(er,"race",function(){return rL}),o(er,"range",function(){return rB}),o(er,"throwError",function(){return nU}),o(er,"timer",function(){return rk}),o(er,"using",function(){return rN}),o(er,"zip",function(){return rj}),o(er,"scheduled",function(){return nG}),o(er,"EMPTY",function(){return nv}),o(er,"NEVER",function(){return rP}),o(er,"config",function(){return em}),o(er,"audit",function(){return rq}),o(er,"auditTime",function(){return rG}),o(er,"buffer",function(){return rV}),o(er,"bufferCount",function(){return rW}),o(er,"bufferTime",function(){return rU}),o(er,"bufferToggle",function(){return rH}),o(er,"bufferWhen",function(){return r$}),o(er,"catchError",function(){return function t(e){return eG(function(n,r){var i,o=null,u=!1;o=n.subscribe(eV(r,void 0,void 0,function(a){i=nR(e(a,t(e)(n))),o?(o.unsubscribe(),o=null,i.subscribe(r)):u=!0})),u&&(o.unsubscribe(),o=null,i.subscribe(r))})}}),o(er,"combineAll",function(){return r0}),o(er,"combineLatestAll",function(){return rK}),o(er,"combineLatestWith",function(){return r2}),o(er,"concatAll",function(){return r_}),o(er,"concatMap",function(){return r4}),o(er,"concatMapTo",function(){return r6}),o(er,"concatWith",function(){return r5}),o(er,"connect",function(){return r7}),o(er,"count",function(){return r8}),o(er,"debounce",function(){return it}),o(er,"debounceTime",function(){return ie}),o(er,"defaultIfEmpty",function(){return ir}),o(er,"delay",function(){return ic}),o(er,"delayWhen",function(){return ia}),o(er,"dematerialize",function(){return is}),o(er,"distinct",function(){return il}),o(er,"distinctUntilChanged",function(){return i_}),o(er,"distinctUntilKeyChanged",function(){return ib}),o(er,"elementAt",function(){return ip}),o(er,"endWith",function(){return iw}),o(er,"every",function(){return im}),o(er,"exhaust",function(){return ix}),o(er,"exhaustAll",function(){return iy}),o(er,"exhaustMap",function(){return iv}),o(er,"expand",function(){return iS}),o(er,"filter",function(){return rz}),o(er,"finalize",function(){return iE}),o(er,"find",function(){return ik}),o(er,"findIndex",function(){return iT}),o(er,"first",function(){return iP}),o(er,"groupBy",function(){return iC}),o(er,"ignoreElements",function(){return io}),o(er,"isEmpty",function(){return iI}),o(er,"last",function(){return iM}),o(er,"map",function(){return n3}),o(er,"mapTo",function(){return iu}),o(er,"materialize",function(){return iO}),o(er,"max",function(){return iz}),o(er,"mergeAll",function(){return rf}),o(er,"flatMap",function(){return iR}),o(er,"mergeMap",function(){return rl}),o(er,"mergeMapTo",function(){return iL}),o(er,"mergeScan",function(){return iF}),o(er,"mergeWith",function(){return iN}),o(er,"min",function(){return ij}),o(er,"multicast",function(){return iq}),o(er,"observeOn",function(){return nB}),o(er,"onErrorResumeNextWith",function(){return iG}),o(er,"pairwise",function(){return iV}),o(er,"pluck",function(){return iW}),o(er,"publish",function(){return iU}),o(er,"publishBehavior",function(){return iH}),o(er,"publishLast",function(){return i$}),o(er,"publishReplay",function(){return iY}),o(er,"raceWith",function(){return iX}),o(er,"reduce",function(){return rX}),o(er,"repeat",function(){return iQ}),o(er,"repeatWhen",function(){return iJ}),o(er,"retry",function(){return iZ}),o(er,"retryWhen",function(){return iK}),o(er,"refCount",function(){return eU}),o(er,"sample",function(){return i0}),o(er,"sampleTime",function(){return i1}),o(er,"scan",function(){return i2}),o(er,"sequenceEqual",function(){return i4}),o(er,"share",function(){return i3}),o(er,"shareReplay",function(){return i9}),o(er,"single",function(){return i7}),o(er,"skip",function(){return i8}),o(er,"skipLast",function(){return ot}),o(er,"skipUntil",function(){return oe}),o(er,"skipWhile",function(){return on}),o(er,"startWith",function(){return or}),o(er,"subscribeOn",function(){return nN}),o(er,"switchAll",function(){return oo}),o(er,"switchMap",function(){return oi}),o(er,"switchMapTo",function(){return ou}),o(er,"switchScan",function(){return oa}),o(er,"take",function(){return ii}),o(er,"takeLast",function(){return iD}),o(er,"takeUntil",function(){return oc}),o(er,"takeWhile",function(){return os}),o(er,"tap",function(){return ol}),o(er,"throttle",function(){return of}),o(er,"throttleTime",function(){return o_}),o(er,"throwIfEmpty",function(){return ih}),o(er,"timeInterval",function(){return od}),o(er,"timeout",function(){return n4}),o(er,"timeoutWith",function(){return oh}),o(er,"timestamp",function(){return og}),o(er,"toArray",function(){return rJ}),o(er,"window",function(){return op}),o(er,"windowCount",function(){return ow}),o(er,"windowTime",function(){return om}),o(er,"windowToggle",function(){return ov}),o(er,"windowWhen",function(){return oy}),o(er,"withLatestFrom",function(){return ox}),o(er,"zipAll",function(){return oS}),o(er,"zipWith",function(){return ok});/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** *//* global Reflect, Promise, SuppressedError, Symbol */var ei=function(t,e){return(ei=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function eo(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}ei(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function eu(t,e){var n,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(u=0)),u;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return u.label++,{value:a[1],done:!1};case 5:u.label++,r=a[1],a=[0];continue;case 7:a=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){u=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){u.label=a[1];break}if(6===a[0]&&u.label<i[1]){u.label=i[1],i=a;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(a);break}i[2]&&u.ops.pop(),u.trys.pop();continue}a=e.call(t,u)}catch(t){a=[6,t],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function ea(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ec(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)u.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return u}function es(t,e,n){if(n||2==arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function el(t){return this instanceof el?(this.v=t,this):new el(t)}function ef(t){return"function"==typeof t}function e_(t){var e=t(function(t){Error.call(t),t.stack=Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}"function"==typeof SuppressedError&&SuppressedError;var ed=e_(function(t){return function(e){t(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}});function eb(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var eh=function(){var t;function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t,e,n,r,i,o=this._parentage;if(o){if(this._parentage=null,Array.isArray(o))try{for(var u=ea(o),a=u.next();!a.done;a=u.next())a.value.remove(this)}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}else o.remove(this)}var c=this.initialTeardown;if(ef(c))try{c()}catch(t){i=t instanceof ed?t.errors:[t]}var s=this._finalizers;if(s){this._finalizers=null;try{for(var l=ea(s),f=l.next();!f.done;f=l.next()){var _=f.value;try{ew(_)}catch(t){i=null!=i?i:[],t instanceof ed?i=es(es([],ec(i)),ec(t.errors)):i.push(t)}}}catch(t){n={error:t}}finally{try{f&&!f.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}if(i)throw new ed(i)}},e.prototype.add=function(t){var n;if(t&&t!==this){if(this.closed)ew(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}}},e.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},e.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},e.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&eb(e,t)},e.prototype.remove=function(t){var n=this._finalizers;n&&eb(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),eg=eh.EMPTY;function ep(t){return t instanceof eh||t&&"closed"in t&&ef(t.remove)&&ef(t.add)&&ef(t.unsubscribe)}function ew(t){ef(t)?t():t.unsubscribe()}var em={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ev={setTimeout:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=ev.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,es([t,e],ec(n))):setTimeout.apply(void 0,es([t,e],ec(n)))},clearTimeout:function(t){var e=ev.delegate;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function ey(t){ev.setTimeout(function(){var e=em.onUnhandledError;if(e)e(t);else throw t})}function ex(){}var eS=eE("C",void 0,void 0);function eE(t,e,n){return{kind:t,value:e,error:n}}var ek=null;function eA(t){if(em.useDeprecatedSynchronousErrorHandling){var e=!ek;if(e&&(ek={errorThrown:!1,error:null}),t(),e){var n=ek,r=n.errorThrown,i=n.error;if(ek=null,r)throw i}}else t()}var eT=function(t){function e(e){var n=t.call(this)||this;return n.isStopped=!1,e?(n.destination=e,ep(e)&&e.add(n)):n.destination=ez,n}return eo(e,t),e.create=function(t,e,n){return new eD(t,e,n)},e.prototype.next=function(t){this.isStopped?eO(eE("N",t,void 0),this):this._next(t)},e.prototype.error=function(t){this.isStopped?eO(eE("E",void 0,t),this):(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped?eO(eS,this):(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(eh),eP=Function.prototype.bind;function eC(t,e){return eP.call(t,e)}var eI=function(){function t(t){this.partialObserver=t}return t.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(t){eM(t)}},t.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(t){eM(t)}else eM(t)},t.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(t){eM(t)}},t}(),eD=function(t){function e(e,n,r){var i,o,u=t.call(this)||this;return ef(e)||!e?i={next:null!=e?e:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:u&&em.useDeprecatedNextContext?((o=Object.create(e)).unsubscribe=function(){return u.unsubscribe()},i={next:e.next&&eC(e.next,o),error:e.error&&eC(e.error,o),complete:e.complete&&eC(e.complete,o)}):i=e,u.destination=new eI(i),u}return eo(e,t),e}(eT);function eM(t){em.useDeprecatedSynchronousErrorHandling?em.useDeprecatedSynchronousErrorHandling&&ek&&(ek.errorThrown=!0,ek.error=t):ey(t)}function eO(t,e){var n=em.onStoppedNotification;n&&ev.setTimeout(function(){return n(t,e)})}var ez={closed:!0,next:ex,error:function(t){throw t},complete:ex},eR="function"==typeof Symbol&&Symbol.observable||"@@observable";function eL(t){return t}function eF(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return eB(t)}function eB(t){return 0===t.length?eL:1===t.length?t[0]:function(e){return t.reduce(function(t,e){return e(t)},e)}}var eN=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r,i=this,o=(r=t)&&r instanceof eT||r&&ef(r.next)&&ef(r.error)&&ef(r.complete)&&ep(r)?t:new eD(t,e,n);return eA(function(){var t=i.operator,e=i.source;o.add(t?t.call(o,e):e?i._subscribe(o):i._trySubscribe(o))}),o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=ej(e))(function(e,r){var i=new eD({next:function(e){try{t(e)}catch(t){r(t),i.unsubscribe()}},error:r,complete:e});n.subscribe(i)})},t.prototype._subscribe=function(t){var e;return null===(e=this.source)||void 0===e?void 0:e.subscribe(t)},t.prototype[eR]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return eB(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=ej(t))(function(t,n){var r;e.subscribe(function(t){return r=t},function(t){return n(t)},function(){return t(r)})})},t.create=function(e){return new t(e)},t}();function ej(t){var e;return null!==(e=null!=t?t:em.Promise)&&void 0!==e?e:Promise}function eq(t){return ef(null==t?void 0:t.lift)}function eG(t){return function(e){if(eq(e))return e.lift(function(e){try{return t(e,this)}catch(t){this.error(t)}});throw TypeError("Unable to lift unknown Observable type")}}function eV(t,e,n,r,i){return new eW(t,e,n,r,i)}var eW=function(t){function e(e,n,r,i,o,u){var a=t.call(this,e)||this;return a.onFinalize=o,a.shouldUnsubscribe=u,a._next=n?function(t){try{n(t)}catch(t){e.error(t)}}:t.prototype._next,a._error=i?function(t){try{i(t)}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._error,a._complete=r?function(){try{r()}catch(t){e.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,a}return eo(e,t),e.prototype.unsubscribe=function(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),n||null===(e=this.onFinalize)||void 0===e||e.call(this)}},e}(eT);function eU(){return eG(function(t,e){var n=null;t._refCount++;var r=eV(e,void 0,void 0,void 0,function(){if(!t||t._refCount<=0||0<--t._refCount){n=null;return}var r=t._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var eH=function(t){function e(e,n){var r=t.call(this)||this;return r.source=e,r.subjectFactory=n,r._subject=null,r._refCount=0,r._connection=null,eq(e)&&(r.lift=e.lift),r}return eo(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject},e.prototype._teardown=function(){this._refCount=0;var t=this._connection;this._subject=this._connection=null,null==t||t.unsubscribe()},e.prototype.connect=function(){var t=this,e=this._connection;if(!e){e=this._connection=new eh;var n=this.getSubject();e.add(this.source.subscribe(eV(n,void 0,function(){t._teardown(),n.complete()},function(e){t._teardown(),n.error(e)},function(){return t._teardown()}))),e.closed&&(this._connection=null,e=eh.EMPTY)}return e},e.prototype.refCount=function(){return eU()(this)},e}(eN),e$={now:function(){return(e$.delegate||performance).now()},delegate:void 0},eY={schedule:function(t){var e=requestAnimationFrame,n=cancelAnimationFrame,r=eY.delegate;r&&(e=r.requestAnimationFrame,n=r.cancelAnimationFrame);var i=e(function(e){n=void 0,t(e)});return new eh(function(){return null==n?void 0:n(i)})},requestAnimationFrame:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=eY.delegate;return((null==n?void 0:n.requestAnimationFrame)||requestAnimationFrame).apply(void 0,es([],ec(t)))},cancelAnimationFrame:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=eY.delegate;return((null==n?void 0:n.cancelAnimationFrame)||cancelAnimationFrame).apply(void 0,es([],ec(t)))},delegate:void 0};function eX(t){return t?eQ(t):eJ}function eQ(t){return new eN(function(e){var n=t||e$,r=n.now(),i=0,o=function(){e.closed||(i=eY.requestAnimationFrame(function(u){i=0;var a=n.now();e.next({timestamp:t?a:u,elapsed:a-r}),o()}))};return o(),function(){i&&eY.cancelAnimationFrame(i)}})}var eJ=eQ(),eZ=e_(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),eK=function(t){function e(){var e=t.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return eo(e,t),e.prototype.lift=function(t){var e=new e0(this,this);return e.operator=t,e},e.prototype._throwIfClosed=function(){if(this.closed)throw new eZ},e.prototype.next=function(t){var e=this;eA(function(){var n,r;if(e._throwIfClosed(),!e.isStopped){e.currentObservers||(e.currentObservers=Array.from(e.observers));try{for(var i=ea(e.currentObservers),o=i.next();!o.done;o=i.next())o.value.next(t)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}})},e.prototype.error=function(t){var e=this;eA(function(){if(e._throwIfClosed(),!e.isStopped){e.hasError=e.isStopped=!0,e.thrownError=t;for(var n=e.observers;n.length;)n.shift().error(t)}})},e.prototype.complete=function(){var t=this;eA(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var e=t.observers;e.length;)e.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(e){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var e=this,n=this.hasError,r=this.isStopped,i=this.observers;return n||r?eg:(this.currentObservers=null,i.push(t),new eh(function(){e.currentObservers=null,eb(i,t)}))},e.prototype._checkFinalizedStatuses=function(t){var e=this.hasError,n=this.thrownError,r=this.isStopped;e?t.error(n):r&&t.complete()},e.prototype.asObservable=function(){var t=new eN;return t.source=this,t},e.create=function(t,e){return new e0(t,e)},e}(eN),e0=function(t){function e(e,n){var r=t.call(this)||this;return r.destination=e,r.source=n,r}return eo(e,t),e.prototype.next=function(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===n||n.call(e,t)},e.prototype.error=function(t){var e,n;null===(n=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===n||n.call(e,t)},e.prototype.complete=function(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)},e.prototype._subscribe=function(t){var e,n;return null!==(n=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==n?n:eg},e}(eK),e1=function(t){function e(e){var n=t.call(this)||this;return n._value=e,n}return eo(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n.closed||e.next(this._value),n},e.prototype.getValue=function(){var t=this.hasError,e=this.thrownError,n=this._value;if(t)throw e;return this._throwIfClosed(),n},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(eK),e2={now:function(){return(e2.delegate||Date).now()},delegate:void 0},e4=function(t){function e(e,n,r){void 0===e&&(e=1/0),void 0===n&&(n=1/0),void 0===r&&(r=e2);var i=t.call(this)||this;return i._bufferSize=e,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,e),i._windowTime=Math.max(1,n),i}return eo(e,t),e.prototype.next=function(e){var n=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,o=this._timestampProvider,u=this._windowTime;!n&&(r.push(e),i||r.push(o.now()+u)),this._trimBuffer(),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var e=this._innerSubscribe(t),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!t.closed;i+=n?1:2)t.next(r[i]);return this._checkFinalizedStatuses(t),e},e.prototype._trimBuffer=function(){var t=this._bufferSize,e=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*t;if(t<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var o=e.now(),u=0,a=1;a<n.length&&n[a]<=o;a+=2)u=a;u&&n.splice(0,u+1)}},e}(eK),e6=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._value=null,e._hasValue=!1,e._isComplete=!1,e}return eo(e,t),e.prototype._checkFinalizedStatuses=function(t){var e=this.hasError,n=this._hasValue,r=this._value,i=this.thrownError,o=this.isStopped,u=this._isComplete;e?t.error(i):(o||u)&&(n&&t.next(r),t.complete())},e.prototype.next=function(t){this.isStopped||(this._value=t,this._hasValue=!0)},e.prototype.complete=function(){var e=this._hasValue,n=this._value;this._isComplete||(this._isComplete=!0,e&&t.prototype.next.call(this,n),t.prototype.complete.call(this))},e}(eK),e3=function(t){function e(e,n){return t.call(this)||this}return eo(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(eh),e5={setInterval:function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=e5.delegate;return(null==i?void 0:i.setInterval)?i.setInterval.apply(i,es([t,e],ec(n))):setInterval.apply(void 0,es([t,e],ec(n)))},clearInterval:function(t){var e=e5.delegate;return((null==e?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},e9=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.pending=!1,r}return eo(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n,r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,e)),this.pending=!0,this.delay=e,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),e5.setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return e;null!=e&&e5.clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n,r=!1;try{this.work(t)}catch(t){r=!0,n=t||Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},e.prototype.unsubscribe=function(){if(!this.closed){var e=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,eb(r,this),null!=e&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(e3),e7=1,e8={};function nt(t){return t in e8&&(delete e8[t],!0)}var ne={setImmediate:function(t){var e=e7++;return e8[e]=!0,s||(s=Promise.resolve()),s.then(function(){return nt(e)&&t()}),e},clearImmediate:function(t){nt(t)}},nn=ne.setImmediate,nr=ne.clearImmediate,ni={setImmediate:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=ni.delegate;return((null==n?void 0:n.setImmediate)||nn).apply(void 0,es([],ec(t)))},clearImmediate:function(t){var e=ni.delegate;return((null==e?void 0:e.clearImmediate)||nr)(t)},delegate:void 0},no=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return eo(e,t),e.prototype.requestAsyncId=function(e,n,r){return(void 0===r&&(r=0),null!==r&&r>0)?t.prototype.requestAsyncId.call(this,e,n,r):(e.actions.push(this),e._scheduled||(e._scheduled=ni.setImmediate(e.flush.bind(e,void 0))))},e.prototype.recycleAsyncId=function(e,n,r){if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,r);var i,o=e.actions;null!=n&&(null===(i=o[o.length-1])||void 0===i?void 0:i.id)!==n&&(ni.clearImmediate(n),e._scheduled===n&&(e._scheduled=void 0))},e}(e9),nu=function(){function t(e,n){void 0===n&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.schedulerActionCtor(this,t).schedule(n,e)},t.now=e2.now,t}(),na=function(t){function e(e,n){void 0===n&&(n=nu.now);var r=t.call(this,e,n)||this;return r.actions=[],r._active=!1,r}return eo(e,t),e.prototype.flush=function(t){var e,n=this.actions;if(this._active){n.push(t);return}this._active=!0;do if(e=t.execute(t.state,t.delay))break;while(t=n.shift())if(this._active=!1,e){for(;t=n.shift();)t.unsubscribe();throw e}},e}(nu),nc=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return eo(e,t),e.prototype.flush=function(t){this._active=!0;var e,n=this._scheduled;this._scheduled=void 0;var r=this.actions;t=t||r.shift();do if(e=t.execute(t.state,t.delay))break;while((t=r[0])&&t.id===n&&r.shift())if(this._active=!1,e){for(;(t=r[0])&&t.id===n&&r.shift();)t.unsubscribe();throw e}},e}(na))(no),ns=nc,nl=new na(e9),nf=nl,n_=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return eo(e,t),e.prototype.schedule=function(e,n){return(void 0===n&&(n=0),n>0)?t.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,n){return n>0||this.closed?t.prototype.execute.call(this,e,n):this._execute(e,n)},e.prototype.requestAsyncId=function(e,n,r){return(void 0===r&&(r=0),null!=r&&r>0||null==r&&this.delay>0)?t.prototype.requestAsyncId.call(this,e,n,r):(e.flush(this),0)},e}(e9),nd=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return eo(e,t),e}(na))(n_),nb=nd,nh=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return eo(e,t),e.prototype.requestAsyncId=function(e,n,r){return(void 0===r&&(r=0),null!==r&&r>0)?t.prototype.requestAsyncId.call(this,e,n,r):(e.actions.push(this),e._scheduled||(e._scheduled=eY.requestAnimationFrame(function(){return e.flush(void 0)})))},e.prototype.recycleAsyncId=function(e,n,r){if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,r);var i,o=e.actions;null!=n&&(null===(i=o[o.length-1])||void 0===i?void 0:i.id)!==n&&(eY.cancelAnimationFrame(n),e._scheduled=void 0)},e}(e9),ng=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return eo(e,t),e.prototype.flush=function(t){this._active=!0;var e,n=this._scheduled;this._scheduled=void 0;var r=this.actions;t=t||r.shift();do if(e=t.execute(t.state,t.delay))break;while((t=r[0])&&t.id===n&&r.shift())if(this._active=!1,e){for(;(t=r[0])&&t.id===n&&r.shift();)t.unsubscribe();throw e}},e}(na))(nh),np=ng,nw=function(t){function e(e,n){void 0===e&&(e=nm),void 0===n&&(n=1/0);var r=t.call(this,e,function(){return r.frame})||this;return r.maxFrames=n,r.frame=0,r.index=-1,r}return eo(e,t),e.prototype.flush=function(){for(var t,e,n=this.actions,r=this.maxFrames;(e=n[0])&&e.delay<=r&&(n.shift(),this.frame=e.delay,!(t=e.execute(e.state,e.delay))););if(t){for(;e=n.shift();)e.unsubscribe();throw t}},e.frameTimeFactor=10,e}(na),nm=function(t){function e(e,n,r){void 0===r&&(r=e.index+=1);var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i.index=r,i.active=!0,i.index=e.index=r,i}return eo(e,t),e.prototype.schedule=function(n,r){if(void 0===r&&(r=0),!Number.isFinite(r))return eh.EMPTY;if(!this.id)return t.prototype.schedule.call(this,n,r);this.active=!1;var i=new e(this.scheduler,this.work);return this.add(i),i.schedule(n,r)},e.prototype.requestAsyncId=function(t,n,r){void 0===r&&(r=0),this.delay=t.frame+r;var i=t.actions;return i.push(this),i.sort(e.sortActions),1},e.prototype.recycleAsyncId=function(t,e,n){void 0===n&&(n=0)},e.prototype._execute=function(e,n){if(!0===this.active)return t.prototype._execute.call(this,e,n)},e.sortActions=function(t,e){return t.delay===e.delay?t.index===e.index?0:t.index>e.index?1:-1:t.delay>e.delay?1:-1},e}(e9),nv=new eN(function(t){return t.complete()});function ny(t){return t?new eN(function(e){return t.schedule(function(){return e.complete()})}):nv}function nx(t){return t&&ef(t.schedule)}function nS(t){return t[t.length-1]}function nE(t){return ef(nS(t))?t.pop():void 0}function nk(t){return nx(nS(t))?t.pop():void 0}function nA(t,e){return"number"==typeof nS(t)?t.pop():e}var nT=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function nP(t){return ef(null==t?void 0:t.then)}function nC(t){return Symbol.asyncIterator&&ef(null==t?void 0:t[Symbol.asyncIterator])}function nI(t){return TypeError("You provided "+(null!==t&&"object"==typeof t?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var nD="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function nM(t){return ef(null==t?void 0:t[nD])}function nO(t){return function(t,e,n){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},u("next"),u("throw"),u("return"),r[Symbol.asyncIterator]=function(){return this},r;function u(t){i[t]&&(r[t]=function(e){return new Promise(function(n,r){o.push([t,e,n,r])>1||a(t,e)})})}function a(t,e){try{var n;(n=i[t](e)).value instanceof el?Promise.resolve(n.value.v).then(c,s):l(o[0][2],n)}catch(t){l(o[0][3],t)}}function c(t){a("next",t)}function s(t){a("throw",t)}function l(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}(this,arguments,function(){var e,n,r;return eu(this,function(i){switch(i.label){case 0:e=t.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,el(e.read())];case 3:if(r=(n=i.sent()).value,!n.done)return[3,5];return[4,el(void 0)];case 4:return[2,i.sent()];case 5:return[4,el(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function nz(t){return ef(null==t?void 0:t.getReader)}function nR(t){if(t instanceof eN)return t;if(null!=t){if(ef(t[eR]))return new eN(function(e){var n=t[eR]();if(ef(n.subscribe))return n.subscribe(e);throw TypeError("Provided object does not correctly implement Symbol.observable")});if(nT(t))return new eN(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()});if(nP(t))return new eN(function(e){t.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,ey)});if(nC(t))return nL(t);if(nM(t))return new eN(function(e){var n,r;try{for(var i=ea(t),o=i.next();!o.done;o=i.next()){var u=o.value;if(e.next(u),e.closed)return}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()});if(nz(t))return nL(nO(t))}throw nI(t)}function nL(t){return new eN(function(e){(function(t,e){var n,r,i,o,u,a,c,s;return u=this,a=void 0,c=void 0,s=function(){var u;return eu(this,function(a){switch(a.label){case 0:a.trys.push([0,5,6,11]),n=function(t){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=ea(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise(function(r,i){(function(t,e,n,r){Promise.resolve(r).then(function(e){t({value:e,done:n})},e)})(r,i,(e=t[n](e)).done,e.value)})}}}(t),a.label=1;case 1:return[4,n.next()];case 2:if((r=a.sent()).done)return[3,4];if(u=r.value,e.next(u),e.closed)return[2];a.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return i={error:a.sent()},[3,11];case 6:if(a.trys.push([6,,9,10]),!(r&&!r.done&&(o=n.return)))return[3,8];return[4,o.call(n)];case 7:a.sent(),a.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})},new(c||(c=Promise))(function(t,e){function n(t){try{i(s.next(t))}catch(t){e(t)}}function r(t){try{i(s.throw(t))}catch(t){e(t)}}function i(e){var i;e.done?t(e.value):((i=e.value)instanceof c?i:new c(function(t){t(i)})).then(n,r)}i((s=s.apply(u,a||[])).next())})})(t,e).catch(function(t){return e.error(t)})})}function nF(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function nB(t,e){return void 0===e&&(e=0),eG(function(n,r){n.subscribe(eV(r,function(n){return nF(r,t,function(){return r.next(n)},e)},function(){return nF(r,t,function(){return r.complete()},e)},function(n){return nF(r,t,function(){return r.error(n)},e)}))})}function nN(t,e){return void 0===e&&(e=0),eG(function(n,r){r.add(t.schedule(function(){return n.subscribe(r)},e))})}function nj(t,e){return new eN(function(n){var r;return nF(n,e,function(){r=t[nD](),nF(n,e,function(){var t,e,i;try{e=(t=r.next()).value,i=t.done}catch(t){n.error(t);return}i?n.complete():n.next(e)},0,!0)}),function(){return ef(null==r?void 0:r.return)&&r.return()}})}function nq(t,e){if(!t)throw Error("Iterable cannot be null");return new eN(function(n){nF(n,e,function(){var r=t[Symbol.asyncIterator]();nF(n,e,function(){r.next().then(function(t){t.done?n.complete():n.next(t.value)})},0,!0)})})}function nG(t,e){if(null!=t){if(ef(t[eR]))return nR(t).pipe(nN(e),nB(e));if(nT(t))return new eN(function(n){var r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})});if(nP(t))return nR(t).pipe(nN(e),nB(e));if(nC(t))return nq(t,e);if(nM(t))return nj(t,e);if(nz(t))return nq(nO(t),e)}throw nI(t)}function nV(t,e){return e?nG(t,e):nR(t)}function nW(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=nk(t);return nV(t,n)}function nU(t,e){var n=ef(t)?t:function(){return t},r=function(t){return t.error(n())};return new eN(e?function(t){return e.schedule(r,0,t)}:r)}(u=l||(l={})).NEXT="N",u.ERROR="E",u.COMPLETE="C";var nH=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){return n$(this,t)},t.prototype.do=function(t,e,n){var r=this.kind,i=this.value,o=this.error;return"N"===r?null==t?void 0:t(i):"E"===r?null==e?void 0:e(o):null==n?void 0:n()},t.prototype.accept=function(t,e,n){return ef(null==t?void 0:t.next)?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){var t=this.kind,e=this.value,n=this.error,r="N"===t?nW(e):"E"===t?nU(function(){return n}):"C"===t?nv:0;if(!r)throw TypeError("Unexpected notification kind "+t);return r},t.createNext=function(e){return new t("N",e)},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t}();function n$(t,e){var n,r,i,o=t.kind,u=t.value,a=t.error;if("string"!=typeof o)throw TypeError('Invalid notification, missing "kind"');"N"===o?null===(n=e.next)||void 0===n||n.call(e,u):"E"===o?null===(r=e.error)||void 0===r||r.call(e,a):null===(i=e.complete)||void 0===i||i.call(e)}function nY(t){return!!t&&(t instanceof eN||ef(t.lift)&&ef(t.subscribe))}var nX=e_(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}});function nQ(t,e){var n="object"==typeof e;return new Promise(function(r,i){var o,u=!1;t.subscribe({next:function(t){o=t,u=!0},error:i,complete:function(){u?r(o):n?r(e.defaultValue):i(new nX)}})})}function nJ(t,e){var n="object"==typeof e;return new Promise(function(r,i){var o=new eD({next:function(t){r(t),o.unsubscribe()},error:i,complete:function(){n?r(e.defaultValue):i(new nX)}});t.subscribe(o)})}var nZ=e_(function(t){return function(){t(this),this.name="ArgumentOutOfRangeError",this.message="argument out of range"}}),nK=e_(function(t){return function(e){t(this),this.name="NotFoundError",this.message=e}}),n0=e_(function(t){return function(e){t(this),this.name="SequenceError",this.message=e}});function n1(t){return t instanceof Date&&!isNaN(t)}var n2=e_(function(t){return function(e){void 0===e&&(e=null),t(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e}});function n4(t,e){var n=n1(t)?{first:t}:"number"==typeof t?{each:t}:t,r=n.first,i=n.each,o=n.with,u=void 0===o?n6:o,a=n.scheduler,c=void 0===a?null!=e?e:nl:a,s=n.meta,l=void 0===s?null:s;if(null==r&&null==i)throw TypeError("No timeout provided.");return eG(function(t,e){var n,o,a=null,s=0,f=function(t){o=nF(e,c,function(){try{n.unsubscribe(),nR(u({meta:l,lastValue:a,seen:s})).subscribe(e)}catch(t){e.error(t)}},t)};n=t.subscribe(eV(e,function(t){null==o||o.unsubscribe(),s++,e.next(a=t),i>0&&f(i)},void 0,void 0,function(){(null==o?void 0:o.closed)||null==o||o.unsubscribe(),a=null})),s||f(null!=r?"number"==typeof r?r:+r-c.now():i)})}function n6(t){throw new n2(t)}function n3(t,e){return eG(function(n,r){var i=0;n.subscribe(eV(r,function(n){r.next(t.call(e,n,i++))}))})}var n5=Array.isArray;function n9(t){return n3(function(e){return n5(e)?t.apply(void 0,es([],ec(e))):t(e)})}function n7(t,e,n,r){if(n){if(!nx(n))return function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];return n7(t,e,r).apply(this,i).pipe(n9(n))};r=n}return r?function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return n7(t,e).apply(this,n).pipe(nN(r),nB(r))}:function(){for(var n=this,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=new e6,u=!0;return new eN(function(i){var a=o.subscribe(i);if(u){u=!1;var c=!1,s=!1;e.apply(n,es(es([],ec(r)),[function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t){var r=e.shift();if(null!=r){o.error(r);return}}o.next(1<e.length?e:e[0]),s=!0,c&&o.complete()}])),s&&o.complete(),c=!0}return a})}}function n8(t,e,n){return n7(!1,t,e,n)}function rt(t,e,n){return n7(!0,t,e,n)}var re=Array.isArray,rn=Object.getPrototypeOf,rr=Object.prototype,ri=Object.keys;function ro(t){if(1===t.length){var e=t[0];if(re(e))return{args:e,keys:null};if(e&&"object"==typeof e&&rn(e)===rr){var n=ri(e);return{args:n.map(function(t){return e[t]}),keys:n}}}return{args:t,keys:null}}function ru(t,e){return t.reduce(function(t,n,r){return t[n]=e[r],t},{})}function ra(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=nk(t),r=nE(t),i=ro(t),o=i.args,u=i.keys;if(0===o.length)return nV([],n);var a=new eN(rc(o,n,u?function(t){return ru(u,t)}:eL));return r?a.pipe(n9(r)):a}function rc(t,e,n){return void 0===n&&(n=eL),function(r){var i;i=function(){for(var i=t.length,o=Array(i),u=i,a=i,c=function(i){var c;c=function(){var c=nV(t[i],e),s=!1;c.subscribe(eV(r,function(t){o[i]=t,!s&&(s=!0,a--),a||r.next(n(o.slice()))},function(){--u||r.complete()}))},e?nF(r,e,c):c()},s=0;s<i;s++)c(s)},e?nF(r,e,i):i()}}function rs(t,e,n,r,i,o,u,a){var c=[],s=0,l=0,f=!1,_=function(){!f||c.length||s||e.complete()},d=function(t){return s<r?b(t):c.push(t)},b=function(t){o&&e.next(t),s++;var a=!1;nR(n(t,l++)).subscribe(eV(e,function(t){null==i||i(t),o?d(t):e.next(t)},function(){a=!0},void 0,function(){if(a)try{for(s--;c.length&&s<r;)!function(){var t=c.shift();u?nF(e,u,function(){return b(t)}):b(t)}();_()}catch(t){e.error(t)}}))};return t.subscribe(eV(e,d,function(){f=!0,_()})),function(){null==a||a()}}function rl(t,e,n){return(void 0===n&&(n=1/0),ef(e))?rl(function(n,r){return n3(function(t,i){return e(n,t,r,i)})(nR(t(n,r)))},n):("number"==typeof e&&(n=e),eG(function(e,r){return rs(e,r,t,n)}))}function rf(t){return void 0===t&&(t=1/0),rl(eL,t)}function r_(){return rf(1)}function rd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r_()(nV(t,nk(t)))}function rb(t){return new eN(function(e){nR(t()).subscribe(e)})}var rh={connector:function(){return new eK},resetOnDisconnect:!0};function rg(t,e){void 0===e&&(e=rh);var n=null,r=e.connector,i=e.resetOnDisconnect,o=void 0===i||i,u=r(),a=new eN(function(t){return u.subscribe(t)});return a.connect=function(){return(!n||n.closed)&&(n=rb(function(){return t}).subscribe(u),o&&n.add(function(){return u=r()})),n},a}function rp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=nE(t),r=ro(t),i=r.args,o=r.keys,u=new eN(function(t){var e=i.length;if(!e){t.complete();return}for(var n=Array(e),r=e,u=e,a=function(e){var a=!1;nR(i[e]).subscribe(eV(t,function(t){!a&&(a=!0,u--),n[e]=t},function(){return r--},void 0,function(){r&&a||(u||t.next(o?ru(o,n):n),t.complete())}))},c=0;c<e;c++)a(c)});return n?u.pipe(n9(n)):u}var rw=["addListener","removeListener"],rm=["addEventListener","removeEventListener"],rv=["on","off"];function ry(t,e,n,r){if(ef(n)&&(r=n,n=void 0),r)return ry(t,e,n).pipe(n9(r));var i=ec(ef(t.addEventListener)&&ef(t.removeEventListener)?rm.map(function(r){return function(i){return t[r](e,i,n)}}):ef(t.addListener)&&ef(t.removeListener)?rw.map(rx(t,e)):ef(t.on)&&ef(t.off)?rv.map(rx(t,e)):[],2),o=i[0],u=i[1];if(!o&&nT(t))return rl(function(t){return ry(t,e,n)})(nR(t));if(!o)throw TypeError("Invalid event target");return new eN(function(t){var e=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.next(1<e.length?e:e[0])};return o(e),function(){return u(e)}})}function rx(t,e){return function(n){return function(r){return t[n](e,r)}}}function rS(t,e,n,r,i){var o,u,a;function c(){var t;return eu(this,function(r){switch(r.label){case 0:t=a,r.label=1;case 1:if(!(!e||e(t)))return[3,4];return[4,u(t)];case 2:r.sent(),r.label=3;case 3:return t=n(t),[3,1];case 4:return[2]}})}return 1==arguments.length?(a=t.initialState,e=t.condition,n=t.iterate,u=void 0===(o=t.resultSelector)?eL:o,i=t.scheduler):(a=t,!r||nx(r)?(u=eL,i=r):u=r),rb(i?function(){return nj(c(),i)}:c)}function rE(t,e,n){return rb(function(){return t()?e:n})}function rk(t,e,n){void 0===t&&(t=0),void 0===n&&(n=nf);var r=-1;return null!=e&&(nx(e)?n=e:r=e),new eN(function(e){var i=n1(t)?+t-n.now():t;i<0&&(i=0);var o=0;return n.schedule(function(){e.closed||(e.next(o++),0<=r?this.schedule(void 0,r):e.complete())},i)})}function rA(t,e){return void 0===t&&(t=0),void 0===e&&(e=nl),t<0&&(t=0),rk(t,t,e)}function rT(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=nk(t),r=nA(t,1/0);return t.length?1===t.length?nR(t[0]):rf(r)(nV(t,n)):nv}var rP=new eN(ex);function rC(){return rP}var rI=Array.isArray;function rD(t){return 1===t.length&&rI(t[0])?t[0]:t}function rM(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=rD(t);return new eN(function(t){var e=0,r=function(){if(e<n.length){var i=void 0;try{i=nR(n[e++])}catch(t){r();return}var o=new eW(t,void 0,ex,ex);i.subscribe(o),o.add(r)}else t.complete()};r()})}function rO(t,e){return nV(Object.entries(t),e)}function rz(t,e){return eG(function(n,r){var i=0;n.subscribe(eV(r,function(n){return t.call(e,n,i++)&&r.next(n)}))})}function rR(t,e,n){return[rz(e,n)(nR(t)),rz(function(t,r){return!e.call(n,t,r)})(nR(t))]}function rL(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 1===(t=rD(t)).length?nR(t[0]):new eN(rF(t))}function rF(t){return function(e){for(var n=[],r=function(r){n.push(nR(t[r]).subscribe(eV(e,function(t){if(n){for(var i=0;i<n.length;i++)i!==r&&n[i].unsubscribe();n=null}e.next(t)})))},i=0;n&&!e.closed&&i<t.length;i++)r(i)}}function rB(t,e,n){if(null==e&&(e=t,t=0),e<=0)return nv;var r=e+t;return new eN(n?function(e){var i=t;return n.schedule(function(){i<r?(e.next(i++),this.schedule()):e.complete()})}:function(e){for(var n=t;n<r&&!e.closed;)e.next(n++);e.complete()})}function rN(t,e){return new eN(function(n){var r=t(),i=e(r);return(i?nR(i):nv).subscribe(n),function(){r&&r.unsubscribe()}})}function rj(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=nE(t),r=rD(t);return r.length?new eN(function(t){var e=r.map(function(){return[]}),i=r.map(function(){return!1});t.add(function(){e=i=null});for(var o=function(o){nR(r[o]).subscribe(eV(t,function(r){if(e[o].push(r),e.every(function(t){return t.length})){var u=e.map(function(t){return t.shift()});t.next(n?n.apply(void 0,es([],ec(u))):u),e.some(function(t,e){return!t.length&&i[e]})&&t.complete()}},function(){i[o]=!0,e[o].length||t.complete()}))},u=0;!t.closed&&u<r.length;u++)o(u);return function(){e=i=null}}):nv}function rq(t){return eG(function(e,n){var r=!1,i=null,o=null,u=!1,a=function(){if(null==o||o.unsubscribe(),o=null,r){r=!1;var t=i;i=null,n.next(t)}u&&n.complete()},c=function(){o=null,u&&n.complete()};e.subscribe(eV(n,function(e){r=!0,i=e,o||nR(t(e)).subscribe(o=eV(n,a,c))},function(){u=!0,r&&o&&!o.closed||n.complete()}))})}function rG(t,e){return void 0===e&&(e=nl),rq(function(){return rk(t,e)})}function rV(t){return eG(function(e,n){var r=[];return e.subscribe(eV(n,function(t){return r.push(t)},function(){n.next(r),n.complete()})),nR(t).subscribe(eV(n,function(){var t=r;r=[],n.next(t)},ex)),function(){r=null}})}function rW(t,e){return void 0===e&&(e=null),e=null!=e?e:t,eG(function(n,r){var i=[],o=0;n.subscribe(eV(r,function(n){var u,a,c,s,l=null;o++%e==0&&i.push([]);try{for(var f=ea(i),_=f.next();!_.done;_=f.next()){var d=_.value;d.push(n),t<=d.length&&(l=null!=l?l:[]).push(d)}}catch(t){u={error:t}}finally{try{_&&!_.done&&(a=f.return)&&a.call(f)}finally{if(u)throw u.error}}if(l)try{for(var b=ea(l),h=b.next();!h.done;h=b.next()){var d=h.value;eb(i,d),r.next(d)}}catch(t){c={error:t}}finally{try{h&&!h.done&&(s=b.return)&&s.call(b)}finally{if(c)throw c.error}}},function(){var t,e;try{for(var n=ea(i),o=n.next();!o.done;o=n.next()){var u=o.value;r.next(u)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}r.complete()},void 0,function(){i=null}))})}function rU(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=null!==(e=nk(r))&&void 0!==e?e:nl,u=null!==(n=r[0])&&void 0!==n?n:null,a=r[1]||1/0;return eG(function(e,n){var r=[],i=!1,c=function(t){var e=t.buffer;t.subs.unsubscribe(),eb(r,t),n.next(e),i&&s()},s=function(){if(r){var e=new eh;n.add(e);var i={buffer:[],subs:e};r.push(i),nF(e,o,function(){return c(i)},t)}};null!==u&&u>=0?nF(n,o,s,u,!0):i=!0,s();var l=eV(n,function(t){var e,n,i=r.slice();try{for(var o=ea(i),u=o.next();!u.done;u=o.next()){var s=u.value,l=s.buffer;l.push(t),a<=l.length&&c(s)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},function(){for(;null==r?void 0:r.length;)n.next(r.shift().buffer);null==l||l.unsubscribe(),n.complete(),n.unsubscribe()},void 0,function(){return r=null});e.subscribe(l)})}function rH(t,e){return eG(function(n,r){var i=[];nR(t).subscribe(eV(r,function(t){var n=[];i.push(n);var o=new eh;o.add(nR(e(t)).subscribe(eV(r,function(){eb(i,n),r.next(n),o.unsubscribe()},ex)))},ex)),n.subscribe(eV(r,function(t){var e,n;try{for(var r=ea(i),o=r.next();!o.done;o=r.next())o.value.push(t)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},function(){for(;i.length>0;)r.next(i.shift());r.complete()}))})}function r$(t){return eG(function(e,n){var r=null,i=null,o=function(){null==i||i.unsubscribe();var e=r;r=[],e&&n.next(e),nR(t()).subscribe(i=eV(n,o,ex))};o(),e.subscribe(eV(n,function(t){return null==r?void 0:r.push(t)},function(){r&&n.next(r),n.complete()},void 0,function(){return r=i=null}))})}function rY(t,e,n,r,i){return function(o,u){var a=n,c=e,s=0;o.subscribe(eV(u,function(e){var n=s++;c=a?t(c,e,n):(a=!0,e),r&&u.next(c)},i&&function(){a&&u.next(c),u.complete()}))}}function rX(t,e){return eG(rY(t,e,arguments.length>=2,!1,!0))}var rQ=function(t,e){return t.push(e),t};function rJ(){return eG(function(t,e){rX(rQ,[])(t).subscribe(e)})}function rZ(t,e){return eF(rJ(),rl(function(e){return t(e)}),e?n9(e):eL)}function rK(t){return rZ(ra,t)}var r0=rK;function r1(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=nE(t);return n?eF(r1.apply(void 0,es([],ec(t))),n9(n)):eG(function(e,n){rc(es([e],ec(rD(t))))(n)})}function r2(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r1.apply(void 0,es([],ec(t)))}function r4(t,e){return ef(e)?rl(t,e,1):rl(t,1)}function r6(t,e){return ef(e)?r4(function(){return t},e):r4(function(){return t})}function r3(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=nk(t);return eG(function(e,r){r_()(nV(es([e],ec(t)),n)).subscribe(r)})}function r5(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r3.apply(void 0,es([],ec(t)))}var r9={connector:function(){return new eK}};function r7(t,e){void 0===e&&(e=r9);var n=e.connector;return eG(function(e,r){var i=n();nR(t(new eN(function(t){return i.subscribe(t)}))).subscribe(r),r.add(e.subscribe(i))})}function r8(t){return rX(function(e,n,r){return!t||t(n,r)?e+1:e},0)}function it(t){return eG(function(e,n){var r=!1,i=null,o=null,u=function(){if(null==o||o.unsubscribe(),o=null,r){r=!1;var t=i;i=null,n.next(t)}};e.subscribe(eV(n,function(e){null==o||o.unsubscribe(),r=!0,i=e,o=eV(n,u,ex),nR(t(e)).subscribe(o)},function(){u(),n.complete()},void 0,function(){i=o=null}))})}function ie(t,e){return void 0===e&&(e=nl),eG(function(n,r){var i=null,o=null,u=null,a=function(){if(i){i.unsubscribe(),i=null;var t=o;o=null,r.next(t)}};function c(){var n=u+t,o=e.now();if(o<n){i=this.schedule(void 0,n-o),r.add(i);return}a()}n.subscribe(eV(r,function(n){o=n,u=e.now(),i||(i=e.schedule(c,t),r.add(i))},function(){a(),r.complete()},void 0,function(){o=i=null}))})}function ir(t){return eG(function(e,n){var r=!1;e.subscribe(eV(n,function(t){r=!0,n.next(t)},function(){r||n.next(t),n.complete()}))})}function ii(t){return t<=0?function(){return nv}:eG(function(e,n){var r=0;e.subscribe(eV(n,function(e){++r<=t&&(n.next(e),t<=r&&n.complete())}))})}function io(){return eG(function(t,e){t.subscribe(eV(e,ex))})}function iu(t){return n3(function(){return t})}function ia(t,e){return e?function(n){return rd(e.pipe(ii(1),io()),n.pipe(ia(t)))}:rl(function(e,n){return nR(t(e,n)).pipe(ii(1),iu(e))})}function ic(t,e){void 0===e&&(e=nl);var n=rk(t,e);return ia(function(){return n})}function is(){return eG(function(t,e){t.subscribe(eV(e,function(t){return n$(t,e)}))})}function il(t,e){return eG(function(n,r){var i=new Set;n.subscribe(eV(r,function(e){var n=t?t(e):e;i.has(n)||(i.add(n),r.next(e))})),e&&nR(e).subscribe(eV(r,function(){return i.clear()},ex))})}function i_(t,e){return void 0===e&&(e=eL),t=null!=t?t:id,eG(function(n,r){var i,o=!0;n.subscribe(eV(r,function(n){var u=e(n);(o||!t(i,u))&&(o=!1,i=u,r.next(n))}))})}function id(t,e){return t===e}function ib(t,e){return i_(function(n,r){return e?e(n[t],r[t]):n[t]===r[t]})}function ih(t){return void 0===t&&(t=ig),eG(function(e,n){var r=!1;e.subscribe(eV(n,function(t){r=!0,n.next(t)},function(){return r?n.complete():n.error(t())}))})}function ig(){return new nX}function ip(t,e){if(t<0)throw new nZ;var n=arguments.length>=2;return function(r){return r.pipe(rz(function(e,n){return n===t}),ii(1),n?ir(e):ih(function(){return new nZ}))}}function iw(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return rd(e,nW.apply(void 0,es([],ec(t))))}}function im(t,e){return eG(function(n,r){var i=0;n.subscribe(eV(r,function(o){t.call(e,o,i++,n)||(r.next(!1),r.complete())},function(){r.next(!0),r.complete()}))})}function iv(t,e){return e?function(n){return n.pipe(iv(function(n,r){return nR(t(n,r)).pipe(n3(function(t,i){return e(n,t,r,i)}))}))}:eG(function(e,n){var r=0,i=null,o=!1;e.subscribe(eV(n,function(e){i||(i=eV(n,void 0,function(){i=null,o&&n.complete()}),nR(t(e,r++)).subscribe(i))},function(){o=!0,i||n.complete()}))})}function iy(){return iv(eL)}var ix=iy;function iS(t,e,n){return void 0===e&&(e=1/0),e=1>(e||0)?1/0:e,eG(function(r,i){return rs(r,i,t,e,void 0,!0,n)})}function iE(t){return eG(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function ik(t,e){return eG(iA(t,e,"value"))}function iA(t,e,n){var r="index"===n;return function(n,i){var o=0;n.subscribe(eV(i,function(u){var a=o++;t.call(e,u,a,n)&&(i.next(r?a:u),i.complete())},function(){i.next(r?-1:void 0),i.complete()}))}}function iT(t,e){return eG(iA(t,e,"index"))}function iP(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?rz(function(e,n){return t(e,n,r)}):eL,ii(1),n?ir(e):ih(function(){return new nX}))}}function iC(t,e,n,r){return eG(function(i,o){e&&"function"!=typeof e?(n=e.duration,u=e.element,r=e.connector):u=e;var u,a=new Map,c=function(t){a.forEach(t),t(o)},s=function(t){return c(function(e){return e.error(t)})},l=0,f=!1,_=new eW(o,function(e){try{var i=t(e),c=a.get(i);if(!c){a.set(i,c=r?r():new eK);var d,b,h=(d=c,(b=new eN(function(t){l++;var e=d.subscribe(t);return function(){e.unsubscribe(),0==--l&&f&&_.unsubscribe()}})).key=i,b);if(o.next(h),n){var g=eV(c,function(){c.complete(),null==g||g.unsubscribe()},void 0,void 0,function(){return a.delete(i)});_.add(nR(n(h)).subscribe(g))}}c.next(u?u(e):e)}catch(t){s(t)}},function(){return c(function(t){return t.complete()})},s,function(){return a.clear()},function(){return f=!0,0===l});i.subscribe(_)})}function iI(){return eG(function(t,e){t.subscribe(eV(e,function(){e.next(!1),e.complete()},function(){e.next(!0),e.complete()}))})}function iD(t){return t<=0?function(){return nv}:eG(function(e,n){var r=[];e.subscribe(eV(n,function(e){r.push(e),t<r.length&&r.shift()},function(){var t,e;try{for(var i=ea(r),o=i.next();!o.done;o=i.next()){var u=o.value;n.next(u)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}n.complete()},void 0,function(){r=null}))})}function iM(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?rz(function(e,n){return t(e,n,r)}):eL,iD(1),n?ir(e):ih(function(){return new nX}))}}function iO(){return eG(function(t,e){t.subscribe(eV(e,function(t){e.next(nH.createNext(t))},function(){e.next(nH.createComplete()),e.complete()},function(t){e.next(nH.createError(t)),e.complete()}))})}function iz(t){return rX(ef(t)?function(e,n){return t(e,n)>0?e:n}:function(t,e){return t>e?t:e})}var iR=rl;function iL(t,e,n){return(void 0===n&&(n=1/0),ef(e))?rl(function(){return t},e,n):("number"==typeof e&&(n=e),rl(function(){return t},n))}function iF(t,e,n){return void 0===n&&(n=1/0),eG(function(r,i){var o=e;return rs(r,i,function(e,n){return t(o,e,n)},n,function(t){o=t},!1,void 0,function(){return o=null})})}function iB(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=nk(t),r=nA(t,1/0);return t=rD(t),eG(function(e,i){rf(r)(nV(es([e],ec(t)),n)).subscribe(i)})}function iN(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return iB.apply(void 0,es([],ec(t)))}function ij(t){return rX(ef(t)?function(e,n){return 0>t(e,n)?e:n}:function(t,e){return t<e?t:e})}function iq(t,e){var n=ef(t)?t:function(){return t};return ef(e)?r7(e,{connector:n}):function(t){return new eH(t,n)}}function iG(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=rD(t);return function(t){return rM.apply(void 0,es([t],ec(n)))}}function iV(){return eG(function(t,e){var n,r=!1;t.subscribe(eV(e,function(t){var i=n;n=t,r&&e.next([i,t]),r=!0}))})}function iW(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.length;if(0===n)throw Error("list of properties cannot be empty.");return n3(function(e){for(var r=e,i=0;i<n;i++){var o=null==r?void 0:r[t[i]];if(void 0===o)return;r=o}return r})}function iU(t){return t?function(e){return r7(t)(e)}:function(t){return iq(new eK)(t)}}function iH(t){return function(e){var n=new e1(t);return new eH(e,function(){return n})}}function i$(){return function(t){var e=new e6;return new eH(t,function(){return e})}}function iY(t,e,n,r){n&&!ef(n)&&(r=n);var i=ef(n)?n:void 0;return function(n){return iq(new e4(t,e,r),i)(n)}}function iX(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length?eG(function(e,n){rF(es([e],ec(t)))(n)}):eL}function iQ(t){var e,n,r=1/0;return null!=t&&("object"==typeof t?(r=void 0===(e=t.count)?1/0:e,n=t.delay):r=t),r<=0?function(){return nv}:eG(function(t,e){var i,o=0,u=function(){if(null==i||i.unsubscribe(),i=null,null!=n){var t="number"==typeof n?rk(n):nR(n(o)),r=eV(e,function(){r.unsubscribe(),a()});t.subscribe(r)}else a()},a=function(){var n=!1;i=t.subscribe(eV(e,void 0,function(){++o<r?i?u():n=!0:e.complete()})),n&&u()};a()})}function iJ(t){return eG(function(e,n){var r,i,o=!1,u=!1,a=!1,c=function(){return a&&u&&(n.complete(),!0)},s=function(){a=!1,r=e.subscribe(eV(n,void 0,function(){a=!0,c()||(i||nR(t(i=new eK)).subscribe(eV(n,function(){r?s():o=!0},function(){u=!0,c()})),i).next()})),o&&(r.unsubscribe(),r=null,o=!1,s())};s()})}function iZ(t){void 0===t&&(t=1/0);var e,n=(e=t&&"object"==typeof t?t:{count:t}).count,r=void 0===n?1/0:n,i=e.delay,o=e.resetOnSuccess,u=void 0!==o&&o;return r<=0?eL:eG(function(t,e){var n,o=0,a=function(){var c=!1;n=t.subscribe(eV(e,function(t){u&&(o=0),e.next(t)},void 0,function(t){if(o++<r){var u=function(){n?(n.unsubscribe(),n=null,a()):c=!0};if(null!=i){var s="number"==typeof i?rk(i):nR(i(t,o)),l=eV(e,function(){l.unsubscribe(),u()},function(){e.complete()});s.subscribe(l)}else u()}else e.error(t)})),c&&(n.unsubscribe(),n=null,a())};a()})}function iK(t){return eG(function(e,n){var r,i,o=!1,u=function(){r=e.subscribe(eV(n,void 0,void 0,function(e){i||nR(t(i=new eK)).subscribe(eV(n,function(){return r?u():o=!0})),i&&i.next(e)})),o&&(r.unsubscribe(),r=null,o=!1,u())};u()})}function i0(t){return eG(function(e,n){var r=!1,i=null;e.subscribe(eV(n,function(t){r=!0,i=t})),nR(t).subscribe(eV(n,function(){if(r){r=!1;var t=i;i=null,n.next(t)}},ex))})}function i1(t,e){return void 0===e&&(e=nl),i0(rA(t,e))}function i2(t,e){return eG(rY(t,e,arguments.length>=2,!0))}function i4(t,e){return void 0===e&&(e=function(t,e){return t===e}),eG(function(n,r){var i=i6(),o=i6(),u=function(t){r.next(t),r.complete()},a=function(t,n){var i=eV(r,function(r){var i=n.buffer,o=n.complete;0===i.length?o?u(!1):t.buffer.push(r):e(r,i.shift())||u(!1)},function(){t.complete=!0;var e=n.complete,r=n.buffer;e&&u(0===r.length),null==i||i.unsubscribe()});return i};n.subscribe(a(i,o)),nR(t).subscribe(a(o,i))})}function i6(){return{buffer:[],complete:!1}}function i3(t){void 0===t&&(t={});var e=t.connector,n=void 0===e?function(){return new eK}:e,r=t.resetOnError,i=void 0===r||r,o=t.resetOnComplete,u=void 0===o||o,a=t.resetOnRefCountZero,c=void 0===a||a;return function(t){var e,r,o,a=0,s=!1,l=!1,f=function(){null==r||r.unsubscribe(),r=void 0},_=function(){f(),e=o=void 0,s=l=!1},d=function(){var t=e;_(),null==t||t.unsubscribe()};return eG(function(t,b){a++,l||s||f();var h=o=null!=o?o:n();b.add(function(){0!=--a||l||s||(r=i5(d,c))}),h.subscribe(b),!e&&a>0&&(e=new eD({next:function(t){return h.next(t)},error:function(t){l=!0,f(),r=i5(_,i,t),h.error(t)},complete:function(){s=!0,f(),r=i5(_,u),h.complete()}}),nR(t).subscribe(e))})(t)}}function i5(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!0===e){t();return}if(!1!==e){var i=new eD({next:function(){i.unsubscribe(),t()}});return nR(e.apply(void 0,es([],ec(n)))).subscribe(i)}}function i9(t,e,n){var r,i,o,u,a=!1;return t&&"object"==typeof t?(u=void 0===(r=t.bufferSize)?1/0:r,e=void 0===(i=t.windowTime)?1/0:i,a=void 0!==(o=t.refCount)&&o,n=t.scheduler):u=null!=t?t:1/0,i3({connector:function(){return new e4(u,e,n)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:a})}function i7(t){return eG(function(e,n){var r,i=!1,o=!1,u=0;e.subscribe(eV(n,function(a){o=!0,(!t||t(a,u++,e))&&(i&&n.error(new n0("Too many matching values")),i=!0,r=a)},function(){i?(n.next(r),n.complete()):n.error(o?new nK("No matching values"):new nX)}))})}function i8(t){return rz(function(e,n){return t<=n})}function ot(t){return t<=0?eL:eG(function(e,n){var r=Array(t),i=0;return e.subscribe(eV(n,function(e){var o=i++;if(o<t)r[o]=e;else{var u=o%t,a=r[u];r[u]=e,n.next(a)}})),function(){r=null}})}function oe(t){return eG(function(e,n){var r=!1,i=eV(n,function(){null==i||i.unsubscribe(),r=!0},ex);nR(t).subscribe(i),e.subscribe(eV(n,function(t){return r&&n.next(t)}))})}function on(t){return eG(function(e,n){var r=!1,i=0;e.subscribe(eV(n,function(e){return(r||(r=!t(e,i++)))&&n.next(e)}))})}function or(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=nk(t);return eG(function(e,r){(n?rd(t,e,n):rd(t,e)).subscribe(r)})}function oi(t,e){return eG(function(n,r){var i=null,o=0,u=!1,a=function(){return u&&!i&&r.complete()};n.subscribe(eV(r,function(n){null==i||i.unsubscribe();var u=0,c=o++;nR(t(n,c)).subscribe(i=eV(r,function(t){return r.next(e?e(n,t,c,u++):t)},function(){i=null,a()}))},function(){u=!0,a()}))})}function oo(){return oi(eL)}function ou(t,e){return ef(e)?oi(function(){return t},e):oi(function(){return t})}function oa(t,e){return eG(function(n,r){var i=e;return oi(function(e,n){return t(i,e,n)},function(t,e){return i=e,e})(n).subscribe(r),function(){i=null}})}function oc(t){return eG(function(e,n){nR(t).subscribe(eV(n,function(){return n.complete()},ex)),n.closed||e.subscribe(n)})}function os(t,e){return void 0===e&&(e=!1),eG(function(n,r){var i=0;n.subscribe(eV(r,function(n){var o=t(n,i++);(o||e)&&r.next(n),o||r.complete()}))})}function ol(t,e,n){var r=ef(t)||e||n?{next:t,error:e,complete:n}:t;return r?eG(function(t,e){null===(n=r.subscribe)||void 0===n||n.call(r);var n,i=!0;t.subscribe(eV(e,function(t){var n;null===(n=r.next)||void 0===n||n.call(r,t),e.next(t)},function(){var t;i=!1,null===(t=r.complete)||void 0===t||t.call(r),e.complete()},function(t){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,t),e.error(t)},function(){var t,e;i&&(null===(t=r.unsubscribe)||void 0===t||t.call(r)),null===(e=r.finalize)||void 0===e||e.call(r)}))}):eL}function of(t,e){return eG(function(n,r){var i=null!=e?e:{},o=i.leading,u=void 0===o||o,a=i.trailing,c=void 0!==a&&a,s=!1,l=null,f=null,_=!1,d=function(){null==f||f.unsubscribe(),f=null,c&&(g(),_&&r.complete())},b=function(){f=null,_&&r.complete()},h=function(e){return f=nR(t(e)).subscribe(eV(r,d,b))},g=function(){if(s){s=!1;var t=l;l=null,r.next(t),_||h(t)}};n.subscribe(eV(r,function(t){s=!0,l=t,f&&!f.closed||(u?g():h(t))},function(){_=!0,c&&s&&f&&!f.closed||r.complete()}))})}function o_(t,e,n){void 0===e&&(e=nl);var r=rk(t,e);return of(function(){return r},n)}function od(t){return void 0===t&&(t=nl),eG(function(e,n){var r=t.now();e.subscribe(eV(n,function(e){var i=t.now(),o=i-r;r=i,n.next(new ob(e,o))}))})}var ob=function(t,e){this.value=t,this.interval=e};function oh(t,e,n){var r,i,o;if(n=null!=n?n:nf,n1(t)?r=t:"number"==typeof t&&(i=t),e)o=function(){return e};else throw TypeError("No observable provided to switch to");if(null==r&&null==i)throw TypeError("No timeout provided.");return n4({first:r,each:i,scheduler:n,with:o})}function og(t){return void 0===t&&(t=e2),n3(function(e){return{value:e,timestamp:t.now()}})}function op(t){return eG(function(e,n){var r=new eK;n.next(r.asObservable());var i=function(t){r.error(t),n.error(t)};return e.subscribe(eV(n,function(t){return null==r?void 0:r.next(t)},function(){r.complete(),n.complete()},i)),nR(t).subscribe(eV(n,function(){r.complete(),n.next(r=new eK)},ex,i)),function(){null==r||r.unsubscribe(),r=null}})}function ow(t,e){void 0===e&&(e=0);var n=e>0?e:t;return eG(function(e,r){var i=[new eK],o=0;r.next(i[0].asObservable()),e.subscribe(eV(r,function(e){try{for(var u,a,c=ea(i),s=c.next();!s.done;s=c.next())s.value.next(e)}catch(t){u={error:t}}finally{try{s&&!s.done&&(a=c.return)&&a.call(c)}finally{if(u)throw u.error}}var l=o-t+1;if(l>=0&&l%n==0&&i.shift().complete(),++o%n==0){var f=new eK;i.push(f),r.next(f.asObservable())}},function(){for(;i.length>0;)i.shift().complete();r.complete()},function(t){for(;i.length>0;)i.shift().error(t);r.error(t)},function(){i=null}))})}function om(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var o=null!==(e=nk(r))&&void 0!==e?e:nl,u=null!==(n=r[0])&&void 0!==n?n:null,a=r[1]||1/0;return eG(function(e,n){var r=[],i=!1,c=function(t){var e=t.window,n=t.subs;e.complete(),n.unsubscribe(),eb(r,t),i&&s()},s=function(){if(r){var e=new eh;n.add(e);var i=new eK,u={window:i,subs:e,seen:0};r.push(u),n.next(i.asObservable()),nF(e,o,function(){return c(u)},t)}};null!==u&&u>=0?nF(n,o,s,u,!0):i=!0,s();var l=function(t){return r.slice().forEach(t)},f=function(t){l(function(e){return t(e.window)}),t(n),n.unsubscribe()};return e.subscribe(eV(n,function(t){l(function(e){e.window.next(t),a<=++e.seen&&c(e)})},function(){return f(function(t){return t.complete()})},function(t){return f(function(e){return e.error(t)})})),function(){r=null}})}function ov(t,e){return eG(function(n,r){var i=[],o=function(t){for(;0<i.length;)i.shift().error(t);r.error(t)};nR(t).subscribe(eV(r,function(t){var n,u=new eK;i.push(u);var a=new eh;try{n=nR(e(t))}catch(t){o(t);return}r.next(u.asObservable()),a.add(n.subscribe(eV(r,function(){eb(i,u),u.complete(),a.unsubscribe()},ex,o)))},ex)),n.subscribe(eV(r,function(t){var e,n,r=i.slice();try{for(var o=ea(r),u=o.next();!u.done;u=o.next())u.value.next(t)}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},function(){for(;0<i.length;)i.shift().complete();r.complete()},o,function(){for(;0<i.length;)i.shift().unsubscribe()}))})}function oy(t){return eG(function(e,n){var r,i,o=function(t){r.error(t),n.error(t)},u=function(){var e;null==i||i.unsubscribe(),null==r||r.complete(),r=new eK,n.next(r.asObservable());try{e=nR(t())}catch(t){o(t);return}e.subscribe(i=eV(n,u,u,o))};u(),e.subscribe(eV(n,function(t){return r.next(t)},function(){r.complete(),n.complete()},o,function(){null==i||i.unsubscribe(),r=null}))})}function ox(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=nE(t);return eG(function(e,r){for(var i=t.length,o=Array(i),u=t.map(function(){return!1}),a=!1,c=function(e){nR(t[e]).subscribe(eV(r,function(t){o[e]=t,!a&&!u[e]&&(u[e]=!0,(a=u.every(eL))&&(u=null))},ex))},s=0;s<i;s++)c(s);e.subscribe(eV(r,function(t){if(a){var e=es([t],ec(o));r.next(n?n.apply(void 0,es([],ec(e))):e)}}))})}function oS(t){return rZ(rj,t)}function oE(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return eG(function(e,n){rj.apply(void 0,es([e],ec(t))).subscribe(n)})}function ok(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return oE.apply(void 0,es([],ec(t)))}function oA(t,e){let{Observable:n,Observer:r,Subscribable:i,Subscription:o}=t;e.transferHandlers.set("observable",{canHandle:t=>t instanceof n,deserialize:t=>new n(n=>{let r=e.transferHandlers.get("proxy").deserialize(t);r.subscribe(e.proxy({next:t=>n.next(t),error:t=>n.error(t),complete:()=>n.complete()})).then(t=>n.add(()=>{t.unsubscribe(),r[e.releaseProxy]()}))}),serialize:t=>e.transferHandlers.get("proxy").serialize({subscribe:e=>t.subscribe({next:t=>void e.next(t).then(),error:t=>void e.error(t).then(),complete:()=>void e.complete().then()})})}),e.transferHandlers.set("subscription",{canHandle:t=>t instanceof o,deserialize:t=>new o(()=>{let n=e.transferHandlers.get("proxy").deserialize(t);n.unsubscribe().then(()=>{n[releaseProxy]()})}),serialize:t=>e.transferHandlers.get("proxy").serialize({unsubscribe:()=>t.unsubscribe()})})}async function oT(t,e,n){let{start:r,end:i}=t.get(),o=BigInt(Math.round(r+n/e*(i-r)));return t.segmentAtOffset(o)}async function oP(t,e,n,r,i,o,u){let a=document.createElement("div"),c=document.createElement("canvas"),s=a.clientWidth,l=a.clientHeight;c.width=s,// data_canvas.height = height;
c.height=20,c.id="viewer-"+e;let f=c.transferControlToOffscreen(),_=await t.createPathViewer(tW.transfer(f,[f]),n.coord_sys,e,r,i,o,u),d=document.createElement("canvas");d.width=s,d.height=l,c.style.setProperty("z-index","0"),d.style.setProperty("z-index","1"),c.classList.add("path-data-canvas"),d.classList.add("path-data-canvas"),await _.setCanvasWidth(s),a.append(c),a.append(d);{let t=n.get();await _.setView(t.start,t.end),await _.sample(),await _.forceRedraw()}let b={worker_ctx:_,data_canvas:c,overlay_canvas:d,container:a,trackCallbacks:{},viewport:n,path_name:e};// data_canvas.path_viewer = path_viewer;
return b.onResize=async()=>{let t=a.clientWidth,e=a.clientHeight;console.warn("resizing path viewer"),console.warn(a),console.warn("width: ",t,", height: ",e),await _.setCanvasWidth(t),// await viewer_ctx.setCanvasDims({ width: w, height: h });
// await viewer_ctx.setCanvasDims(w, h);
await _.resizeTargetCanvas(t,e),await _.sample(),await _.forceRedraw(),d.width=t,d.height=e},b.drawOverlays=async()=>{let t=d.getContext("2d");t?.clearRect(0,0,d.width,d.height);let e=n.get();for(let t in b.trackCallbacks){let n=b.trackCallbacks[t];n(d,e)}},b.data_canvas.path_viewer=b,b}async function oC(t,e){let{worker_ctx:n,overlay_canvas:r}=e,i=ry(r,"wheel").pipe(er.tap(t=>t.preventDefault())),o=ry(r,"mousedown"),u=ry(r,"mouseup"),a=ry(r,"mousemove"),c=ry(r,"mouseout");c.subscribe(t=>{let e=document.getElementById("tooltip");e.innerHTML="",e.style.display="none"}),a.pipe(er.distinct(),er.throttleTime(50)).subscribe(async n=>{let i=n.offsetX;n.offsetY;let o=r.width,u=await oT(e.viewport,o,i);console.log("segment at cursor: "+u);let a=document.getElementById("tooltip");a.innerHTML=`Segment ${u}`,a.style.display="block",console.warn("x: ",n.clientX,", y: ",n.clientY),tV(n.clientX,n.clientY);// placeTooltipAtPoint(x, y);
let c=await t.pathsOnSegment(u);console.log("paths!!!"),console.log(c)});let s=i.pipe(n3(t=>{let e=t.offsetX/r.width;return{scale:t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY>0?1.01:.99:t.deltaY>0?1.05:.95,x:e}}));s.subscribe(({scale:t,x:n})=>{e.viewport.zoomNorm(n,t)});let l=o.pipe(oi(t=>a.pipe(n3(t=>t.movementX),oc(rL(u,c))))),f=l.pipe(er.map(t=>-(t/r.width)));f.subscribe(t=>{let n=t*e.viewport.length;e.viewport.translateView(n)});let _=e.viewport.subject;n.sample(),n.forceRedraw(),_.pipe(er.distinct(),er.throttleTime(10)).subscribe(t=>{requestAnimationFrame(i=>{n.setView(t.start,t.end),n.sample(),n.forceRedraw();let o=r.getContext("2d");for(let n in o?.clearRect(0,0,r.width,r.height),e.trackCallbacks){let i=e.trackCallbacks[n];i(r,t)}})})}async function oI(t,e){let n=er.fromEvent(t.canvas,"wheel"),r=er.fromEvent(t.canvas,"mousedown"),i=er.fromEvent(t.canvas,"mouseup"),o=er.fromEvent(t.canvas,"mousemove"),u=er.fromEvent(t.canvas,"mouseout"),a=e.max,c=n.pipe(n3(t=>t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY>0?1.01:.99:t.deltaY>0?1.05:.95));c.subscribe(t=>{e.zoomViewCentered(t)});let s=r.pipe(oi(e=>o.pipe(n3(e=>e.offsetX/t.canvas.width*a),oc(rL(i,u)))));// await cs_view.subscribeCenterAt(mouseAt$);
s.subscribe(t=>{e.centerAt(t)}),e.subject.pipe(er.distinct(),er.throttleTime(10)).subscribe(e=>{requestAnimationFrame(()=>{t.draw(e)})})}Object.keys(a={}).forEach(function(t){"default"===t||"__esModule"===t||er.hasOwnProperty(t)||Object.defineProperty(er,t,{enumerable:!0,get:function(){return a[t]}})}),oA(er,tW);class oD{constructor(t,e){this.canvas=t,this.latest_view=null,this.view_max=e}draw(t){if(void 0===t&&(t=this.latest_view),!t)return;let e=this.canvas.getContext("2d"),n=this.canvas.width,r=this.view_max,i=t.start/r*n,o=t.end/r*n;// console.log('left: ' + view.start + ', right: ' + view.end + ', max: ' + max);
// console.log('x0: ' + x0 + ', x1: ' + x1);
e.clearRect(0,0,this.canvas.width,this.canvas.height);let u=Math.round(t.start).toString(),a=Math.round(t.end).toString(),c=e.measureText(u).width,s=e.measureText(a).width,l=o-i,f=this.canvas.height/2;// console.log("left_txt width: " + left_w);
// console.log("right_txt width: " + right_w);
e.save(),i>c?(e.textAlign="end",e.fillText(u,i-2,f)):l>c?(e.textAlign="start",e.fillText(u,i+2,f)):(e.textAlign="start",e.fillText(u,o+2,f)),e.restore(),n-o>s?(e.textAlign="start",e.fillText(a,o+2,f)):l>s?(e.textAlign="end",e.fillText(a,o-2,f)):(e.textAlign="start",e.fillText(a,o+2,f)),e.strokeStyle="red",e.lineWidth=2,e.beginPath(),e.rect(i,-5,o-i,this.canvas.height+10),e.stroke(),this.latest_view=t}}function oM(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}!// function createHorizontalArrowPattern(head_height, head_length, separation) {
function(){let t=new OffscreenCanvas(32,32),e=t.getContext("2d");e.strokeStyle="black",e.moveTo(0,16),e.lineTo(32,16),e.moveTo(8,16),e.lineTo(5,8),e.moveTo(8,16),e.lineTo(5,24),// ctx.moveTo(16, 16);
// ctx.lineTo(13, 8);
// ctx.moveTo(16, 16);
// ctx.lineTo(13, 24);
e.moveTo(24,16),e.lineTo(21,8),e.moveTo(24,16),e.lineTo(21,24),e.stroke(),e.createPattern(t,"repeat-x")}();class oO{callback_key;waragraph;svg_root;record_states;last_2d_view;constructor(t,n,r){// this.last_2d_view_scale = null;
// this.last_2d_view_center = null;
// this.last_1d_view = null;
for(let i of(this.callback_key="painter-"+n,e||tu(void 0,t.wasm.memory).then(t=>{e=t,U()}),// this.record_svg_gs = [];
// this.svg_parent = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
// this.record_canvas_paths = [];
this.waragraph=t,this.svg_root=oM("g"),this.svg_root.id=this.callback_key,this.record_states=[],this.last_2d_view=null,r)){let t=oM("g"),e=oM("g");e.classList.add("svg-overlay-1d");let n=oM("g");n.classList.add("svg-overlay-2d");let r=oM("line"),o=oM("line");r.classList.add("svg-overlay-link-start"),o.classList.add("svg-overlay-link-end"),e.setAttribute("display","none"),n.setAttribute("display","none"),r.setAttribute("stroke-width","0.3"),o.setAttribute("stroke-width","0.3"),r.setAttribute("display","none"),o.setAttribute("display","none"),t.append(e),t.append(n),t.append(r),t.append(o),this.record_states.push({svg_g:t,record:i,enabled:!1,global_ranges:null,cached_path:null}),this.svg_root.append(t)}}async prepareRecords(){let e=await this.waragraph.get1DViewport();if(void 0===e)throw Error("No viewport available");// const cs_view = await this.waragraph.worker_obj.globalCoordSysView();
for(let n of this.record_states){let r;let{path_name:i,path_step_slice:o}=n.record,u=n.record.bed_record;if("string"==typeof u.itemRgb){let[t,e,n]=u.itemRgb.split(",");r=`rgb(${255*t},${255*e},${255*n})`}else{let{r:t,g:e,b:n}=q(u.name);r=`rgb(${255*t},${255*e},${255*n})`}n.color=r,// state.svg_g.setAttribute('stroke', color);
n.svg_g.setAttribute("color",r);//// global coordinate space rectangles for the 1D path views
let a=function(e){try{let i=t.__wbindgen_add_to_stack_pointer(-16),o=j(e,t.__wbindgen_malloc),u=T;t.path_slice_to_global_adj_partitions(i,o,u);var n=y()[i/4+0],r=y()[i/4+1];if(y()[i/4+2])throw p(r);return tt.__wrap(n)}finally{t.__wbindgen_add_to_stack_pointer(16)}}(o),c=a.ranges_as_u32_array(),s=c.length/2,l=[];for(let t=0;t<s;t++){let n=c.at(2*t),r=c.at(2*t+1);// this... is probably pretty slow
// TODO optimize
if(void 0!==n&&void 0!==r){let t=e.segmentOffset(n),i=e.segmentOffset(r);l.push({start:t,end:i})}}n.global_ranges=l}}resample2DPaths(t){let e=document.getElementById("graph-viewer-2d"),n=document.getElementById("viz-svg-overlay").getBoundingClientRect(),r=e.height/n.height,i=({x:t,y:n})=>({x:100*t/e.width,y:100*r*n/e.height}),o=!1;if(null===this.last_2d_view)o=!0;else{let{width:e,height:n}=this.last_2d_view;(t.width!==e||t.height!==n)&&(o=!0)}if(!1!==o)// for (let { record, cached_path, enabled } of this.record_states) {
for(let e of(this.last_2d_view=t,this.record_states)){if(!e.enabled)continue;let{path_name:t,path_step_slice:n,bed_record:r}=e.record;e.cached_path=this.waragraph.graph_viewer.sampleCanvasSpacePath(n,8);let o="";e.cached_path.with_points((t,e)=>{let n=i({x:t,y:e});0===o.length?o+=`M ${n.x},${n.y}`:o+=` L ${n.x},${n.y}`}),e.svg_g.querySelector(".svg-overlay-2d").innerHTML=// `<path d="${svg_path}" stroke-width="0.5" fill="none" />`;
`<path d="${o}" stroke-width="0.5" stroke="${e.color}" fill="none" />`;// `<path d="${svg_path}" stroke-width="0.5" stroke="red" fill="none" />`;
// console.warn(state.cached_path);
}}async updateSVG1D(t){let e=document.getElementById("viz-svg-overlay").getBoundingClientRect(),n=t.end-t.start,r=(t,n)=>({x:100*(t-e.left)/e.width,y:100*(n-e.top)/e.height});// for (const { svg_g, record, global_ranges, enabled, color } of this.record_states) {
for(let i of this.record_states){let{svg_g:o,record:u,global_ranges:a,color:c}=i;if(null===a)continue;let s=o.querySelector(".svg-overlay-link-start"),l=o.querySelector(".svg-overlay-link-end"),f=u.path_step_slice.at(0)>>1,_=u.path_step_slice.at(-1)>>1,d=await this.waragraph.segmentScreenPos1d(u.path_name,f),b=await this.waragraph.segmentScreenPos1d(u.path_name,_),h=r(d.x0,d.y0),g=r(b.x1,b.y1);s.setAttribute("x2",String(h.x)),s.setAttribute("y2",String(h.y)),l.setAttribute("x2",String(g.x)),l.setAttribute("y2",String(g.y));let p=o.querySelector(".svg-overlay-1d"),w=document.getElementById("viewer-"+u.path_name),m=w.getBoundingClientRect();for(let{start:r,end:i}of(p.innerHTML="",a)){let o=oM("rect");p.append(o);// map global range to `data_rect` via `view_1d`
let u=(r-t.start)/n,a=(i-t.start)/n,s=m.left+u*m.width,l=m.left+a*m.width,f=100*(m.top-e.top)/e.height,_=100*(s-e.left)/e.width,d=100*(l-e.left)/e.width-_,b=100*m.height/e.height;o.outerHTML=`<rect x="${_}" y="${f}" width="${d}" height="${b}"
fill="${c}"
/>`}}}updateSVGPaths(t){let e=document.getElementById("graph-viewer-2d");e.width,e.height;// const canvas_rect = canvas.getBoundingClientRect();
let n=document.getElementById("viz-svg-overlay").getBoundingClientRect(),r=e.height/n.height,i=({x:t,y:n})=>({x:100*t/e.width,y:100*r*n/e.height});// for (const { svg_g, record, cached_path, enabled, color } of this.record_states) {
for(let t of this.record_states){let{svg_g:e,record:n,cached_path:r,enabled:o,color:u}=t;if(!o||null===r)continue;let a=e.querySelector(".svg-overlay-link-start"),c=e.querySelector(".svg-overlay-link-end"),s=n.path_step_slice.at(0)>>1,l=n.path_step_slice.at(-1)>>1,f=this.waragraph.segmentScreenPos2d(s),_=this.waragraph.segmentScreenPos2d(l),d=i({x:f.start[0],y:f.start[1]}),b=i({x:_.end[0],y:_.end[1]});a.setAttribute("x1",String(d.x)),a.setAttribute("y1",String(d.y)),c.setAttribute("x1",String(b.x)),c.setAttribute("y1",String(b.y)),void 0!==u&&(a.setAttribute("stroke",u),c.setAttribute("stroke",u));let h=e.querySelector(".svg-overlay-2d > path");console.warn(h);/*
      let svg_path = "";

      cached_path.with_points((x, y) => {
        const p = map_canvas_to_svg({ x, y });

        if (svg_path.length === 0) {
          svg_path += `M ${p.x},${p.y}`;
        } else {
          svg_path += ` L ${p.x},${p.y}`;
        }
      });

      svg_g.querySelector('.svg-overlay-2d').innerHTML =
        // svg_g.innerHTML =
        // `<path d="${svg_path}" stroke-width="0.5" fill="none" />`;
        `<path d="${svg_path}" stroke-width="0.5" stroke="${color}" fill="none" />`;
      // `<path d="${svg_path}" stroke-width="0.5" stroke="red" fill="none" />`;
       */}}}var oz={};function oR(t,e,n,r){this.message=t,this.expected=e,this.found=n,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,oR)}!function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(oR,Error),oR.buildMessage=function(t,e){var n={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){var e,n="";for(e=0;e<t.parts.length;e++)n+=t.parts[e]instanceof Array?o(t.parts[e][0])+"-"+o(t.parts[e][1]):o(t.parts[e]);return"["+(t.inverted?"^":"")+n+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+r(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+r(t)})}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+r(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+r(t)})}return"Expected "+function(t){var e,r,i,o=Array(t.length);for(r=0;r<t.length;r++)o[r]=n[(e=t[r]).type](e);if(o.sort(),o.length>0){for(r=1,i=1;r<o.length;r++)o[r-1]!==o[r]&&(o[i]=o[r],i++);o.length=i}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(t)+" but "+(e?'"'+i(e)+'"':"end of input")+" found."},oz={SyntaxError:oR,parse:function(t,e){e=void 0!==e?e:{};var n,r,i,o,u,a,c,s,l={},f={declaration:tD},_=tD,d=tA("(",!1),b=tA(")",!1),h="simple",g=tA("simple",!1),p="object",w=tA("object",!1),m="table",v=tA("table",!1),y="auto",x=tA("auto",!1),S="primary",E=tA("primary",!1),k="index",A=tA("index",!1),T="unique",P=tA("unique",!1),C=function(t,e){return e},I=tA("#",!1),D=tA(";",!1),M=tA("[",!1),O=tA("]",!1),z=tA(",",!1),R=tA("int",!1),L="uint",F=tA("uint",!1),B="short",N=tA("short",!1),j="ushort",q=tA("ushort",!1),G="byte",V=tA("byte",!1),W="ubyte",U=tA("ubyte",!1),H="float",$=tA("float",!1),Y="char",X=tA("char",!1),Q="string",J=tA("string",!1),Z="lstring",K=tA("lstring",!1),tt="enum",te=tA("enum",!1),tn="double",tr=tA("double",!1),ti="bigint",to=tA("bigint",!1),tu=tA("set",!1),ta=/^[a-zA-Z_]/,tc=tT([["a","z"],["A","Z"],"_"],!1,!1),ts=/^[a-zA-Z0-9_]/,tl=tT([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),tf=(tA('"',!1),tT(['"'],!0,!1),/^[^\n\r]/),t_=tT(["\n","\r"],!0,!1),td=tP("integer"),tb=/^[0-9]/,th=tT([["0","9"]],!1,!1),tg=tP("whitespace"),tp=/^[ \t\n\r]/,tw=tT([" ","	","\n","\r"],!1,!1),tm=0,tv=0,ty=[{line:1,column:1}],tx=0,tS=[],tE=0;if("startRule"in e){if(!(e.startRule in f))throw Error("Can't start parsing from rule \""+e.startRule+'".');_=f[e.startRule]}function tk(){return t.substring(tv,tm)}function tA(t,e){return{type:"literal",text:t,ignoreCase:e}}function tT(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function tP(t){return{type:"other",description:t}}function tC(e){var n,r=ty[e];if(r)return r;for(n=e-1;!ty[n];)n--;for(r={line:(r=ty[n]).line,column:r.column};n<e;)10===t.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return ty[e]=r,r}function tI(t){tm<tx||(tm>tx&&(tx=tm,tS=[]),tS.push(t))}function tD(){var e,n,r,i,o,u,a;return(e=tm,tj()!==l&&(n=tM())!==l&&tj()!==l&&(r=tO())!==l&&tj()!==l&&(i=tR())!==l&&tj()!==l&&(40===t.charCodeAt(tm)?(o="(",tm++):(o=l,0===tE&&tI(d)),o!==l&&tj()!==l&&(u=function(){var t,e,n,r,i,o;if(t=tm,(e=tL())!==l){if(tj()!==l){for(n=[],r=tm,tj()!==l&&(i=tL())!==l?(tv=r,r=C(e,i)):(tm=r,r=l);r!==l;)n.push(r),r=tm,tj()!==l&&(i=tL())!==l?(tv=r,r=C(e,i)):(tm=r,r=l);n!==l&&(r=tj())!==l?(tv=t,(o=e).name&&n.unshift(o),t=e=n):(tm=t,t=l)}else tm=t,t=l}else tm=t,t=l;return t}())!==l&&tj()!==l&&(41===t.charCodeAt(tm)?(a=")",tm++):(a=l,0===tE&&tI(b)),a!==l&&tj()!==l)))?(tv=e,e={type:n,name:r,comment:i,fields:u}):(tm=e,e=l),e}function tM(){var e;return t.substr(tm,6)===h?(e=h,tm+=6):(e=l,0===tE&&tI(g)),e===l&&(t.substr(tm,6)===p?(e=p,tm+=6):(e=l,0===tE&&tI(w)),e===l&&(t.substr(tm,5)===m?(e=m,tm+=5):(e=l,0===tE&&tI(v)))),e}function tO(){var e,n,r,i;return(e=tB())===l&&(e=tm,(n=tB())!==l&&(r=tz())!==l?e=n=[n,r]:(tm=e,e=l),e===l&&(e=tm,(n=tB())!==l?(t.substr(tm,4)===y?(r=y,tm+=4):(r=l,0===tE&&tI(x)),r!==l?e=n=[n,r]:(tm=e,e=l)):(tm=e,e=l),e===l&&(e=tm,(n=tB())!==l&&(r=tz())!==l?(t.substr(tm,4)===y?(i=y,tm+=4):(i=l,0===tE&&tI(x)),i!==l?e=n=[n,r,i]:(tm=e,e=l)):(tm=e,e=l)))),e}function tz(){var e;return t.substr(tm,7)===S?(e=S,tm+=7):(e=l,0===tE&&tI(E)),e===l&&(t.substr(tm,5)===k?(e=k,tm+=5):(e=l,0===tE&&tI(A)),e===l&&(t.substr(tm,6)===T?(e=T,tm+=6):(e=l,0===tE&&tI(P)))),e}function tR(){var t;return(t=tN())===l&&(t=tj()),t}function tL(){var e,n,r,i,o,u,a,c,s,f,_,h,g,p,w;return(e=tm,(n=tF())!==l&&tj()!==l&&(r=tB())!==l&&tj()!==l&&(59===t.charCodeAt(tm)?(i=";",tm++):(i=l,0===tE&&tI(D)),i!==l&&tj()!==l&&(o=tR())!==l))?(tv=e,e=n={type:n,name:r,comment:o}):(tm=e,e=l),e===l&&((e=tm,(n=tF())!==l&&tj()!==l&&(91===t.charCodeAt(tm)?(r="[",tm++):(r=l,0===tE&&tI(M)),r!==l&&tj()!==l&&((s=function(){var e,n,r;if(tE++,e=tm,tj()!==l){if(n=[],tb.test(t.charAt(tm))?(r=t.charAt(tm),tm++):(r=l,0===tE&&tI(th)),r!==l)for(;r!==l;)n.push(r),tb.test(t.charAt(tm))?(r=t.charAt(tm),tm++):(r=l,0===tE&&tI(th));else n=l;n!==l?(tv=e,e=parseInt(tk(),10)):(tm=e,e=l)}else tm=e,e=l;return tE--,e===l&&0===tE&&tI(td),e}())===l&&(s=tB()),(i=s)!==l&&tj()!==l&&(93===t.charCodeAt(tm)?(o="]",tm++):(o=l,0===tE&&tI(O)),o!==l&&tj()!==l&&(u=tB())!==l&&tj()!==l&&(59===t.charCodeAt(tm)?(a=";",tm++):(a=l,0===tE&&tI(D)),a!==l&&tj()!==l&&(c=tR())!==l)))))?(tv=e,e=n={type:n,size:i,name:u,comment:c}):(tm=e,e=l),e===l&&((e=tm,(n=tF())!==l&&tj()!==l&&(40===t.charCodeAt(tm)?(r="(",tm++):(r=l,0===tE&&tI(d)),r!==l&&tj()!==l&&(i=function(){var e,n,r,i,o,u,a;if(e=tm,(n=tB())!==l){for(r=[],i=tm,44===t.charCodeAt(tm)?(o=",",tm++):(o=l,0===tE&&tI(z)),o!==l&&tj()!==l&&(u=tB())!==l?(tv=i,i=o=C(n,u)):(tm=i,i=l);i!==l;)r.push(i),i=tm,44===t.charCodeAt(tm)?(o=",",tm++):(o=l,0===tE&&tI(z)),o!==l&&tj()!==l&&(u=tB())!==l?(tv=i,i=o=C(n,u)):(tm=i,i=l);r!==l?(tv=e,a=n,r.unshift(a),e=n=r):(tm=e,e=l)}else tm=e,e=l;return e}())!==l&&tj()!==l&&(41===t.charCodeAt(tm)?(o=")",tm++):(o=l,0===tE&&tI(b)),o!==l&&tj()!==l&&(u=tB())!==l&&tj()!==l&&(59===t.charCodeAt(tm)?(a=";",tm++):(a=l,0===tE&&tI(D)),a!==l&&tj()!==l&&(c=tR())!==l))))?(tv=e,e=n={type:n,vals:i,name:u,comment:c}):(tm=e,e=l),e===l&&((f=tm,(_=tj())!==l)?(35===t.charCodeAt(tm)?(w="#",tm++):(w=l,0===tE&&tI(I)),(h=w)!==l&&(g=tN())!==l&&(p=tj())!==l?f=_=[_,h,g,p]:(tm=f,f=l)):(tm=f,f=l),e=f))),e}function tF(){var e,n,r;return"int"===t.substr(tm,3)?(e="int",tm+=3):(e=l,0===tE&&tI(R)),e===l&&(t.substr(tm,4)===L?(e=L,tm+=4):(e=l,0===tE&&tI(F)),e===l&&(t.substr(tm,5)===B?(e=B,tm+=5):(e=l,0===tE&&tI(N)),e===l&&(t.substr(tm,6)===j?(e=j,tm+=6):(e=l,0===tE&&tI(q)),e===l&&(t.substr(tm,4)===G?(e=G,tm+=4):(e=l,0===tE&&tI(V)),e===l&&(t.substr(tm,5)===W?(e=W,tm+=5):(e=l,0===tE&&tI(U)),e===l&&(t.substr(tm,5)===H?(e=H,tm+=5):(e=l,0===tE&&tI($)),e===l&&(t.substr(tm,4)===Y?(e=Y,tm+=4):(e=l,0===tE&&tI(X)),e===l&&(t.substr(tm,6)===Q?(e=Q,tm+=6):(e=l,0===tE&&tI(J)),e===l&&(t.substr(tm,7)===Z?(e=Z,tm+=7):(e=l,0===tE&&tI(K)),e===l&&(t.substr(tm,4)===tt?(e=tt,tm+=4):(e=l,0===tE&&tI(te)),e===l&&(t.substr(tm,6)===tn?(e=tn,tm+=6):(e=l,0===tE&&tI(tr)),e===l&&(t.substr(tm,6)===ti?(e=ti,tm+=6):(e=l,0===tE&&tI(to)),e===l&&("set"===t.substr(tm,3)?(e="set",tm+=3):(e=l,0===tE&&tI(tu)),e===l)))))))))))))&&((e=tm,(n=tM())!==l&&tj()!==l&&(r=tO())!==l)?(tv=e,e=n=n+" "+r):(tm=e,e=l)),e}function tB(){var e,n,r,i,o;if(e=tm,n=tm,ta.test(t.charAt(tm))?(r=t.charAt(tm),tm++):(r=l,0===tE&&tI(tc)),r!==l){for(i=[],ts.test(t.charAt(tm))?(o=t.charAt(tm),tm++):(o=l,0===tE&&tI(tl));o!==l;)i.push(o),ts.test(t.charAt(tm))?(o=t.charAt(tm),tm++):(o=l,0===tE&&tI(tl));i!==l?n=r=[r,i]:(tm=n,n=l)}else tm=n,n=l;return n!==l&&(tv=e,n=tk()),n}function tN(){var e,n,r;for(e=tm,n=[],tf.test(t.charAt(tm))?(r=t.charAt(tm),tm++):(r=l,0===tE&&tI(t_));r!==l;)n.push(r),tf.test(t.charAt(tm))?(r=t.charAt(tm),tm++):(r=l,0===tE&&tI(t_));return n!==l&&(tv=e,n=n.join("").replace(/^"/,"").replace(/"$/,"")),n}function tj(){var e,n;for(tE++,e=[],tp.test(t.charAt(tm))?(n=t.charAt(tm),tm++):(n=l,0===tE&&tI(tw));n!==l;)e.push(n),tp.test(t.charAt(tm))?(n=t.charAt(tm),tm++):(n=l,0===tE&&tI(tw));return tE--,e===l&&(n=l,0===tE&&tI(tg)),e}if((s=_())!==l&&tm===t.length)return s;throw s!==l&&tm<t.length&&tI({type:"end"}),u=tS,a=tx<t.length?t.charAt(tx):null,n=tx,r=tx<t.length?tx+1:tx,i=tC(n),o=tC(r),c={start:{offset:n,line:i.line,column:i.column},end:{offset:r,line:o.line,column:o.column}},new oR(oR.buildMessage(u,a),u,a,c)}};var oL={};o(oL,"bigChain",function(){return oF}),o(oL,"bigGenePred",function(){return oB}),o(oL,"bigInteract",function(){return oN}),o(oL,"bigLink",function(){return oj}),o(oL,"bigMaf",function(){return oq}),o(oL,"bigNarrowPeak",function(){return oG}),o(oL,"bigPsl",function(){return oV}),o(oL,"defaultBedSchema",function(){return oW}),o(oL,"mafFrames",function(){return oU}),o(oL,"mafSummary",function(){return oH});let oF=`table bigChain
"bigChain pairwise alignment"
    (
    string chrom;       "Reference sequence chromosome or scaffold"
    uint   chromStart;  "Start position in chromosome"
    uint   chromEnd;    "End position in chromosome"
    string name;        "Name or ID of item, ideally both human readable and unique"
    uint score;         "Score (0-1000)"
    char[1] strand;     "+ or - for strand"
    uint tSize;         "size of target sequence"
    string qName;       "name of query sequence"
    uint qSize;         "size of query sequence"
    uint qStart;        "start of alignment on query sequence"
    uint qEnd;          "end of alignment on query sequence"
    uint chainScore;    "score from chain"
    )`,oB=`table bigGenePred
"bigGenePred gene models"
   (
   string chrom;       "Reference sequence chromosome or scaffold"
   uint   chromStart;  "Start position in chromosome"
   uint   chromEnd;    "End position in chromosome"
   string name;        "Name or ID of item, ideally both human readable and unique"
   uint score;         "Score (0-1000)"
   char[1] strand;     "+ or - for strand"
   uint thickStart;    "Start of where display should be thick (start codon)"
   uint thickEnd;      "End of where display should be thick (stop codon)"
   uint reserved;       "RGB value (use R,G,B string in input file)"
   int blockCount;     "Number of blocks"
   int[blockCount] blockSizes; "Comma separated list of block sizes"
   int[blockCount] chromStarts; "Start positions relative to chromStart"
   string name2;       "Alternative/human readable name"
   string cdsStartStat; "Status of CDS start annotation (none, unknown, incomplete, or complete)"
   string cdsEndStat;   "Status of CDS end annotation (none, unknown, incomplete, or complete)"
   int[blockCount] exonFrames; "Exon frame {0,1,2}, or -1 if no frame for exon"
   string type;        "Transcript type"
   string geneName;    "Primary identifier for gene"
   string geneName2;   "Alternative/human readable gene name"
   string geneType;    "Gene type"
   )`,oN=`table interact
"interaction between two regions"
    (
    string chrom;        "Chromosome (or contig, scaffold, etc.). For interchromosomal, use 2 records"
    uint chromStart;     "Start position of lower region. For interchromosomal, set to chromStart of this region"
    uint chromEnd;       "End position of upper region. For interchromosomal, set to chromEnd of this region"
    string name;         "Name of item, for display.  Usually 'sourceName/targetName/exp' or empty"
    uint score;          "Score (0-1000)"
    double value;        "Strength of interaction or other data value. Typically basis for score"
    string exp;          "Experiment name (metadata for filtering). Use . if not applicable"
    string color;        "Item color.  Specified as r,g,b or hexadecimal #RRGGBB or html color name, as in //www.w3.org/TR/css3-color/#html4. Use 0 and spectrum setting to shade by score"
    string sourceChrom;  "Chromosome of source region (directional) or lower region. For non-directional interchromosomal, chrom of this region."
    uint sourceStart;    "Start position in chromosome of source/lower/this region"
    uint sourceEnd;      "End position in chromosome of source/lower/this region"
    string sourceName;   "Identifier of source/lower/this region"
    string sourceStrand; "Orientation of source/lower/this region: + or -.  Use . if not applicable"
    string targetChrom;  "Chromosome of target region (directional) or upper region. For non-directional interchromosomal, chrom of other region"
    uint targetStart;    "Start position in chromosome of target/upper/this region"
    uint targetEnd;      "End position in chromosome of target/upper/this region"
    string targetName;   "Identifier of target/upper/this region"
    string targetStrand; "Orientation of target/upper/this region: + or -.  Use . if not applicable"

    )`,oj=`table bigLink
"bigLink pairwise alignment"
    (
    string chrom;       "Reference sequence chromosome or scaffold"
    uint   chromStart;  "Start position in chromosome"
    uint   chromEnd;    "End position in chromosome"
    string name;        "Name or ID of item, ideally both human readable and unique"
    uint qStart;        "start of alignment on query sequence"
    )`,oq=`table bedMaf
"Bed3 with MAF block"
    (
    string chrom;      "Reference sequence chromosome or scaffold"
    uint   chromStart; "Start position in chromosome"
    uint   chromEnd;   "End position in chromosome"
    lstring mafBlock;   "MAF block"
    )`,oG=`table bigNarrowPeak
"BED6+4 Peaks of signal enrichment based on pooled, normalized (interpreted) data."
(
    string chrom;        "Reference sequence chromosome or scaffold"
    uint   chromStart;   "Start position in chromosome"
    uint   chromEnd;     "End position in chromosome"
    string name;	 "Name given to a region (preferably unique). Use . if no name is assigned"
    uint   score;        "Indicates how dark the peak will be displayed in the browser (0-1000) "
    char[1]  strand;     "+ or - or . for unknown"
    float  signalValue;  "Measurement of average enrichment for the region"
    float  pValue;       "Statistical significance of signal value (-log10). Set to -1 if not used."
    float  qValue;       "Statistical significance with multiple-test correction applied (FDR -log10). Set to -1 if not used."
    int   peak;         "Point-source called for this peak; 0-based offset from chromStart. Set to -1 if no point-source called."
)`,oV=`table bigPsl
"bigPsl pairwise alignment"
    (
    string chrom;       "Reference sequence chromosome or scaffold"
    uint   chromStart;  "Start position in chromosome"
    uint   chromEnd;    "End position in chromosome"
    string name;        "Name or ID of item, ideally both human readable and unique"
    uint score;         "Score (0-1000)"
    char[1] strand;     "+ or - indicates whether the query aligns to the + or - strand on the reference"
    uint thickStart;    "Start of where display should be thick (start codon)"
    uint thickEnd;      "End of where display should be thick (stop codon)"
    uint reserved;       "RGB value (use R,G,B string in input file)"
    int blockCount;     "Number of blocks"
    int[blockCount] blockSizes; "Comma separated list of block sizes"
    int[blockCount] chromStarts; "Start positions relative to chromStart"

    uint    oChromStart;"Start position in other chromosome"
    uint    oChromEnd;  "End position in other chromosome"
    char[1] oStrand;    "+ or -, - means that psl was reversed into BED-compatible coordinates"
    uint    oChromSize; "Size of other chromosome."
    int[blockCount] oChromStarts; "Start positions relative to oChromStart or from oChromStart+oChromSize depending on strand"

    lstring  oSequence;  "Sequence on other chrom (or empty)"
    string   oCDS;       "CDS in NCBI format"

    uint    chromSize;"Size of target chromosome"

    uint match;        "Number of bases matched."
    uint misMatch; " Number of bases that don't match "
    uint repMatch; " Number of bases that match but are part of repeats "
    uint nCount;   " Number of 'N' bases "
    uint seqType;    "0=empty, 1=nucleotide, 2=amino_acid"
    )`,oW=`table defaultBedSchema
"BED12"
    (
    string chrom;      "The name of the chromosome (e.g. chr3, chrY, chr2_random) or scaffold (e.g. scaffold10671)."
    uint   chromStart; "The starting position of the feature in the chromosome or scaffold. The first base in a chromosome is numbered 0."
    uint   chromEnd;   "The ending position of the feature in the chromosome or scaffold. The chromEnd base is not included in the display of the feature. For example, the first 100 bases of a chromosome are defined as chromStart=0, chromEnd=100, and span the bases numbered 0-99."
    string   name;   "Defines the name of the BED line."
    float   score;   "Feature score, doesn't care about the 0-1000 limit as in bed"
    char   strand;   "Defines the strand. Either '.' (=no strand) or '+' or '-'"
    uint thickStart; "The starting position at which the feature is drawn thickly (for example, the start codon in gene displays). When there is no thick part, thickStart and thickEnd are usually set to the chromStart position."
    uint thickEnd; "The ending position at which the feature is drawn thickly (for example the stop codon in gene displays)."
    string itemRgb; "An RGB value of the form R,G,B (e.g. 255,0,0). "
    uint blockCount; " The number of blocks (exons) in the BED line."
    uint[blockCount] blockSizes; " A comma-separated list of the block sizes. The number of items in this list should correspond to blockCount."
    uint[blockCount] blockStarts; "A comma-separated list of block starts. All of the blockStart positions should be calculated relative to chromStart. The number of items in this list should correspond to blockCount."
    )`,oU=`table mafFrames
"codon frame assignment for MAF components"
    (
    string chrom;      "Reference sequence chromosome or scaffold"
    uint   chromStart; "Start range in chromosome"
    uint   chromEnd;   "End range in chromosome"
    string src;        "Name of sequence source in MAF"
    ubyte frame;       "frame (0,1,2) for first base(+) or last bast(-)"
    char[1] strand;    "+ or -"
    string name;       "Name of gene used to define frame"
    int    prevFramePos;  "target position of the previous base (in transcription direction) that continues this frame, or -1 if none, or frame not contiguous"
    int    nextFramePos;  "target position of the next base (in transcription direction) that continues this frame, or -1 if none, or frame not contiguous"
    ubyte  isExonStart;  "does this start the CDS portion of an exon?"
    ubyte  isExonEnd;    "does this end the CDS portion of an exon?"
    )`,oH=`table mafSummary
"Positions and scores for alignment blocks"
    (
    string chrom;      "Reference sequence chromosome or scaffold"
    uint   chromStart; "Start position in chromosome"
    uint   chromEnd;   "End position in chromosome"
    string src;        "Sequence name or database of alignment"
    float  score;      "Floating point score."
    char[1] leftStatus;  "Gap/break annotation for preceding block"
    char[1] rightStatus; "Gap/break annotation for following block"
    )`;var o$=Object.fromEntries(Object.entries(oL).map(([t,e])=>[t,(0,oz.parse)(e.trim())]));/*
 * adds some type annotations to the autoSql schema
 * for numeric fields ['uint', 'int', 'float', 'long'] "isNumeric" is added
 * for array types "isArray" is added
 * for numeric array types "isArray" and "arrayIsNumeric" is set
 *
 * @param autoSql - an autoSql schema from the peg parser
 * @return autoSql with type annotations added
 */function oY(t){let e=["uint","int","float","long"];return{...t,fields:t.fields.map(t=>({...t,isArray:t.size&&"char"!==t.type,arrayIsNumeric:t.size&&e.includes(t.type),isNumeric:!t.size&&e.includes(t.type)}))}}let oX={".":0,"-":-1,"+":1};var oQ=class{constructor(t={}){if(t.autoSql){var e;this.autoSql=oY(((e=oz)&&e.__esModule?e.default:e).parse(t.autoSql))}else if(t.type){if(!o$[t.type])throw Error("Type not found");this.autoSql=oY(o$[t.type])}else this.autoSql=oY(o$.defaultBedSchema),this.attemptDefaultBed=!0}/*
     * parses a line of text as a BED line with the loaded autoSql schema
     *
     * @param line - a BED line as tab delimited text or array
     * @param opts - supply opts.uniqueId
     * @return a object representing a feature
     */parseLine(t,e={}){var n,r;let{autoSql:i}=this,{uniqueId:o}=e,u=Array.isArray(t)?t:t.split("	"),a={};if(!this.attemptDefaultBed||this.attemptDefaultBed&&(n=u).length>=12&&!Number.isNaN(parseInt(n[9],10))&&(null===(r=n[10])||void 0===r?void 0:r.split(",").filter(t=>!!t).length)===parseInt(n[9],10))for(let t=0;t<i.fields.length;t++){let e=i.fields[t],n=u[t],{isNumeric:r,isArray:o,arrayIsNumeric:c,name:s}=e;if(null==n)break;if("."!==n){if(r){let t=Number(n);n=Number.isNaN(t)?n:t}else o&&(""===(n=n.split(","))[n.length-1]&&n.pop(),c&&(n=n.map(t=>Number(t))));a[s]=n}}else{let t=["chrom","chromStart","chromEnd","name"];(a=Object.fromEntries(u.map((e,n)=>[t[n]||"field"+n,e]))).chromStart=+a.chromStart,a.chromEnd=+a.chromEnd,Number.isNaN(Number.parseFloat(a.field4))||(a.score=+a.field4,delete a.field4),("+"===a.field5||"-"===a.field5)&&(a.strand=a.field5,delete a.field5)}return o&&(a.uniqueId=o),a.strand=oX[a.strand]||0,a.chrom=decodeURIComponent(a.chrom),a}};let oJ=new Map,oZ=null;class oK{file_name;records;annotation_painter;// constructor(file_name, record_lines) {
constructor(t){this.file_name=t,this.records=[],this.annotation_painter=null;// per record: 
// { canvas_1d: Map<Path, bool>,
//   canvas_2d: bool,
//   svg_shared: svg element
}async appendRecords(t,e){let n=t.graph;for(let r of e){if(Number.isNaN(r.chromStart)||Number.isNaN(r.chromEnd))continue;let e=this.records.length,i=function(t){if(oJ.has(t))return t;for(let e of oJ.keys())if(e.startsWith(t))return e}(r.chrom),o=function(t,e){if(!e)throw`Path ${e} not found`;let n=e.match(/.+:(\d+)-(\d+)$/);if(null===n)return t;let r=Number(n[1]),i=t.chromStart-r;return i<0&&(i=0),{start:i,end:t.chromEnd-r}}(r,i),u=await t.getCoordinateSystem("path:"+i);if(void 0===u)throw Error(`Could not find coordinate system for path ${i}`);// const path_cs_raw = await waragraph_viz.worker_obj.pathCoordSys(path_name);
// const path_cs = wrapWasmPtr(wasm_bindgen.CoordSys, path_cs_raw.__wbg_ptr);
let a=n.path_steps(i),c=u.bp_to_step_range(BigInt(o.start),BigInt(o.end)),s=a.slice(c.start,c.end),l={record_index:e,bed_record:r,path_name:i,path_range:o,path_step_slice:s};this.records.push(l)}}async initializeAnnotationPainter(t){this.annotation_painter=new oO(t,this.file_name,this.records),await this.annotation_painter.prepareRecords();let e=t.graph_viewer?.getView();document.getElementById("viz-svg-overlay").append(this.annotation_painter.svg_root),// TODO: there are other cases when this should run, especially once
// there's more than just 2D-focused SVG
t.graph_viewer?.view_subject.subscribe(t=>{let{x:n,y:r,width:i,height:o}=t;// add this back when paths' transforms are just updated on pan
// if (prev_view.width !== width
//     || prev_view.height !== height) {
//     update_pos = true;
//     this.annotation_painter.resample2DPaths(view_2d);
// }
(e.x!=n||e.y!==r)&&(// update SVG path offsets;
// should also happen on resample
this.annotation_painter.resample2DPaths(t),this.annotation_painter.updateSVGPaths(t),e=t)});let n=await t.get1DViewport();n?.subject.pipe(il(),o_(50)).subscribe(t=>{this.annotation_painter.updateSVG1D(t)})}recordAnnotationVizState(t){return this.annotation_painter.record_states[t]}createListElement(){let t=document.createElement("div");t.classList.add("bed-file-entry");let e=document.createElement("div");for(let n of(e.innerHTML=this.file_name,e.classList.add("bed-file-name"),e.style.setProperty("flex-basis","30px"),t.append(e),this.records)){let e=document.createElement("div");e.classList.add("bed-file-row");// entry_div.style.setProperty('flex-basis', '20px');
let r=document.createElement("div");r.innerHTML=n.bed_record.name,r.classList.add("bed-row-label");// label_div.classList.add('highlight-enabled');
// add checkboxes/buttons for toggling... or just selection?
// still want something to signal visibility in 1d & 2d, e.g. "eye icons"
let i=this.annotation_painter.record_states;r.addEventListener("click",t=>{let e=i[n.record_index];e.svg_g.querySelector(".svg-overlay-1d"),e.svg_g.querySelector(".svg-overlay-2d");let r=t.target;if(e.enabled){// svg_g_1d.setAttribute('display', 'none');
// svg_g_2d.setAttribute('display', 'none');
for(let t of(r.classList.remove("highlight-enabled"),e.svg_g.children))t.setAttribute("display","none");e.enabled=!1}else{// svg_g_1d.setAttribute('display', 'inline');
// svg_g_2d.setAttribute('display', 'inline');
for(let t of(r.classList.add("highlight-enabled"),e.svg_g.children))t.setAttribute("display","inline");e.enabled=!0}}),// disabling context menu for now
/*
      label_div.addEventListener('click', (ev) => {
          ev.stopPropagation();
          let ctx_menu_el = document.getElementById('sidebar-bed-context-menu');
          _context_menu_entry = { record };
          // _context_menu_entry = { bed_entry,
          //                         processed: entry,
          //                         path_name, 
          //                         path_range,
          //                       };

          computePosition(label_div, ctx_menu_el).then(({x, y}) => {
              ctx_menu_el.style.setProperty('display', 'flex');
              ctx_menu_el.focus();
              Object.assign(ctx_menu_el.style, {
                  left: `${x}px`,
                  top: `${y}px`,
              });
          });
      });
      */e.append(r),t.append(e)}return t}}async function o0(t,e){let n=new oK(e.name),r=await e.text(),i=new oQ,o=r.split("\n").map(t=>i.parseLine(t));await n.appendRecords(t,o),n.initializeAnnotationPainter(t);let u=document.getElementById("bed-file-list"),a=n.createListElement();u.append(a)}async function o1(t){let e=document.createElement("div");e.classList.add("bed-panel");let n=document.createElement("div");n.id="bed-file-list",e.append(n);let r=document.createElement("label");r.setAttribute("for","bed-file-input"),r.innerHTML="Load BED file";let i=document.createElement("input");i.id="bed-file-input",i.setAttribute("type","file"),i.setAttribute("name","bed-file-input"),i.setAttribute("accept",".bed");let o=document.createElement("button");o.innerHTML="Load",o.addEventListener("click",e=>{for(let e of i.files)o0(t,e)}),e.append(r),e.append(i),e.append(o);{t.graph;let e=document.createElement("div");e.id="sidebar-bed-context-menu";let n=document.createElement("button");n.innerHTML="Copy name",n.addEventListener("click",t=>{if(null!==oZ){let t=oZ.record.name;"string"==typeof t&&navigator.clipboard.writeText(t)}}),// TODO context menu needs access to the viz. state
/*
    const focus_2d_btn = document.createElement('button');
    focus_2d_btn.innerHTML = 'Focus 2D view';
    focus_2d_btn.addEventListener('click', async (ev) => {
        if (_context_menu_entry === null) {
            return;
        }

        // TODO use something sensible; not just the first step

        let path_name = _context_menu_entry.path_name;
        let path_slice = _context_menu_entry.path_step_slice;

        let first_node = path_slice[0] / 2;

        // let { start, end } = path_range;

        let path_steps = graph.path_steps(path_name);
        let seg = path_steps[first_node];

        waragraph_viz.centerViewOnSegment2d(seg);
    });
    */e.append(n),// context_menu_el.append(focus_2d_btn);
document.body.append(e)}return document.addEventListener("click",t=>{let e=t.target,n="sidebar-bed-context-menu",r=document.getElementById(n),i="flex"===r.style.display;!e.closest("#"+n)&&i&&(r.style.setProperty("display","none"),oZ=null)}),e}async function o2(t){n||(n=await tu(void 0,t.wasm.memory),U());let e=0;t.graph.with_path_names(t=>{oJ.set(t,e),e+=1}),document.getElementById("sidebar").append(await o1(t))}var o4={};o(o4,"create",function(){return o5}),o(o4,"clone",function(){return o9}),o(o4,"fromValues",function(){return o7}),o(o4,"copy",function(){return o8}),o(o4,"set",function(){return ut}),o(o4,"add",function(){return ue}),o(o4,"subtract",function(){return un}),o(o4,"multiply",function(){return ur}),o(o4,"divide",function(){return ui}),o(o4,"ceil",function(){return uo}),o(o4,"floor",function(){return uu}),o(o4,"min",function(){return ua}),o(o4,"max",function(){return uc}),o(o4,"round",function(){return us}),o(o4,"scale",function(){return ul}),o(o4,"scaleAndAdd",function(){return uf}),o(o4,"distance",function(){return u_}),o(o4,"squaredDistance",function(){return ud}),o(o4,"length",function(){return ub}),o(o4,"squaredLength",function(){return uh}),o(o4,"negate",function(){return ug}),o(o4,"inverse",function(){return up}),o(o4,"normalize",function(){return uw}),o(o4,"dot",function(){return um}),o(o4,"cross",function(){return uv}),o(o4,"lerp",function(){return uy}),o(o4,"random",function(){return ux}),o(o4,"transformMat2",function(){return uS}),o(o4,"transformMat2d",function(){return uE}),o(o4,"transformMat3",function(){return uk}),o(o4,"transformMat4",function(){return uA}),o(o4,"rotate",function(){return uT}),o(o4,"angle",function(){return uP}),o(o4,"zero",function(){return uC}),o(o4,"str",function(){return uI}),o(o4,"exactEquals",function(){return uD}),o(o4,"equals",function(){return uM}),o(o4,"len",function(){return uO}),o(o4,"sub",function(){return uz}),o(o4,"mul",function(){return uR}),o(o4,"div",function(){return uL}),o(o4,"dist",function(){return uF}),o(o4,"sqrDist",function(){return uB}),o(o4,"sqrLen",function(){return uN}),o(o4,"forEach",function(){return uj});var o6="undefined"!=typeof Float32Array?Float32Array:Array,o3=Math.random;function o5(){var t=new o6(2);return o6!=Float32Array&&(t[0]=0,t[1]=0),t}function o9(t){var e=new o6(2);return e[0]=t[0],e[1]=t[1],e}function o7(t,e){var n=new o6(2);return n[0]=t,n[1]=e,n}function o8(t,e){return t[0]=e[0],t[1]=e[1],t}function ut(t,e,n){return t[0]=e,t[1]=n,t}function ue(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function un(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function ur(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function ui(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function uo(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function uu(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function ua(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function uc(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function us(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function ul(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function uf(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}function u_(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function ud(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function ub(t){return Math.hypot(t[0],t[1])}function uh(t){var e=t[0],n=t[1];return e*e+n*n}function ug(t,e){return t[0]=-e[0],t[1]=-e[1],t}function up(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function uw(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function um(t,e){return t[0]*e[0]+t[1]*e[1]}function uv(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}function uy(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function ux(t,e){e=e||1;var n=2*o3()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function uS(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function uE(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function uk(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function uA(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}function uT(t,e,n,r){//Translate point to the origin
var i=e[0]-n[0],o=e[1]-n[1],u=Math.sin(r),a=Math.cos(r);//perform rotation and translate to correct position
return t[0]=i*a-o*u+n[0],t[1]=i*u+o*a+n[1],t}function uP(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],u=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o);// Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1
return Math.acos(Math.min(Math.max(u&&(n*i+r*o)/u,-1),1))}function uC(t){return t[0]=0,t[1]=0,t}function uI(t){return"vec2("+t[0]+", "+t[1]+")"}function uD(t,e){return t[0]===e[0]&&t[1]===e[1]}function uM(t,e){var n=t[0],r=t[1],i=e[0],o=e[1];return Math.abs(n-i)<=1e-6*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=1e-6*Math.max(1,Math.abs(r),Math.abs(o))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var uO=ub,uz=un,uR=ur,uL=ui,uF=u_,uB=ud,uN=uh,uj=(c=o5(),function(t,e,n,r,i,o){var u,a;for(e||(e=2),n||(n=0),a=r?Math.min(r*e+n,t.length):t.length,u=n;u<a;u+=e)c[0]=t[u],c[1]=t[u+1],i(c,c,o),t[u]=c[0],t[u+1]=c[1];return t});/* when Rust objects are passed across a worker boundary and
(de)serialized, we only have the pointer, since the class instance is
"attached" to a module instance

wasm_bindgen's JS includes a static `__wrap` method that takes a
pointer and wraps it in the class, but it's not exposed in the
typescript declarations, hence this reimplementation
 */function uq(t,e){e>>>=0;let n=Object.create(t.prototype);return n.__wbg_ptr=e,n}class uG{graph_viewer;segment_positions;next_view;view_subject;overlayCallbacks;mousePos;gpu_canvas;overlay_canvas;container;constructor(t,e,n,r,i){this.gpu_canvas=t,this.overlay_canvas=e,this.container=i,// maybe just take the minimum raw data needed here
this.graph_viewer=n,this.segment_positions=r,this.next_view=this.graph_viewer.get_view(),this.view_subject=new e1(this.next_view.as_obj()),this.overlayCallbacks={},this.mousePos=null}needRedraw(){return!this.next_view.equals(this.graph_viewer.get_view())}lookup(t,e){try{let n=this.graph_viewer.gbuffer_lookup(r,t,e);return console.log(n),n}catch(t){return null}}sampleCanvasSpacePath(t,e){let n=document.getElementById("graph-viewer-2d");return this.segment_positions.sample_canvas_space_path(this.next_view,n.width,n.height,t,e)}fitViewToGraph(){let t,e,n=this.segment_positions.bounds_as_view_obj(),r=document.getElementById("graph-viewer-2d");if(!r){console.warn("graph-viewer-2d canvas not found");return}let i=r.width/r.height;n.width/n.height>i?e=(t=n.width)*r.height/r.width:t=(e=n.height)*r.width/r.height,this.next_view.set_center(n.x,n.y),this.next_view.set_size(t,e)}resize(){let t=document.getElementById("graph-viewer-2d-overlay"),e=t.parentNode,n=e.clientWidth,i=e.clientHeight;t.width=n,t.height=i,this.graph_viewer.resize(r,Math.round(n),Math.round(i)),this.fitViewToGraph()}draw(){this.graph_viewer.set_view(this.next_view),this.graph_viewer.draw_to_surface(r),this.view_subject.next(this.next_view.as_obj()),this.drawOverlays()}drawOverlays(){let t=document.getElementById("graph-viewer-2d-overlay");// console.log(this.overlayCallbacks);
for(let e in t.getContext("2d").clearRect(0,0,t.width,t.height),this.overlayCallbacks){let n=this.overlayCallbacks[e];n(t,this.next_view,this.mousePos)}}registerOverlayCallback(t,e){this.overlayCallbacks[t]=e,this.drawOverlays()}removeOverlayCallback(t){delete this.overlayCallbacks[t],this.drawOverlays()}// global space
setViewCenter(t,e){this.next_view.set_center(t,e)}// view normalized units
translate(t,e){this.next_view.translate_size_rel(t,e)}// view normalized units
zoom(t,e,n){this.next_view.zoom_with_focus(t,e,n)}getView(){return this.next_view.as_obj()}getViewMatrix(){let t=document.getElementById("graph-viewer-2d-overlay");return this.graph_viewer.get_view_matrix(t.width,t.height)}getSegmentPos(t){return this.segment_positions.segment_pos(t)}getSegmentScreenPos(t){let e=this.getSegmentPos(t);if(null===e)return null;let{x0:n,y0:r,x1:i,y1:o}=e,u=this.getViewMatrix(),a=o4.fromValues(n,r),c=o4.fromValues(i,o),s=o4.create(),l=o4.create();return o4.transformMat3(s,a,u),o4.transformMat3(l,c,u),{start:s,end:l}}}async function uV(t,e,n,o){let u,a,c;void 0===i&&(i=await tu(void 0,t),U());// create canvases
let s=document.createElement("canvas"),l=document.createElement("canvas");s.id="graph-viewer-2d",l.id="graph-viewer-2d-overlay",s.style.setProperty("z-index","0"),l.style.setProperty("z-index","1"),o&&(o.append(s),o.append(l),u=o.clientWidth,a=o.clientHeight,// const width = container.clientWidth;
// const height = container.clientHeight;
s.width=u,s.height=a,l.width=u,l.height=a),void 0===r&&(r=await Z.initialize_(s)),c=n instanceof Blob?await n.text():await fetch(n).then(t=>t.text());let f=K.from_tsv(c),_=uq($,e.__wbg_ptr),d=Q.new_dummy_data(r,_,f,s);u&&a&&d.resize(r,u,a),d.draw_to_surface(r);let b=new uG(s,l,d,f,o),h=()=>{b.needRedraw()&&b.draw(),window.requestAnimationFrame(h)};h();let g=ry(l,"mousedown"),p=ry(l,"mouseup"),w=ry(l,"mouseout"),m=ry(l,"mousemove"),v=m.pipe(n3(t=>({x:t.offsetX,y:t.offsetY})),il(),o_(40),n3(({x:t,y:e})=>b.lookup(t,e)));v.subscribe(t=>{let e=document.getElementById("tooltip");if(null===t)e.innerHTML="",e.style.display="none";else if(null!==b.mousePos){e.innerHTML=`Segment ${t}`,e.style.display="block";let n=document.getElementById("graph-viewer-2d-overlay").getBoundingClientRect(),{x:r,y:i}=b.mousePos;tV(r+n.left,i+n.top)}}),m.subscribe(t=>{b.mousePos={x:t.offsetX,y:t.offsetY}}),w.subscribe(t=>{b.mousePos=null});let y=g.pipe(oi(t=>m.pipe(oc(rL(p,w)))));y.subscribe(t=>{let e=t.movementX,n=t.movementY,r=e/l.width,i=n/l.height;b.translate(-r,i)});let x=ry(l,"wheel").pipe(ol(t=>t.preventDefault()));return x.subscribe(t=>{let e=t.offsetX,n=l.height-t.offsetY,r=e/l.width,i=n/l.height,o=t.deltaY>0?1.05:.95;b.zoom(r,i,o)}),b.fitViewToGraph(),b}var uW=function(t,e){return Number(t.slice(0,-1*e.length))},uU=function(t){return t.endsWith("px")?{value:t,type:"px",numeric:uW(t,"px")}:t.endsWith("fr")?{value:t,type:"fr",numeric:uW(t,"fr")}:t.endsWith("%")?{value:t,type:"%",numeric:uW(t,"%")}:"auto"===t?{value:t,type:"auto"}:null},uH=function(t){return t.split(" ").map(uU)},u$=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=!1);var i=r?t+1:t;return e.slice(0,i).reduce(function(t,e){return t+e.numeric},0)+(n?t*n:0)},uY=function(t,e,n){return e.concat(n).map(function(e){return e.style[t]}).filter(function(t){return void 0!==t&&""!==t})},uX=function(t){// eslint-disable-next-line no-plusplus
for(var e=0;e<t.length;e++)if(t[e].numeric>0)return e;return null},uQ=function(){return!1},uJ=function(t,e,n){// eslint-disable-next-line no-param-reassign
t.style[e]=n},uZ=function(t,e,n){var r=t[e];return void 0!==r?r:n};function uK(t){var e;return(e=[]).concat.apply(e,Array.from(t.ownerDocument.styleSheets).map(function(t){var e=[];try{e=Array.from(t.cssRules||[])}catch(t){// Ignore results on security error
}return e})).filter(function(e){var n=!1;try{n=t.matches(e.selectorText)}catch(t){// Ignore matching erros
}return n})}var u0=function(t,e,n){this.direction=t,this.element=e.element,this.track=e.track,"column"===t?(this.gridTemplateProp="grid-template-columns",this.gridGapProp="grid-column-gap",this.cursor=uZ(n,"columnCursor",uZ(n,"cursor","col-resize")),this.snapOffset=uZ(n,"columnSnapOffset",uZ(n,"snapOffset",30)),this.dragInterval=uZ(n,"columnDragInterval",uZ(n,"dragInterval",1)),this.clientAxis="clientX",this.optionStyle=uZ(n,"gridTemplateColumns")):"row"===t&&(this.gridTemplateProp="grid-template-rows",this.gridGapProp="grid-row-gap",this.cursor=uZ(n,"rowCursor",uZ(n,"cursor","row-resize")),this.snapOffset=uZ(n,"rowSnapOffset",uZ(n,"snapOffset",30)),this.dragInterval=uZ(n,"rowDragInterval",uZ(n,"dragInterval",1)),this.clientAxis="clientY",this.optionStyle=uZ(n,"gridTemplateRows")),this.onDragStart=uZ(n,"onDragStart",uQ),this.onDragEnd=uZ(n,"onDragEnd",uQ),this.onDrag=uZ(n,"onDrag",uQ),this.writeStyle=uZ(n,"writeStyle",uJ),this.startDragging=this.startDragging.bind(this),this.stopDragging=this.stopDragging.bind(this),this.drag=this.drag.bind(this),this.minSizeStart=e.minSizeStart,this.minSizeEnd=e.minSizeEnd,e.element&&(this.element.addEventListener("mousedown",this.startDragging),this.element.addEventListener("touchstart",this.startDragging))};u0.prototype.getDimensions=function(){var t=this.grid.getBoundingClientRect(),e=t.width,n=t.height,r=t.top,i=t.bottom,o=t.left,u=t.right;"column"===this.direction?(this.start=r,this.end=i,this.size=n):"row"===this.direction&&(this.start=o,this.end=u,this.size=e)},u0.prototype.getSizeAtTrack=function(t,e){return u$(t,this.computedPixels,this.computedGapPixels,e)},u0.prototype.getSizeOfTrack=function(t){return this.computedPixels[t].numeric},u0.prototype.getRawTracks=function(){var t=uY(this.gridTemplateProp,[this.grid],uK(this.grid));if(!t.length){if(this.optionStyle)return this.optionStyle;throw Error("Unable to determine grid template tracks from styles.")}return t[0]},u0.prototype.getGap=function(){var t=uY(this.gridGapProp,[this.grid],uK(this.grid));return t.length?t[0]:null},u0.prototype.getRawComputedTracks=function(){return window.getComputedStyle(this.grid)[this.gridTemplateProp]},u0.prototype.getRawComputedGap=function(){return window.getComputedStyle(this.grid)[this.gridGapProp]},u0.prototype.setTracks=function(t){this.tracks=t.split(" "),this.trackValues=uH(t)},u0.prototype.setComputedTracks=function(t){this.computedTracks=t.split(" "),this.computedPixels=uH(t)},u0.prototype.setGap=function(t){this.gap=t},u0.prototype.setComputedGap=function(t){var e;this.computedGap=t,this.computedGapPixels=((e=this.computedGap).endsWith("px")?Number(e.slice(0,-2)):null)||0},u0.prototype.getMousePosition=function(t){return"touches"in t?t.touches[0][this.clientAxis]:t[this.clientAxis]},u0.prototype.startDragging=function(t){if(!("button"in t)||0===t.button){// Don't actually drag the element. We emulate that in the drag function.
t.preventDefault(),this.element?this.grid=this.element.parentNode:this.grid=t.target.parentNode,this.getDimensions(),this.setTracks(this.getRawTracks()),this.setComputedTracks(this.getRawComputedTracks()),this.setGap(this.getGap()),this.setComputedGap(this.getRawComputedGap());var e=this.trackValues.filter(function(t){return"%"===t.type}),n=this.trackValues.filter(function(t){return"fr"===t.type});if(this.totalFrs=n.length,this.totalFrs){var r=uX(n);null!==r&&(this.frToPixels=this.computedPixels[r].numeric/n[r].numeric)}if(e.length){var i=uX(e);null!==i&&(this.percentageToPixels=this.computedPixels[i].numeric/e[i].numeric)}// get start of gutter track
var o=this.getSizeAtTrack(this.track,!1)+this.start;if(this.dragStartOffset=this.getMousePosition(t)-o,this.aTrack=this.track-1,this.track<this.tracks.length-1)this.bTrack=this.track+1;else throw Error("Invalid track index: "+this.track+". Track must be between two other tracks and only "+this.tracks.length+" tracks were found.");this.aTrackStart=this.getSizeAtTrack(this.aTrack,!1)+this.start,this.bTrackEnd=this.getSizeAtTrack(this.bTrack,!0)+this.start,// Set the dragging property of the pair object.
this.dragging=!0,// All the binding. `window` gets the stop events in case we drag out of the elements.
window.addEventListener("mouseup",this.stopDragging),window.addEventListener("touchend",this.stopDragging),window.addEventListener("touchcancel",this.stopDragging),window.addEventListener("mousemove",this.drag),window.addEventListener("touchmove",this.drag),// Disable selection. Disable!
this.grid.addEventListener("selectstart",uQ),this.grid.addEventListener("dragstart",uQ),this.grid.style.userSelect="none",this.grid.style.webkitUserSelect="none",this.grid.style.MozUserSelect="none",this.grid.style.pointerEvents="none",// Set the cursor at multiple levels
this.grid.style.cursor=this.cursor,window.document.body.style.cursor=this.cursor,this.onDragStart(this.direction,this.track)}},u0.prototype.stopDragging=function(){this.dragging=!1,// Remove the stored event listeners. This is why we store them.
this.cleanup(),this.onDragEnd(this.direction,this.track),this.needsDestroy&&(this.element&&(this.element.removeEventListener("mousedown",this.startDragging),this.element.removeEventListener("touchstart",this.startDragging)),this.destroyCb(),this.needsDestroy=!1,this.destroyCb=null)},u0.prototype.drag=function(t){var e=this.getMousePosition(t),n=this.getSizeOfTrack(this.track),r=this.aTrackStart+this.minSizeStart+this.dragStartOffset+this.computedGapPixels,i=this.bTrackEnd-this.minSizeEnd-this.computedGapPixels-(n-this.dragStartOffset),o=r+this.snapOffset,u=i-this.snapOffset;e<o&&(e=r),e>u&&(e=i),e<r?e=r:e>i&&(e=i);var a=e-this.aTrackStart-this.dragStartOffset-this.computedGapPixels,c=this.bTrackEnd-e+this.dragStartOffset-n-this.computedGapPixels;if(this.dragInterval>1){var s=Math.round(a/this.dragInterval)*this.dragInterval;c-=s-a,a=s}if(a<this.minSizeStart&&(a=this.minSizeStart),c<this.minSizeEnd&&(c=this.minSizeEnd),"px"===this.trackValues[this.aTrack].type)this.tracks[this.aTrack]=a+"px";else if("fr"===this.trackValues[this.aTrack].type){if(1===this.totalFrs)this.tracks[this.aTrack]="1fr";else{var l=a/this.frToPixels;this.tracks[this.aTrack]=l+"fr"}}else if("%"===this.trackValues[this.aTrack].type){var f=a/this.percentageToPixels;this.tracks[this.aTrack]=f+"%"}if("px"===this.trackValues[this.bTrack].type)this.tracks[this.bTrack]=c+"px";else if("fr"===this.trackValues[this.bTrack].type){if(1===this.totalFrs)this.tracks[this.bTrack]="1fr";else{var _=c/this.frToPixels;this.tracks[this.bTrack]=_+"fr"}}else if("%"===this.trackValues[this.bTrack].type){var d=c/this.percentageToPixels;this.tracks[this.bTrack]=d+"%"}var b=this.tracks.join(" ");this.writeStyle(this.grid,this.gridTemplateProp,b),this.onDrag(this.direction,this.track,b)},u0.prototype.cleanup=function(){window.removeEventListener("mouseup",this.stopDragging),window.removeEventListener("touchend",this.stopDragging),window.removeEventListener("touchcancel",this.stopDragging),window.removeEventListener("mousemove",this.drag),window.removeEventListener("touchmove",this.drag),this.grid&&(this.grid.removeEventListener("selectstart",uQ),this.grid.removeEventListener("dragstart",uQ),this.grid.style.userSelect="",this.grid.style.webkitUserSelect="",this.grid.style.MozUserSelect="",this.grid.style.pointerEvents="",this.grid.style.cursor=""),window.document.body.style.cursor=""},u0.prototype.destroy=function(t,e){void 0===t&&(t=!0),t||!1===this.dragging?(this.cleanup(),this.element&&(this.element.removeEventListener("mousedown",this.startDragging),this.element.removeEventListener("touchstart",this.startDragging)),e&&e()):(this.needsDestroy=!0,e&&(this.destroyCb=e))};var u1=function(t,e,n){return e in t?t[e]:n},u2=function(t,e){return function(n){if(n.track<1)throw Error("Invalid track index: "+n.track+". Track must be between two other tracks.");var r="column"===t?e.columnMinSizes||{}:e.rowMinSizes||{},i="column"===t?"columnMinSize":"rowMinSize";return new u0(t,Object.assign({},{minSizeStart:u1(r,n.track-1,uZ(e,i,uZ(e,"minSize",0))),minSizeEnd:u1(r,n.track+1,uZ(e,i,uZ(e,"minSize",0)))},n),e)}},u4=function(t){var e=this;this.columnGutters={},this.rowGutters={},this.options=Object.assign({},{columnGutters:t.columnGutters||[],rowGutters:t.rowGutters||[],columnMinSizes:t.columnMinSizes||{},rowMinSizes:t.rowMinSizes||{}},t),this.options.columnGutters.forEach(function(t){e.columnGutters[t.track]=u2("column",e.options)(t)}),this.options.rowGutters.forEach(function(t){e.rowGutters[t.track]=u2("row",e.options)(t)})};u4.prototype.addColumnGutter=function(t,e){this.columnGutters[e]&&this.columnGutters[e].destroy(),this.columnGutters[e]=u2("column",this.options)({element:t,track:e})},u4.prototype.addRowGutter=function(t,e){this.rowGutters[e]&&this.rowGutters[e].destroy(),this.rowGutters[e]=u2("row",this.options)({element:t,track:e})},u4.prototype.removeColumnGutter=function(t,e){var n=this;void 0===e&&(e=!0),this.columnGutters[t]&&this.columnGutters[t].destroy(e,function(){delete n.columnGutters[t]})},u4.prototype.removeRowGutter=function(t,e){var n=this;void 0===e&&(e=!0),this.rowGutters[t]&&this.rowGutters[t].destroy(e,function(){delete n.rowGutters[t]})},u4.prototype.handleDragStart=function(t,e,n){"column"===e?(this.columnGutters[n]&&this.columnGutters[n].destroy(),this.columnGutters[n]=u2("column",this.options)({track:n}),this.columnGutters[n].startDragging(t)):"row"===e&&(this.rowGutters[n]&&this.rowGutters[n].destroy(),this.rowGutters[n]=u2("row",this.options)({track:n}),this.rowGutters[n].startDragging(t))},u4.prototype.destroy=function(t){var e=this;void 0===t&&(t=!0),Object.keys(this.columnGutters).forEach(function(n){return e.columnGutters[n].destroy(t,function(){delete e.columnGutters[n]})}),Object.keys(this.rowGutters).forEach(function(n){return e.rowGutters[n].destroy(t,function(){delete e.rowGutters[n]})})};var u6=function(t){return new u4(t)};oA(er,tW);class u3{coord_sys;view;subject;constructor(t,e){if(this.coord_sys=t,e)this.view=e;else{let e=t.max_f64();this.view=tn.new(0,e,BigInt(e))}let n={start:this.view.start,end:this.view.end};this.subject=new e1(n)}get length(){return this.view.len}get max(){return this.view.max}get(){return this.subject.value}set(t,e){let n=Number(t),r=Number(e);this.view.set(n,r),this.subject.next({start:n,end:n})}push(){let t=this.view.start,e=this.view.end;this.subject.next({start:t,end:e})}zoomNorm(t,e){this.view.zoom_with_focus(t,e),this.push()}zoomViewCentered(t){this.view.zoom_with_focus(.5,t),this.push()}translateView(t){this.view.translate(t),console.log("translating view"),this.push()}centerAt(t){// console.log("centering view around " + bp);
let e=this.view.len;// console.log("left: " + left + ", right: " + right);
this.view.set(t-e/2,t+e/2),this.push()}segmentAtOffset(t){return"number"==typeof t&&(t=BigInt(t)),this.coord_sys.segment_at_pos(t)}segmentOffset(t){return this.coord_sys.offset_at(t)}segmentRange(t){return this.coord_sys.segment_range(t)}}class u5{/*
  needs to hold coordinate systems, viewports, and data,
  in addition to the graph

  it should probably also have a reference to the wasm module & memory

  upon initialization, assuming only the graph is given (for now the graph
  will be mandatory and restricted to just one), all that should happen is:
   * worker pool initialized
   * graph parsed and loaded on worker
   * computable datasets table is set up with defaults


  the worker pool is probably a bit much to implement right now (i'm not 100%
  sure what the boundary looks like), so instead clean up and refine the worker module

   */wasm;worker_ctx;graph;path_index;graph_viewer;path_viewers;resize_obs;coordinate_systems;viewports_1d;// path_viewers: Map<string, PathViewerCtx>;
// graph_segment_data: Map<string, ArrayBufferView>;
// path_segment_data: Map<string, Map<string, ArrayBufferView>>;
// constructor(worker_ctx, graph_viewer) {
constructor(t,e,n,r){this.wasm=t,this.worker_ctx=e,this.graph=uq($,n),this.path_index=uq(J,r),this.coordinate_systems=new Map,this.viewports_1d=new Map,this.path_viewers=[];// this.graph_segment_data = new Map;
// this.path_segment_data = new Map;
}async get1DViewport(t){let e;if(void 0===t){if(1===this.viewports_1d.size){let t;return this.viewports_1d.forEach(e=>t=e),t}throw Error("Can only call `get1DViewport` without arguments if there's a single 1D viewport in existence")}let n=this.viewports_1d.get(t.name);if(void 0!==n)return n;if(!("scope"in t))throw Error(`Viewport ${t.name} not found, and scope not specified to create new viewport`);e="graph"===t.scope?t.scope:t.scope+":"+t.path_name,// console.warn("cs key: ", cs_key);
console.warn(`cs_key: '${e}'`);let r=await this.getCoordinateSystem(e);if(console.warn("got coordinate system?"),console.warn(r),void 0===r)return;// cs = wrapWasmPtr(wasm_bindgen.CoordSys, cs.__wbg_ptr);
let i=r.max(),o=tn.new(0,Number(i),i);return n=new u3(r,o),this.viewports_1d.set(t.name,n),n}async getCoordinateSystem(t){let e,n=this.coordinate_systems.get(t);if(console.warn("getCoordinateSystem cs: "),console.warn(n),void 0!==n)return n;if("graph"===t)e=await this.worker_ctx.buildGlobalCoordinateSystem(),console.warn("cs_worker"),console.warn(e);else if(t.startsWith("path:")&&t.length>5){let n=t.substring(5);e=await this.worker_ctx.buildPathCoordinateSystem(n)}return void 0!==e&&(n=uq(X,e.__wbg_ptr),console.warn("setting coordinate system..."),console.warn(n),this.coordinate_systems.set(t,n)),n}// setGraphSegmentData(data_name, data: ArrayBufferView) {
// }
// setPathSegmentData(data_name, data_values, data_indices: Uint32Array) {
// }
async createGraphViewer(t,e){if(void 0===this.graph)return;let n=this.graph,r=await uV(this.wasm.memory,n,t);return this.graph_viewer=r,r}async createPathViewer(t,e,n,// data_indices: Float32Array,
r,i,o){// ): Promise<Comlink.Remote<PathViewerCtx & Comlink.ProxyMarked> | undefined> {
//
let u=await oP(this.worker_ctx,t,e,n,r,i,o);return await oC(this.worker_ctx,u),u}async initializeTree(t){this.resize_obs=new er.Subject;let e=document.createElement("div");// this.graph_viewer?.container
if(e.classList.add("root-grid"),e.id="waragraph-root",e.innerHTML=`
  <div class="root-grid root-sidebar-open" id="root-container">
    <div class="sidebar" id="sidebar"></div>
    <div class="gutter-column gutter-column-sidebar"></div>

    <div class="viz-grid" id="viz-container">
      <div id="graph-viewer-container"></div>

      <div class="gutter-row gutter-row-1"></div>

      <div id="path-viewer-container">
        <div class="path-viewer-column" id="path-viewer-left-column"></div>

        <div class="gutter-column gutter-column-1"></div>

        <div class="path-viewer-column" id="path-viewer-right-column"></div>
      </div>
    </div>
  </div>`,function(){let t=`
<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"
     id="viz-svg-overlay"
>
</svg>
`,e=document.createElement("div");e.id="svg-container",e.style.setProperty("z-index","10"),e.style.setProperty("grid-column","1"),e.style.setProperty("grid-row","1 / -1"),e.style.setProperty("background-color","transparent"),e.style.setProperty("pointer-events","none"),document.getElementById("viz-container")?.append(e);let n=document.createElement("svg");e.append(n),n.outerHTML=t,n.style.setProperty("position","absolute")}(),this.graph_viewer){let t=document.getElementById("graph-viewer-container");t.append(this.graph_viewer.gpu_canvas),t.append(this.graph_viewer.overlay_canvas),this.graph_viewer.resize()}// TODO allow only adding parts as desirecd
// if (opts.grid.graph_viewer) {
// const el_2d = document.createElement('div');
// el_2d.style.setProperty('grid-row', '1');
// el_2d.style.setProperty('grid-column', '3');
// el.style.setProperty('grid-row', opts.grid.graph_viewer.row);
// el.style.setProperty('grid-column', opts.grid.graph_viewer.column);
// }
// if (opts.grid.path_viewer_list) {
// const el_1d = document.createElement('div');
// el_1d.style.setProperty('grid-row', '2');
// el_1d.style.setProperty('grid-column', '3');
// el_1d.style.setProperty('grid-row', opts.grid.path_viewer_list.row);
// el_1d.style.setProperty('grid-column', opts.grid.path_viewer_list.column);
// }
// if (opts.grid.sidebar) {
// const el_side = document.createElement('div');
// el_side.classList.add('sidebar');
// el_side.id = 'sidebar';
// el_side.style.setProperty('grid-row', opts.grid.sidebar.row);
// el_side.style.setProperty('grid-column', opts.grid.sidebar.column);
// root.classList.add('root-sidebar-open');
// TODO sidebar needs to take container as argument;
await o2(this);//
// }
// add splits
// const sidebar_viz_gutter = document.createElement('div');
// const viz_1d_2d_gutter = document.createElement('div');
{// TODO: factor out overview & range input bits
let e=ar(40,"div","div"),n=document.createElement("canvas");n.style.setProperty("position","absolute"),n.style.setProperty("overflow","hidden"),n.width=e.right.clientWidth,n.height=e.right.clientHeight,e.right.append(n);let r=t.path_viewers.viewport,i=await this.get1DViewport({name:r.name}),o=new oD(n,i.max);await oI(o,i);/*
      const cs_view = await worker_obj.globalCoordSysView();
      const view_max = await cs_view.viewMax();
      // const view_subject = await cs_view.viewSubject();
      const overview_canvas = document.createElement('canvas');
      overview_canvas.style.setProperty('position', 'absolute');
      overview_canvas.style.setProperty('overflow', 'hidden');
      overview_canvas.width = overview_slots.right.clientWidth;
      overview_canvas.height = overview_slots.right.clientHeight;
      overview_slots.right.append(overview_canvas);
      const overview = new OverviewMap(overview_canvas, view_max);
      await addOverviewEventHandlers(overview, cs_view);
       */// range input
let u=document.createElement("div");for(let t of(// range_input.classList.add('path-name');
u.id="path-viewer-range-input",e.left.append(u),["path-viewer-range-start","path-viewer-range-end"])){let e=document.createElement("input");e.id=t,e.setAttribute("type","text"),e.setAttribute("inputmode","numeric"),e.setAttribute("pattern","d*"),e.style.setProperty("height","100%"),u.append(e)}// TODO
// await addViewRangeInputListeners(cs_view);
// TODO: factor out sequence track bit maybe
let a=ar(20,"div","div"),c=document.createElement("canvas");c.width=a.right.clientWidth,c.height=a.right.clientHeight,c.style.setProperty("position","absolute"),c.style.setProperty("overflow","hidden"),a.right.append(c);let s=function(t,e,n){let r=t.segment_sequences_array(),i=null,o=t=>{let n=t.end-t.start,o=e.width/n,u=e.getContext("2d");if(u?.clearRect(0,0,e.width,e.height),o>8){let n=r.slice(t.start,t.end);t.start,t.start,function(t,e,n){let r=t.getContext("2d");r.save();let i=e.length,o=t.width/i,u=t.height/2;r.font="12px monospace",r.textAlign="center";let a=0;for(let t of e){let e="string"==typeof t?t:String.fromCharCode(t),n=a*o+.5*o;r.fillText(e,n,u),a+=1}r.restore()}(e,n,0),i=t}};return n.pipe(er.distinct(),er.throttleTime(10)).subscribe(t=>{requestAnimationFrame(e=>{o(t)})}),{draw_last:()=>{null!==i&&o(i)}}}(this.graph,c,i.subject);this.resize_obs.pipe(er.throttleTime(500)).subscribe(()=>{this.graph_viewer?.resize(),n.width=e.right.clientWidth,n.height=e.right.clientHeight,c.width=a.right.clientWidth,c.height=a.right.clientHeight,o.draw(),s.draw_last()})}let n=document.getElementById("path-viewer-left-column"),r=document.getElementById("path-viewer-right-column");for(let t of this.path_viewers){r?.append(t.container),t.container.classList.add("path-list-flex-item"),// path_viewer.container.style.setProperty('overflow','hidden');
// path_viewer.container.style.setProperty('position','absolute');
console.warn(t.container);// name_el.classList.add('path-list-flex-item', 'path-name');
// data_el.classList.add('path-list-flex-item');
let e=document.createElement("div");e.classList.add("path-list-flex-item","path-name"),e.innerHTML=t.path_name,n?.append(e),t.onResize(),this.resize_obs.pipe(er.throttleTime(500)).subscribe(e=>{t.onResize()})}u6({columnGutters:[{track:1,element:document.querySelector(".gutter-column-sidebar")}],onDragEnd:(t,e)=>{// graph_viewer.resize();
console.warn("resizing split!"),this.resize_obs.next(null)}}),u6({rowGutters:[{track:1,element:document.querySelector(".gutter-row-1")}],columnGutters:[{track:1,element:document.querySelector(".gutter-column-1")}],rowMinSizes:{0:200},onDragEnd:(t,e)=>{console.warn("resizing split!"),this.resize_obs.next(null)}}),er.fromEvent(window,"resize").subscribe(()=>{this.resize_obs.next(null)})}segmentScreenPos2d(t){return this.graph_viewer?.getSegmentScreenPos(t)||null}async segmentScreenPos1d(t,e){let n=await this.get1DViewport();if(!n)throw Error("No viewport");let r=n.segmentRange(e),i=document.getElementById("viewer-"+t);if(!i)return null;let o=i.getBoundingClientRect(),u=n.get(),a=n.length,c=Number(r.start),s=Number(r.end),l=(c-u.start)/a,f=(s-u.start)/a,_=o.width,d=o.y,b=o.y+o.height;return{x0:o.left+l*_,y0:d,x1:o.left+f*_,y1:b};/*
    let cs_view = await this.worker_obj.globalCoordSysView();
    let view = await cs_view.get();
    let seg_range = await cs_view.segmentRange(segment);

    let el = document.getElementById('viewer-' + path_name);

    let el_rect = el.getBoundingClientRect();

    if (!el) {
      return null;
    }

    // segmentRange returns BigInts
    let seg_s = Number(seg_range.start);
    let seg_e = Number(seg_range.end);

    let seg_start = (seg_s - view.start) / view.len;
    let seg_end = (seg_e - view.start) / view.len;

    let width = el_rect.width;
    let y0 = el_rect.y;
    let y1 = el_rect.y + el_rect.height;

    let x0 = el_rect.left + seg_start * width;
    let x1 = el_rect.left + seg_end * width;

    return { x0, y0, x1, y1 };
       */}}// TODO: don't like this
function u9(t,e){if("hash_path_name"===t){let{r:t,g:n,b:r}=q(e);return{r:t,g:n,b:r,a:1}}return"a"in t?t:Object.assign(t,{a:1})}var u7={},u8={};u8=function(t,e,n){if(e===self.location.origin)// use the worker bundle's own url.
return t;// Otherwise, create a blob URL which loads the worker bundle with `importScripts`.
var r=n?"import "+JSON.stringify(t)+";":"importScripts("+JSON.stringify(t)+");";return URL.createObjectURL(new Blob([r],{type:"application/javascript"}))};var at=b("eRNJD");let ae=at.getBundleURL("gnnWs")+"worker.295cdc57.js";async function an(t={}){let e=await tu(),n=tW.wrap(new Worker(u7)),r=await new n(tu.__wbindgen_wasm_module,e.memory),{gfa:i}=t;if(void 0===i)throw Error("TODO: defer loading GFA");await r.loadGraph(i);let o=await r.getGraphPtr(),u=await r.getPathIndexPtr(),a=new u5(e,r,o,u),c=await a.worker_ctx.graphProxy();if(console.warn(c),console.warn("!!!!!"),console.warn(await c.segment_count()),void 0!==t.graph_viewer){// initialize 2D viewer
let e=t.graph_viewer,n=e.data;if("string"==typeof n){if("depth"===n||"test"===n)n=await a.worker_ctx.getComputedGraphDataset(n);else throw`Unknown data '${n}'`}a.createGraphViewer(e.graph_layout,n)}if(void 0!==t.path_viewers){// initialize 1D viewers
let e=t.path_viewers,n=await a.get1DViewport({scope:"graph",name:e.viewport.name});if(console.warn(n),void 0===n)throw Error("Viewport not found");let r=[];if("*"===e.path_names)a.graph.with_path_names(t=>{r.push(t)});else for(let t of e.path_names)r.push(t);let i=t.path_viewers.data;if("depth"!==i)throw"unsupported path data";// if (data_key === 'depth') {
// } else {
// TODO support custom data
// }
// const path_data_arrays = [];
for(let e of r){let r=await a.worker_ctx.getComputedPathDataset(i,e);if(console.warn("Computed dataset:"),console.warn(r),void 0===r)throw Error(`Computed path data ${i} not found (for path ${e})`);r=uq(te,r.__wbg_ptr);let o=u9(t.path_viewers.color_above,e),u=u9(t.path_viewers.color_below,e),c=await a.createPathViewer(e,n,r,t.path_viewers.threshold,u,o);a.path_viewers.push(c)}/*
    if (typeof data === "string") {
      if (data === "depth") {
        data = await waragraph.worker_ctx.getComputedPathDataset(data);
      } else {
        throw `Unknown data '${data}'`;
      }
    }
      */}return(// add the viewer elements to the DOM
await a.initializeTree(t),a)}function ar(t,e,n){let r=document.createElement(e),i=document.createElement(n),o=e=>{e.style.setProperty("flex-basis",t+"px")};return o(r),o(i),document.getElementById("path-viewer-left-column")?.append(r),document.getElementById("path-viewer-right-column")?.append(i),{left:r,right:i}}u7=u8(ae,at.getOrigin(ae),!1),document.getElementById("load-data").addEventListener("click",async t=>{let e=document.getElementById("gfa-file").files[0],n=document.getElementById("layout-file").files[0];void 0!==e&&void 0!==n&&(document.getElementById("file-inputs").setAttribute("hidden",""),document.getElementById("root-container").style.removeProperty("display"),an({gfa:e,graph_viewer:{graph_layout:n,data:"test"},path_viewers:{path_names:"*",viewport:{name:"global",coordinate_system:"graph"},data:"depth",threshold:.5,// color_above: { r: 1.0, g: 0.0, b: 0.0 },
color_above:"hash_path_name",color_below:{r:0,g:0,b:0,a:0}}}).then(t=>{console.warn(t)}))})}();</script> </body>
